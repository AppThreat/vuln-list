{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20213602",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2021-3602 buildah: Host environment variables leaked in build container when using chroot isolation (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2021-3602",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2021-3602"
      }
    ],
    "Description": "DOCUMENTATION: An information disclosure flaw was found in Buildah, when building containers using chroot isolation. Running processes in container builds (e.g. Dockerfile RUN commands) can access environment variables from parent and grandparent processes. When run in a container in a CI/CD environment, environment variables may include sensitive information that was shared with the container in order to be used only by Buildah itself (e.g. container registry credentials). \n            STATEMENT: OpenShift Container Platform 4's builder container is not vulnerable to this flaw as it uses OCI isolation (i.e. using runc) and does not use chroot isolation.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2022-05-10"
      },
      "Cves": [
        {
          "CveID": "CVE-2021-3602",
          "Cvss3": "5.6/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:N/A:N",
          "Cwe": "CWE-200",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2021-3602",
          "Public": "20210715:1400"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:openshift:4.9",
        "cpe:/a:redhat:openshift:4.9::el8"
      ],
      "Affected": {
        "Resolution": {
          "State": "Will not fix"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201714623004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201714623003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "podman is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201918466001"
                  },
                  {
                    "Comment": "podman is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201918466002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "podman-docker is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925067001"
                  },
                  {
                    "Comment": "podman-docker is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925067002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "podman-remote is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925067003"
                  },
                  {
                    "Comment": "podman-remote is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925067004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "podman-tests is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925067007"
                  },
                  {
                    "Comment": "podman-tests is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925067008"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}