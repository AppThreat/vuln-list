{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202024303",
  "Version": "636",
  "Metadata": {
    "Title": "XSS via a query alias for the Elasticsearch and Testdata datasource (low)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2020-24303",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2020-24303"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in grafana. A XSS via a query alias for the ElasticSearch datasource is allowed. \n            STATEMENT: A vulnerable version of Grafana is shipped in OpenShift 3.11 - 4.5 and OpenShift ServiceMesh, however Prometheus is used as a data source and modification to Elasticsearch or Testdata requires full control of the grafana component. Access is restricted to authenticated users only by OpenShift OAuth. As OpenShift and OpenShift ServiceMesh still packages the vulnerable code, the components are affected but with impact Low. OpenShift 4.6 uses version 7.2.0 of Grafana in openshift4/ose-grafana-container and is not affected.\n\nRed Hat Ceph Storage 3 and 4 ship a vulnerable version of grafana, however, Prometheus is used as the data source., and thus the impact is rated as low. \n\nRed Hat Gluster Storage 3 ships vulnerable version of grafana, however Graphite is the only supported data source and hence this issue has been rated as having a security impact of Low.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Low",
      "Issued": {},
      "Updated": {
        "Date": "2023-08-30"
      },
      "Cves": [
        {
          "CveID": "CVE-2020-24303",
          "Cvss3": "6.1/CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "Cwe": "CWE-79",
          "Impact": "low",
          "Href": "https://access.redhat.com/security/cve/CVE-2020-24303",
          "Public": "20200608"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:service_mesh:1.0",
        "cpe:/a:redhat:service_mesh:1.0::el8"
      ],
      "Affected": {
        "Resolution": {
          "State": "Will not fix"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201818624006"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201818624005"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "servicemesh-grafana is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201818624001"
                  },
                  {
                    "Comment": "servicemesh-grafana is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201818624002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "servicemesh-grafana-prometheus is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201818624003"
                  },
                  {
                    "Comment": "servicemesh-grafana-prometheus is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201818624004"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}