{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202331122",
  "Version": "636",
  "Metadata": {
    "Title": "httpd: mod_macro: out-of-bounds read vulnerability (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2023-31122",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2023-31122"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in the mod_macro module of httpd. When processing a very long macro, the null byte terminator will not be added, leading to an out-of-bounds read, resulting in a crash. \n            STATEMENT: This flaw only affects configurations with mod_macro loaded and when a very long macro is configured and used, specifically a macro longer than 8191 characters. If these conditions are not present, the server is not affected and no further mitigation is needed. For more information about the mitigation, see the mitigation section below.\n\nThe httpd mod_macro module is enabled by default in Red Hat Enterprise Linux 8, 9, and in RHSCL. However, there are no macros used in the default httpd configuration.\n            MITIGATION: Disabling mod_macro and restarting httpd or making sure the macros used are smaller than the required length to trigger this vulnerability will mitigate this flaw. Furthermore, it's unlikely that a very long macro with the length needed to trigger this issue is being used.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2024-02-23"
      },
      "Cves": [
        {
          "CveID": "CVE-2023-31122",
          "Cvss3": "7.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "Cwe": "CWE-125",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2023-31122",
          "Public": "20231019"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:8",
        "cpe:/a:redhat:enterprise_linux:8::appstream",
        "cpe:/a:redhat:enterprise_linux:8::crb",
        "cpe:/a:redhat:enterprise_linux:8::highavailability",
        "cpe:/a:redhat:enterprise_linux:8::nfv",
        "cpe:/a:redhat:enterprise_linux:8::realtime",
        "cpe:/a:redhat:enterprise_linux:8::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:8::sap",
        "cpe:/a:redhat:enterprise_linux:8::sap_hana",
        "cpe:/a:redhat:enterprise_linux:8::supplementary",
        "cpe:/o:redhat:enterprise_linux:8",
        "cpe:/o:redhat:enterprise_linux:8::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          },
          {
            "Comment": "Module httpd:2.4 is enabled",
            "TestRef": "oval:com.redhat.cve:tst:201917567029"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "httpd is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201917567019"
                  },
                  {
                    "Comment": "httpd is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201917567020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "httpd-tools is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201917567009"
                  },
                  {
                    "Comment": "httpd-tools is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201917567010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "mod_ldap is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201917567003"
                  },
                  {
                    "Comment": "mod_ldap is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201917567004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "mod_proxy_html is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201917567015"
                  },
                  {
                    "Comment": "mod_proxy_html is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201917567016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "mod_md is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201917567017"
                  },
                  {
                    "Comment": "mod_md is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201917567018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "httpd-filesystem is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201917567011"
                  },
                  {
                    "Comment": "httpd-filesystem is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201917567012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "httpd-manual is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201917567023"
                  },
                  {
                    "Comment": "httpd-manual is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201917567024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "mod_ssl is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201917567021"
                  },
                  {
                    "Comment": "mod_ssl is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201917567022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "mod_http2 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20181302001"
                  },
                  {
                    "Comment": "mod_http2 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20181302002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "mod_session is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201917567027"
                  },
                  {
                    "Comment": "mod_session is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201917567028"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "httpd-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201917567025"
                  },
                  {
                    "Comment": "httpd-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201917567026"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}