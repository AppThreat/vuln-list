{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202322462",
  "Version": "636",
  "Metadata": {
    "Title": "grafana: stored XSS vulnerability affecting the core plugin \"Text\" (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2023-22462",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2023-22462"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in the Grafana core plugin, \"Text.\" The vulnerability was possible due to React's render cycle that will pass through unsanitized HTML code. However, the HTML is cleaned and saved in Grafana's database in the next cycle. An attacker needs the Editor role in changing a Text panel to include JavaScript. Later, another user needs to edit the same Text panel and click \"Markdown\" or \"HTML\" to execute the code. This issue allows possible vertical privilege escalation, where a user with an Editor role can change to a known password for a user having an Admin role if the user with an Admin role executes malicious JavaScript viewing a dashboard. \n            STATEMENT: OpenShift Service Mesh containers include the grafana RPM from RHEL and consume CVE fixes for grafana from RHEL channels. The servicemesh-grafana RPM shipped in early versions of OpenShift Service Mesh 2.1 is no longer maintained.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2024-03-02"
      },
      "Cves": [
        {
          "CveID": "CVE-2023-22462",
          "Cvss3": "6.4/CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N",
          "Cwe": "CWE-79",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2023-22462",
          "Public": "20230302"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:8",
        "cpe:/a:redhat:enterprise_linux:8::appstream",
        "cpe:/a:redhat:enterprise_linux:8::crb",
        "cpe:/a:redhat:enterprise_linux:8::highavailability",
        "cpe:/a:redhat:enterprise_linux:8::nfv",
        "cpe:/a:redhat:enterprise_linux:8::realtime",
        "cpe:/a:redhat:enterprise_linux:8::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:8::sap",
        "cpe:/a:redhat:enterprise_linux:8::sap_hana",
        "cpe:/a:redhat:enterprise_linux:8::supplementary",
        "cpe:/o:redhat:enterprise_linux:8",
        "cpe:/o:redhat:enterprise_linux:8::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Will not fix"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-graphite is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202028362011"
                  },
                  {
                    "Comment": "grafana-graphite is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202028362012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202028362023"
                  },
                  {
                    "Comment": "grafana is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202028362024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-mssql is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202028362003"
                  },
                  {
                    "Comment": "grafana-mssql is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202028362004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-postgres is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202028362013"
                  },
                  {
                    "Comment": "grafana-postgres is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202028362014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-cloudwatch is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202028362021"
                  },
                  {
                    "Comment": "grafana-cloudwatch is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202028362022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-influxdb is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202028362005"
                  },
                  {
                    "Comment": "grafana-influxdb is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202028362006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-azure-monitor is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202028362009"
                  },
                  {
                    "Comment": "grafana-azure-monitor is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202028362010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-mysql is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202028362007"
                  },
                  {
                    "Comment": "grafana-mysql is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202028362008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-loki is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202028362015"
                  },
                  {
                    "Comment": "grafana-loki is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202028362016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-opentsdb is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202028362017"
                  },
                  {
                    "Comment": "grafana-opentsdb is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202028362018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-stackdriver is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202028362025"
                  },
                  {
                    "Comment": "grafana-stackdriver is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202028362026"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-elasticsearch is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202028362001"
                  },
                  {
                    "Comment": "grafana-elasticsearch is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202028362002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-prometheus is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202028362019"
                  },
                  {
                    "Comment": "grafana-prometheus is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202028362020"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}