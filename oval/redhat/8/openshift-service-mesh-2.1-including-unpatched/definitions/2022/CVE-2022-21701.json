{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202221701",
  "Version": "636",
  "Metadata": {
    "Title": "Privileged Escalation in Kubernetes Gateway API (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2022-21701",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2022-21701"
      }
    ],
    "Description": "DOCUMENTATION: The MITRE CVE dictionary describes this issue as: Istio is an open platform to connect, manage, and secure microservices. In versions 1.12.0 and 1.12.1 Istio is vulnerable to a privilege escalation attack. Users who have `CREATE` permission for `gateways.gateway.networking.k8s.io` objects can escalate this privilege to create other resources that they may not have access to, such as `Pod`. This vulnerability impacts only an Alpha level feature, the Kubernetes Gateway API. This is not the same as the Istio Gateway type (gateways.networking.istio.io), which is not vulnerable. Users are advised to upgrade to resolve this issue. Users unable to upgrade should implement any of the following which will prevent this vulnerability: Remove the gateways.gateway.networking.k8s.io CustomResourceDefinition, set PILOT_ENABLE_GATEWAY_API_DEPLOYMENT_CONTROLLER=true environment variable in Istiod, or remove CREATE permissions for gateways.gateway.networking.k8s.io objects from untrusted users.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2023-09-01"
      },
      "Cves": [
        {
          "CveID": "CVE-2022-21701",
          "Cvss3": "8.8/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Cwe": "CWE-863-\u003eCWE-1220",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2022-21701",
          "Public": "20220118"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:service_mesh:2.1",
        "cpe:/a:redhat:service_mesh:2.1::el8"
      ],
      "Affected": {
        "Resolution": {
          "State": "Will not fix"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:202036604004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:202036604003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "servicemesh is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202138561005"
                  },
                  {
                    "Comment": "servicemesh is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202138561006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "servicemesh-pilot-agent is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202138561007"
                  },
                  {
                    "Comment": "servicemesh-pilot-agent is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202138561008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "servicemesh-cni is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202138561003"
                  },
                  {
                    "Comment": "servicemesh-cni is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202138561004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "servicemesh-pilot-discovery is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202138561001"
                  },
                  {
                    "Comment": "servicemesh-pilot-discovery is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202138561002"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}