{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20213505",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2021-3505 libtpms: RSA keys weaker than expected (low)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2021-3505",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2021-3505"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in libtpms. The TPM 2 implementation returns 2048 bit keys with ~1984 bit strength due to a bug in the TCG specification. The bug is in the key creation algorithm in RsaAdjustPrimeCandidate(), which is called before the prime number check. The highest threat from this vulnerability is to data confidentiality. \n            STATEMENT: Versions of `libtpms` prior to 0.8.0 generate weaker than expected TPM 2 RSA keys due to the flawed key creation algorithm. Red Hat Enterprise Linux 8 Advanced Virtualization is therefore affected by this flaw, as it ships an older version of the package (0.7.x).\n            MITIGATION: There is no mitigation for this issue. Upgrading to a fixed release (0.8.0+) is necessary but not sufficient. The only way to fix it is to unseal all data, delete the old TPM state file, generate a new one with the fixed key generation algorithm, then reseal the data.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Low",
      "Issued": {},
      "Updated": {
        "Date": "2021-10-29"
      },
      "Cves": [
        {
          "CveID": "CVE-2021-3505",
          "Cvss3": "4.0/CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
          "Cwe": "CWE-331",
          "Impact": "low",
          "Href": "https://access.redhat.com/security/cve/CVE-2021-3505",
          "Public": "20200414"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:advanced_virtualization:8",
        "cpe:/a:redhat:advanced_virtualization:8.0",
        "cpe:/a:redhat:advanced_virtualization:8.0::el8",
        "cpe:/a:redhat:advanced_virtualization:8.1",
        "cpe:/a:redhat:advanced_virtualization:8.1::el8",
        "cpe:/a:redhat:advanced_virtualization:8.2",
        "cpe:/a:redhat:advanced_virtualization:8.2::el8",
        "cpe:/a:redhat:advanced_virtualization:8.3",
        "cpe:/a:redhat:advanced_virtualization:8.3::el8",
        "cpe:/a:redhat:advanced_virtualization:8.4",
        "cpe:/a:redhat:advanced_virtualization:8.4::el8",
        "cpe:/a:redhat:advanced_virtualization:8.5",
        "cpe:/a:redhat:advanced_virtualization:8.5::el8",
        "cpe:/a:redhat:advanced_virtualization:8.6",
        "cpe:/a:redhat:advanced_virtualization:8.6::el8",
        "cpe:/a:redhat:advanced_virtualization:8::el8"
      ],
      "Affected": {
        "Resolution": {
          "State": "Will not fix"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201911135034"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201911135033"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "Module virt:av is enabled",
                    "TestRef": "oval:com.redhat.cve:tst:202120196035"
                  }
                ],
                "Criterias": [
                  {
                    "Operator": "OR",
                    "Criterias": [
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms-devel is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446001"
                          },
                          {
                            "Comment": "libtpms-devel is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446002"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446003"
                          },
                          {
                            "Comment": "libtpms is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446004"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms-debugsource is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446005"
                          },
                          {
                            "Comment": "libtpms-debugsource is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446006"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "Module virt:8.2 is enabled",
                    "TestRef": "oval:com.redhat.cve:tst:202010717035"
                  }
                ],
                "Criterias": [
                  {
                    "Operator": "OR",
                    "Criterias": [
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms-devel is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446001"
                          },
                          {
                            "Comment": "libtpms-devel is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446002"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446003"
                          },
                          {
                            "Comment": "libtpms is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446004"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms-debugsource is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446005"
                          },
                          {
                            "Comment": "libtpms-debugsource is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446006"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "Module virt:8.3 is enabled",
                    "TestRef": "oval:com.redhat.cve:tst:202010756035"
                  }
                ],
                "Criterias": [
                  {
                    "Operator": "OR",
                    "Criterias": [
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms-devel is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446001"
                          },
                          {
                            "Comment": "libtpms-devel is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446002"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446003"
                          },
                          {
                            "Comment": "libtpms is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446004"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms-debugsource is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446005"
                          },
                          {
                            "Comment": "libtpms-debugsource is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446006"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}