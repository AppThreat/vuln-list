{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20213504",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2021-3504 hivex: Buffer overflow when provided invalid node key length (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2021-3504",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2021-3504"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in the hivex library. It is caused due to a lack of bounds check within the hivex_open function. An attacker could input a specially crafted Windows Registry (hive) file which would cause hivex to read memory beyond its normal bounds or cause the program to crash. The highest threat from this vulnerability is to system availability. \n            STATEMENT: The hivex utility being non-privileged, does not handle any confidential information. Any external program using the hivex library could be exposed to partial unavailability in case of a crash where a user can always retry the operation. As for libguestfs, a crash in hivex would not result in libguestfs crashing.\n            MITIGATION: Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2022-05-10"
      },
      "Cves": [
        {
          "CveID": "CVE-2021-3504",
          "Cvss3": "5.4/CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:L",
          "Cwe": "CWE-125",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2021-3504",
          "Public": "20210503"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:advanced_virtualization:8",
        "cpe:/a:redhat:advanced_virtualization:8.0",
        "cpe:/a:redhat:advanced_virtualization:8.0::el8",
        "cpe:/a:redhat:advanced_virtualization:8.1",
        "cpe:/a:redhat:advanced_virtualization:8.1::el8",
        "cpe:/a:redhat:advanced_virtualization:8.2",
        "cpe:/a:redhat:advanced_virtualization:8.2::el8",
        "cpe:/a:redhat:advanced_virtualization:8.3",
        "cpe:/a:redhat:advanced_virtualization:8.3::el8",
        "cpe:/a:redhat:advanced_virtualization:8.4",
        "cpe:/a:redhat:advanced_virtualization:8.4::el8",
        "cpe:/a:redhat:advanced_virtualization:8.5",
        "cpe:/a:redhat:advanced_virtualization:8.5::el8",
        "cpe:/a:redhat:advanced_virtualization:8.6",
        "cpe:/a:redhat:advanced_virtualization:8.6::el8",
        "cpe:/a:redhat:advanced_virtualization:8::el8"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201911135034"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201911135033"
          },
          {
            "Comment": "Module virt:8.3 is enabled",
            "TestRef": "oval:com.redhat.cve:tst:202010756035"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "perl-hivex is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20213504001"
                  },
                  {
                    "Comment": "perl-hivex is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20213504002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "hivex-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20213504003"
                  },
                  {
                    "Comment": "hivex-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20213504004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ocaml-hivex-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20213504005"
                  },
                  {
                    "Comment": "ocaml-hivex-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20213504006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "hivex-debugsource is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20213504007"
                  },
                  {
                    "Comment": "hivex-debugsource is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20213504008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-hivex is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20213504009"
                  },
                  {
                    "Comment": "python3-hivex is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20213504010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "hivex is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20213504011"
                  },
                  {
                    "Comment": "hivex is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20213504012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ruby-hivex is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20213504013"
                  },
                  {
                    "Comment": "ruby-hivex is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20213504014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ocaml-hivex is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20213504015"
                  },
                  {
                    "Comment": "ocaml-hivex is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20213504016"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}