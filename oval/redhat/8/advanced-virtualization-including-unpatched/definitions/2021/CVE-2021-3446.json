{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20213446",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2021-3446 libtpms: return of wrong initialization vector when certain symmetric ciphers are used (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2021-3446",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2021-3446"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in libtpms. The commonly used integration of libtpms with OpenSSL contained a vulnerability related to the returned IV (initialization vector) when certain symmetric ciphers were used. Instead of returning the last IV it returned the initial IV to the caller, thus weakening the subsequent encryption and decryption steps. The highest threat from this vulnerability is to data confidentiality. \n            STATEMENT: The versions of `libtpms` as shipped with Red Hat Enterprise Linux 8 Advanced Virtualization are affected by this issue. A future update may fix the code.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2021-10-29"
      },
      "Cves": [
        {
          "CveID": "CVE-2021-3446",
          "Cvss3": "5.1/CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "Cwe": "CWE-327",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2021-3446",
          "Public": "20210301"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:advanced_virtualization:8",
        "cpe:/a:redhat:advanced_virtualization:8.0",
        "cpe:/a:redhat:advanced_virtualization:8.0::el8",
        "cpe:/a:redhat:advanced_virtualization:8.1",
        "cpe:/a:redhat:advanced_virtualization:8.1::el8",
        "cpe:/a:redhat:advanced_virtualization:8.2",
        "cpe:/a:redhat:advanced_virtualization:8.2::el8",
        "cpe:/a:redhat:advanced_virtualization:8.3",
        "cpe:/a:redhat:advanced_virtualization:8.3::el8",
        "cpe:/a:redhat:advanced_virtualization:8.4",
        "cpe:/a:redhat:advanced_virtualization:8.4::el8",
        "cpe:/a:redhat:advanced_virtualization:8.5",
        "cpe:/a:redhat:advanced_virtualization:8.5::el8",
        "cpe:/a:redhat:advanced_virtualization:8.6",
        "cpe:/a:redhat:advanced_virtualization:8.6::el8",
        "cpe:/a:redhat:advanced_virtualization:8::el8"
      ],
      "Affected": {
        "Resolution": {
          "State": "Will not fix"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201911135034"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201911135033"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "Module virt:8.3 is enabled",
                    "TestRef": "oval:com.redhat.cve:tst:202010756035"
                  }
                ],
                "Criterias": [
                  {
                    "Operator": "OR",
                    "Criterias": [
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms-devel is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446001"
                          },
                          {
                            "Comment": "libtpms-devel is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446002"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446003"
                          },
                          {
                            "Comment": "libtpms is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446004"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms-debugsource is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446005"
                          },
                          {
                            "Comment": "libtpms-debugsource is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446006"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "Module virt:av is enabled",
                    "TestRef": "oval:com.redhat.cve:tst:202120196035"
                  }
                ],
                "Criterias": [
                  {
                    "Operator": "OR",
                    "Criterias": [
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms-devel is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446001"
                          },
                          {
                            "Comment": "libtpms-devel is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446002"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446003"
                          },
                          {
                            "Comment": "libtpms is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446004"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms-debugsource is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446005"
                          },
                          {
                            "Comment": "libtpms-debugsource is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446006"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "Module virt:8.2 is enabled",
                    "TestRef": "oval:com.redhat.cve:tst:202010717035"
                  }
                ],
                "Criterias": [
                  {
                    "Operator": "OR",
                    "Criterias": [
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms-devel is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446001"
                          },
                          {
                            "Comment": "libtpms-devel is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446002"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446003"
                          },
                          {
                            "Comment": "libtpms is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446004"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "libtpms-debugsource is installed",
                            "TestRef": "oval:com.redhat.cve:tst:20213446005"
                          },
                          {
                            "Comment": "libtpms-debugsource is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:20213446006"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}