{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202012458",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2020-12458 grafana: information disclosure through world-readable /var/lib/grafana/grafana.db (low)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2020-12458",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2020-12458"
      }
    ],
    "Description": "DOCUMENTATION: An information-disclosure flaw was found in the way Grafana set permissions for the database directory and file. This flaw allows a local attacker access to potentially sensitive information such as cleartext or encrypted datasource passwords from /var/lib/grafana/grafana.db.\n            STATEMENT: The versions of grafana shipped with Red Hat Gluster Storage 3, Red Hat Ceph Storage 3 and 4 sets the world readable permissions on grafana database directory and file, hence affected by this vulnerability.\n \nIn both OpenShift Container Platform (OCP) and OpenShift ServiceMesh (OSSM), the grafana containers set their database files to world readable. However, as it's run in a container image with SELinux MCS labels this prevents other processes on the host from reading it. Therefore, for both (OCP and OSSM) the impact is low.\n            MITIGATION: Manually change the directory and files permissions to remove readable bits for others:\n\n# chmod 750 /var/lib/grafana\n# chmod 640 /var/lib/grafana/grafana.db\n# chown grafana:grafana /var/lib/grafana/grafana.db",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Low",
      "Issued": {},
      "Updated": {
        "Date": "2021-02-16"
      },
      "Cves": [
        {
          "CveID": "CVE-2020-12458",
          "Cvss3": "6.2/CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "Cwe": "CWE-732",
          "Impact": "low",
          "Href": "https://access.redhat.com/security/cve/CVE-2020-12458",
          "Public": "20200423:2000"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:service_mesh:1.1",
        "cpe:/a:redhat:service_mesh:1.1::el8"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201818624006"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201818624005"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "servicemesh-grafana is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201818624001"
                  },
                  {
                    "Comment": "servicemesh-grafana is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201818624002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "servicemesh-grafana-prometheus is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201818624003"
                  },
                  {
                    "Comment": "servicemesh-grafana-prometheus is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201818624004"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}