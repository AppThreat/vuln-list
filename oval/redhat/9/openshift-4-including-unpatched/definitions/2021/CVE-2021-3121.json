{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20213121",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2021-3121 gogo/protobuf: plugin/unmarshal/unmarshal.go lacks certain index validation (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2021-3121",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2021-3121"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in github.com/gogo/protobuf before 1.3.2 that allows an out-of-bounds access when unmarshalling certain protobuf objects. This flaw allows a remote attacker to send crafted protobuf messages, causing panic and resulting in a denial of service. The highest threat from this vulnerability is to availability. \n            STATEMENT: OpenShift Container Platform (OCP), OpenShift ServiceMesh (OSSM) and Red Hat OpenShift Jaeger (RHOSJ) all include code generated by github.com/gogo/protobuf to parse protobuf messages. However, no component is known to accept protobuf messages from unauthenticated sources, hence this vulnerability is rated Moderate for OCP, OSSM and RHOSJ.\n\nOpenShift Virtualization includes code generated by github.com/gogo/protobuf to parse protobuf messages. However, no component of OpenShift Virtualization is known to accept protobuf messages from unauthenticated sources, hence this vulnerability is rated Moderate.\n\nRed Hat Advanced Cluster Management for Kubernetes (RHACM) includes code generated by github.com/gogo/protobuf to parse protobuf messages. However, no RHACM component is accepting  protobuf messages from unauthenticated sources and are used with a limited scope, hence this vulnerability is rated Moderate for RHACM.\n\nRed Hat Cluster Application Migration (CAM) includes code generated by github.com/gogo/protobuf to parse protobuf messages. However, no CAM component is known to accept protobuf messages from unauthenticated sources, hence this vulnerability is rated Moderate for CAM.\n\nCryostat-2 is affected as it does ship gogo/protobuf library with it's distribution but the only use for Protobuf would be the Kubernetes/OpenShift API server the operator communicates with and it should be authenticated hence it is affected with Moderate impact.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2022-09-20"
      },
      "Cves": [
        {
          "CveID": "CVE-2021-3121",
          "Cvss3": "8.6/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H",
          "Cwe": "CWE-129",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2021-3121",
          "Public": "20210111"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:openshift:4.12",
        "cpe:/a:redhat:openshift:4.12::el9"
      ],
      "Affected": {
        "Resolution": {
          "State": "Will not fix"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20143577004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 9 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20143577003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "buildah is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014040001"
                  },
                  {
                    "Comment": "buildah is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014040002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "skopeo is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910214005"
                  },
                  {
                    "Comment": "skopeo is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910214006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "atomic-openshift-service-idler is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201916276021"
                  },
                  {
                    "Comment": "atomic-openshift-service-idler is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201916276022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openshift-eventrouter is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201916276017"
                  },
                  {
                    "Comment": "openshift-eventrouter is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201916276018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "cri-o is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910214003"
                  },
                  {
                    "Comment": "cri-o is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910214004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openshift is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201718367001"
                  },
                  {
                    "Comment": "openshift is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201718367002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "podman is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910214001"
                  },
                  {
                    "Comment": "podman is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910214002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openshift-clients is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201714623001"
                  },
                  {
                    "Comment": "openshift-clients is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201714623002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "cri-tools is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201916276035"
                  },
                  {
                    "Comment": "cri-tools is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201916276036"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}