{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202140346",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2021-40346 haproxy: request smuggling attack or response splitting via duplicate content-length header (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2021-40346",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2021-40346"
      }
    ],
    "Description": "DOCUMENTATION: Proxy server haproxy has a flaw that can could allow an HTTP request smuggling attack with the goal of bypassing access-control list rules defined by haproxy. The attack was made possible by utilizing an integer overflow vulnerability that allowed reaching an unexpected state in haproxy while parsing an HTTP request. The highest threat from this vulnerability is integrity. \n            \n            MITIGATION: To mitigate this problem the following can be added to proxy config:\n\nhttp-request deny if { req.hdr_cnt(content-length) gt 1 }\nhttp-response deny if { res.hdr_cnt(content-length) gt 1 }",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2022-05-17"
      },
      "Cves": [
        {
          "CveID": "CVE-2021-40346",
          "Cvss3": "7.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
          "Cwe": "CWE-444",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2021-40346",
          "Public": "20210908:1737"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:openshift:4.12",
        "cpe:/a:redhat:openshift:4.12::el9"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20143577004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 9 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20143577003"
          },
          {
            "Comment": "haproxy is installed",
            "TestRef": "oval:com.redhat.cve:tst:201918277001"
          },
          {
            "Comment": "haproxy is signed with Red Hat redhatrelease2 key",
            "TestRef": "oval:com.redhat.cve:tst:201918277002"
          }
        ]
      }
    ]
  }
}