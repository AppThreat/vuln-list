{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20208557",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2020-8557 kubernetes: Node disk DOS by writing to container /etc/hosts (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2020-8557",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2020-8557"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in Kubernetes, where the amount of disk space the /etc/hosts file can use is unconstrained . This flaw can allow attacker-controlled pods to cause a denial of service if they have permission to write to the node's /etc/hosts file. \n            STATEMENT: In OpenShift Container Platform (OCP) there is LocalStorageCapacityIsolation feature gate functionality which prevents a denial of service (DoS) attack on the node by writing to the ephemeral storage.This feature is disabled by default in OCP 3.11 and can be enabled as per [1]. Even with enabled  LocalStorageCapacityIsolation feature gate, OCP is affected by this vulnerability, therefore it is recommended to enable the feature gate and also upgrade to an OCP version which has a fix for this vulnerability.\n\n[1] https://docs.openshift.com/container-platform/3.11/install_config/configuring_ephemeral.html\n            MITIGATION: On OpenShift Container Platform (OCP) 3.11 and 4.x it's possible to set the allowPrivilegeEscalation Security Context Constraint to 'false' to prevent this. Note that this is set to 'true' by default, and setting it to false will prevent certain binaries which require setuid to stop working. On OCP 3.11 for example the 'ping' command will no longer work [1]. On OCP 4.x and later the 'ping' command will work with allowPrivilegeEscalation set to False, but other setuid binaries will not work.\n[1] https://docs.openshift.com/container-platform/3.11/release_notes/ocp_3_11_release_notes.html",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2021-10-28"
      },
      "Cves": [
        {
          "CveID": "CVE-2020-8557",
          "Cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "Cwe": "CWE-400",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2020-8557",
          "Public": "20200715"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:openshift:4.12",
        "cpe:/a:redhat:openshift:4.12::el9"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20143577004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 9 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20143577003"
          },
          {
            "Comment": "openshift is installed",
            "TestRef": "oval:com.redhat.cve:tst:201718367001"
          },
          {
            "Comment": "openshift is signed with Red Hat redhatrelease2 key",
            "TestRef": "oval:com.redhat.cve:tst:201718367002"
          }
        ]
      }
    ]
  }
}