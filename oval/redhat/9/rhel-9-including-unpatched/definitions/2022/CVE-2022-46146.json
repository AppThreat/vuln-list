{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202246146",
  "Version": "636",
  "Metadata": {
    "Title": "exporter-toolkit: authentication bypass via cache poisoning (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2022-46146",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2022-46146"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in exporter-toolkit. A request can be forged by an attacker to poison the internal cache used to cache hashes and make subsequent successful requests. This cache is used to limit side channel attacks that could tell an attacker if a user is present in the file or not. Prometheus and its exporters can be secured by a web.yml file that specifies usernames and hashed passwords for basic authentication. Passwords are hashed with bcrypt, which means that even if you have access to the hash, it is very hard to find the original password. However, due to the way this mechanism was implemented in the exporter toolkit, if the hashed password is known, it is possible to authenticate against Prometheus.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2024-03-01"
      },
      "Cves": [
        {
          "CveID": "CVE-2022-46146",
          "Cvss3": "7.5/CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Cwe": "CWE-305",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2022-46146",
          "Public": "20221129"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:9",
        "cpe:/a:redhat:enterprise_linux:9::appstream",
        "cpe:/a:redhat:enterprise_linux:9::crb",
        "cpe:/a:redhat:enterprise_linux:9::highavailability",
        "cpe:/a:redhat:enterprise_linux:9::nfv",
        "cpe:/a:redhat:enterprise_linux:9::realtime",
        "cpe:/a:redhat:enterprise_linux:9::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:9::sap",
        "cpe:/a:redhat:enterprise_linux:9::sap_hana",
        "cpe:/a:redhat:enterprise_linux:9::supplementary",
        "cpe:/o:redhat:enterprise_linux:9",
        "cpe:/o:redhat:enterprise_linux:9::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Will not fix"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 9 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          },
          {
            "Comment": "grafana is installed",
            "TestRef": "oval:com.redhat.cve:tst:202143138001"
          },
          {
            "Comment": "grafana is signed with Red Hat redhatrelease2 key",
            "TestRef": "oval:com.redhat.cve:tst:202143138002"
          }
        ]
      }
    ]
  }
}