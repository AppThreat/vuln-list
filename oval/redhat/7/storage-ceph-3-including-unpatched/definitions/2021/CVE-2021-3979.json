{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20213979",
  "Version": "636",
  "Metadata": {
    "Title": "Ceph volume does not honour osd_dmcrypt_key_size (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2021-3979",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2021-3979"
      }
    ],
    "Description": "DOCUMENTATION: A key length flaw was found in Red Hat Ceph Storage. An attacker can exploit the fact that the key length is incorrectly passed in an encryption algorithm to create a non random key, which is weaker and can be exploited for loss of confidentiality and integrity on encrypted disks. \n            STATEMENT: Red Hat OpenStack Platform deployments use the ceph package directly from the Ceph channel; the RHOSP package will not be updated at this time.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2023-07-12"
      },
      "Cves": [
        {
          "CveID": "CVE-2021-3979",
          "Cvss3": "6.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
          "Cwe": "CWE-287",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2021-3979",
          "Public": "20220111"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:ceph_storage:3",
        "cpe:/a:redhat:ceph_storage:3::el7"
      ],
      "Affected": {
        "Resolution": {
          "State": "Out of support scope"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201610745004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201610745003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python-cephfs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684049"
                  },
                  {
                    "Comment": "python-cephfs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684050"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python-rados is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684029"
                  },
                  {
                    "Comment": "python-rados is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684030"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "librgw-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684011"
                  },
                  {
                    "Comment": "librgw-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "librbd1 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684009"
                  },
                  {
                    "Comment": "librbd1 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ceph-mon is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684031"
                  },
                  {
                    "Comment": "ceph-mon is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684032"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ceph-selinux is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684015"
                  },
                  {
                    "Comment": "ceph-selinux is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ceph-fuse is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684035"
                  },
                  {
                    "Comment": "ceph-fuse is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684036"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python-rgw is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684037"
                  },
                  {
                    "Comment": "python-rgw is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684038"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libcephfs-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684047"
                  },
                  {
                    "Comment": "libcephfs-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684048"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "librgw2 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684013"
                  },
                  {
                    "Comment": "librgw2 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libradosstriper1 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684041"
                  },
                  {
                    "Comment": "libradosstriper1 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684042"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ceph-radosgw is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684023"
                  },
                  {
                    "Comment": "ceph-radosgw is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libcephfs2 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684003"
                  },
                  {
                    "Comment": "libcephfs2 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ceph-mds is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684039"
                  },
                  {
                    "Comment": "ceph-mds is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684040"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ceph-base is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684027"
                  },
                  {
                    "Comment": "ceph-base is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684028"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "librados2 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684025"
                  },
                  {
                    "Comment": "librados2 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684026"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rbd-mirror is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684043"
                  },
                  {
                    "Comment": "rbd-mirror is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684044"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ceph-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684017"
                  },
                  {
                    "Comment": "ceph-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ceph-mgr is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684019"
                  },
                  {
                    "Comment": "ceph-mgr is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ceph-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684001"
                  },
                  {
                    "Comment": "ceph-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "librados-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684005"
                  },
                  {
                    "Comment": "librados-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python-rbd is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684033"
                  },
                  {
                    "Comment": "python-rbd is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684034"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ceph is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684021"
                  },
                  {
                    "Comment": "ceph is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "librbd-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684007"
                  },
                  {
                    "Comment": "librbd-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ceph-osd is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812684045"
                  },
                  {
                    "Comment": "ceph-osd is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812684046"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}