{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20181279",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2018-1279 rabbitmq-server: Deterministically generated cookie shared between all machines (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2018-1279",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2018-1279"
      }
    ],
    "Description": "DOCUMENTATION: RabbitMQ, versions up to and including 3.7.9, use an insecure method for generating authentication cookies when configuring clustered operations. It is possible to determine the cookie given adequate network topology information. Using the default cookie generated by RabbitMQ when forming a RabbitMQ cluster may lead to privileged access if the cookie is determined. \n            STATEMENT: OpenShift Online:\nRabbitMQ is only used by the Ansible Tower, which is not a standard part of the OpenShift product, however is deployed as a management tool.\n\nThis is set as deferred as it has no impact to customers and is not deployed in a clustered configuration. A cluster using an Erlang-generated cookie would be required for cookie guessing to provide and environmental leverage.\n\nOpenStack:\nFor RHOSP10+, the rabbit cookie is set to a random string during deployment, rather than relying on Erlang to generate the cookie, if the cookie has not been overridden in the deployment configuration. In either case, this avoids the predictable Erlang cookie generation highlighted by this flaw, meaning RHOSP10+ is not vulnerable. Further mitigating the flaw, is the fact that RabbitMQ, in an OpenStack context, is deployed to the admin network and as such should only be accessible to OpenStack services, not public users via an external network.\n\nFor RHOSP8+9, when deployed with Director (TripleO), the RabbitMQ salt is initialized via the Heat RandomString function, also bypassing this vulnerability. RHOSP8+9 however did not use Director as the default deployment mechanism. When installing RHOSP manually in these versions, our installation documentation does not provide guidance for configuring clustered RabbitMQ. It is safe to assume that some customers may have this configured in an insecure way, despite the fact that we would not have told them how to install and configure a cluster in a vulnerable way.\n\nAnsible Tower:\nIn Tower we do not use the programmatic cookie generation that gives rise to this vulnerability. Instead we use cookiemonster. So this issue does not affect Ansible Tower.\n\nCloudForms (CFME):\nRabbitMQ shipped with CloudForms is exclusively used by Ansible Tower. Since Ansible Tower is not vulnerable, due to the reasons described above, then CloudForms isn't, as well.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {
        "Date": "2021-02-16"
      },
      "Cves": [
        {
          "CveID": "CVE-2018-1279",
          "Cvss3": "6.5/CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "Cwe": "CWE-330-\u003eCWE-290",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2018-1279",
          "Public": "20181220"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:openstack-optools:14",
        "cpe:/a:redhat:openstack-optools:14::el7",
        "cpe:/a:redhat:openstack:14",
        "cpe:/a:redhat:openstack:14::el7"
      ],
      "Affected": {
        "Resolution": {
          "State": "Out of support scope"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201610735006"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201610735005"
          },
          {
            "Comment": "rabbitmq-server is installed",
            "TestRef": "oval:com.redhat.cve:tst:20181279001"
          },
          {
            "Comment": "rabbitmq-server is signed with Red Hat redhatrelease2 key",
            "TestRef": "oval:com.redhat.cve:tst:20181279002"
          }
        ]
      }
    ]
  }
}