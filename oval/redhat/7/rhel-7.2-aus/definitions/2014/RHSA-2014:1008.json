{
  "Class": "patch",
  "ID": "oval:com.redhat.rhsa:def:20141008",
  "Version": "636",
  "Metadata": {
    "Title": "RHSA-2014:1008: samba security and bug fix update (Important)",
    "AffectedList": [
      {
        "Family": "unix",
        "Platforms": [
          "Red Hat Enterprise Linux 7"
        ]
      }
    ],
    "References": [
      {
        "Source": "RHSA",
        "RefID": "RHSA-2014:1008",
        "RefURL": "https://access.redhat.com/errata/RHSA-2014:1008"
      },
      {
        "Source": "CVE",
        "RefID": "CVE-2014-3560",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2014-3560"
      }
    ],
    "Description": "Samba is an open-source implementation of the Server Message Block (SMB) or\nCommon Internet File System (CIFS) protocol, which allows PC-compatible\nmachines to share files, printers, and other information.\n\nA heap-based buffer overflow flaw was found in Samba's NetBIOS message\nblock daemon (nmbd). An attacker on the local network could use this flaw\nto send specially crafted packets that, when processed by nmbd, could\npossibly lead to arbitrary code execution with root privileges.\n(CVE-2014-3560)\n\nThis update also fixes the following bug:\n\n* Prior to this update, Samba incorrectly used the O_TRUNC flag when using\nthe open(2) system call to access the contents of a file that was already\nopened by a different process, causing the file's previous contents to be\nremoved. With this update, the O_TRUNC flag is no longer used in the above\nscenario, and file corruption no longer occurs. (BZ#1115490)\n\nAll Samba users are advised to upgrade to these updated packages, which\ncontain backported patches to correct these issues. After installing this\nupdate, the smb service will be restarted automatically.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Rights": "Copyright 2014 Red Hat, Inc.",
      "Issued": {
        "Date": "2014-08-05"
      },
      "Updated": {
        "Date": "2014-08-05"
      },
      "Cves": [
        {
          "CveID": "CVE-2014-3560",
          "Cvss2": "7.9/AV:A/AC:M/Au:N/C:C/I:C/A:C",
          "Cwe": "CWE-119",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2014-3560",
          "Public": "20140731"
        }
      ],
      "Bugzilla": [
        {
          "Href": "https://bugzilla.redhat.com/1126010",
          "ID": "1126010"
        }
      ],
      "AffectedCpeList": [
        "cpe:/o:redhat:rhel_aus:7.2",
        "cpe:/o:redhat:rhel_aus:7.2::server"
      ],
      "Affected": {
        "Resolution": {}
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.rhba:tst:20150364028"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.rhba:tst:20150364027"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libsmbclient is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008001"
                  },
                  {
                    "Comment": "libsmbclient is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libsmbclient-devel is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008003"
                  },
                  {
                    "Comment": "libsmbclient-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libwbclient is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008005"
                  },
                  {
                    "Comment": "libwbclient is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libwbclient-devel is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008007"
                  },
                  {
                    "Comment": "libwbclient-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008009"
                  },
                  {
                    "Comment": "samba is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-client is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008011"
                  },
                  {
                    "Comment": "samba-client is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-common is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008013"
                  },
                  {
                    "Comment": "samba-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-dc is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008015"
                  },
                  {
                    "Comment": "samba-dc is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258028"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-dc-libs is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008017"
                  },
                  {
                    "Comment": "samba-dc-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258030"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-devel is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008019"
                  },
                  {
                    "Comment": "samba-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258032"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-libs is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008021"
                  },
                  {
                    "Comment": "samba-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258034"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-pidl is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008023"
                  },
                  {
                    "Comment": "samba-pidl is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258036"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-python is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008025"
                  },
                  {
                    "Comment": "samba-python is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258038"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-test is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008027"
                  },
                  {
                    "Comment": "samba-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258040"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-test-devel is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008029"
                  },
                  {
                    "Comment": "samba-test-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258042"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-vfs-glusterfs is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008031"
                  },
                  {
                    "Comment": "samba-vfs-glusterfs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258046"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-winbind is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008033"
                  },
                  {
                    "Comment": "samba-winbind is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258048"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-winbind-clients is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008035"
                  },
                  {
                    "Comment": "samba-winbind-clients is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258050"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-winbind-krb5-locator is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008037"
                  },
                  {
                    "Comment": "samba-winbind-krb5-locator is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258052"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-winbind-modules is earlier than 0:4.1.1-37.el7_0",
                    "TestRef": "oval:com.redhat.rhsa:tst:20141008039"
                  },
                  {
                    "Comment": "samba-winbind-modules is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20152258054"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}