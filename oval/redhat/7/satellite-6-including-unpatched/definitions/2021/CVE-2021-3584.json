{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20213584",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2021-3584 foreman: Authenticate remote code execution through Sendmail configuration (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2021-3584",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2021-3584"
      }
    ],
    "Description": "DOCUMENTATION: A server side remote code execution vulnerability was found in Foreman project. A authenticated attacker could use Sendmail configuration options to overwrite the defaults and perform command injection. The highest threat from this vulnerability is to confidentiality, integrity and availability of system. \n            \n            MITIGATION: This vulnerability can be mitigated by setting following two values in `/etc/foreman/settings.yaml` file which will render them read-only from the application: \n:sendmail_location: '/usr/sbin/sendmail'\n:sendmail_arguments: '-i'",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2022-07-05"
      },
      "Cves": [
        {
          "CveID": "CVE-2021-3584",
          "Cvss3": "7.2/CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
          "Cwe": "CWE-78",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2021-3584",
          "Public": "20210616:1400"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:satellite:6.9",
        "cpe:/a:redhat:satellite:6.9::el7",
        "cpe:/a:redhat:satellite_capsule:6.9",
        "cpe:/a:redhat:satellite_capsule:6.9::el7"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20134120012"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20134120011"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "satellite-debug-tools is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20148168001"
                  },
                  {
                    "Comment": "satellite-debug-tools is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20148168002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "satellite-capsule is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20148168003"
                  },
                  {
                    "Comment": "satellite-capsule is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20148168004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "satellite-cli is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20148168005"
                  },
                  {
                    "Comment": "satellite-cli is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20148168006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "satellite-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20148168007"
                  },
                  {
                    "Comment": "satellite-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20148168008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "satellite is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20148168009"
                  },
                  {
                    "Comment": "satellite is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20148168010"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}