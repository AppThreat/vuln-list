{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202423334",
  "Version": "636",
  "Metadata": {
    "Title": "aiohttp: follow_symlinks directory traversal vulnerability (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-23334",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-23334"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in aiohttp. When using aiohttp as a web server and configuring static routes, it is necessary to specify the root path for static files. Additionally, the option 'follow_symlinks' can be used to determine whether to follow symbolic links outside the static root directory. When 'follow_symlinks' is set to True, there is no validation to check if a given file path is within the root directory. This issue can lead to a directory traversal vulnerability, resulting in unauthorized access to arbitrary files on the system, even when symlinks are not present. \n            STATEMENT: This vulnerability has been rated as moderate after analysis from Redhat as in our CVSS scoring we have found that in order to exploit this vulnerability the follow_symlinks would need to be set as true, such a thing is out of the attacker's control, and hence attack complexity has been marked as high instead of NVD scoring of low.\n            MITIGATION: If using follow_symlinks=True outside of a restricted local development environment, disable the option immediately. This option is NOT needed to follow symlinks that point to a location within the static root directory; it is only intended to allow a symlink to break out of the static directory. Even with this CVE fixed, there is still a substantial risk of misconfiguration when using this option on a server that accepts requests from remote users.\n\nAdditionally, aiohttp has always recommended using a reverse proxy server (such as nginx) to handle static resources and not to use these static resources in aiohttp for production environments. Doing so also protects against this vulnerability, and is why we expect the number of affected users to be very low.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2024-03-07"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-23334",
          "Cvss3": "5.9/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "Cwe": "CWE-22",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-23334",
          "Public": "20240130"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:satellite:6.10",
        "cpe:/a:redhat:satellite:6.10::el7",
        "cpe:/a:redhat:satellite_capsule:6.10",
        "cpe:/a:redhat:satellite_capsule:6.10::el7"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20134120010"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20134120009"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-aiohttp is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202337276001"
                  },
                  {
                    "Comment": "python3-aiohttp is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202337276002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python-aiohttp is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202337276003"
                  },
                  {
                    "Comment": "python-aiohttp is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202337276004"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}