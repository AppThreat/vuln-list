{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20207471",
  "Version": "631",
  "Metadata": {
    "Title": "CVE-2020-7471 django: potential SQL injection via StringAgg(delimiter) (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2020-7471",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2020-7471"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in Django, where it may allow SQL injection if improperly sanitized data is used as a StringAgg delimiter.  If a suitably crafted delimiter is passed to a 'contrib.postgres.aggregates.StringAgg' instance, it is possible to break escaping and inject malicious SQL. An attacker could use this flaw to cause a denial of service, information disclosure, or privilege escalation.\n            STATEMENT: Even though the version of python-django as shipped in Red Hat Update Infrastructure contains the vulnerable code, the Product is not vulnerable because the vulnerable function is not used. Red Hat Update Infrastructure is based on pulp 2, which still uses MongoDB as database and not postgresql, where the flaw lies.\n\nAlthough Red Hat OpenStack Platform 13, 15, \u0026 16 contain the vulnerable code, postgresql is not a supported database hence the lowered impact.\n\nSatellite 6 versions include vulnerable version of python-django however vulnerability is not directly exposed through code since the product does not use 'StringAgg' delimiter implementation. This issue may be get fixed in future updates.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {},
      "Affected": {
        "Resolution": {}
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20134120012"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20134120011"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python-django is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201912781001"
                  },
                  {
                    "Comment": "python-django is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201912781002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python2-django is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201912781003"
                  },
                  {
                    "Comment": "python2-django is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201912781004"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}