{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202229970",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2022-29970 sinatra: path traversal possible outside of public_dir when serving static files (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2022-29970",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2022-29970"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in Sinatra when serving static files from the public directory. The requested path is not validated if it is in the public directory, allowing files outside of the public directory to be served. \n            \n            MITIGATION: Disable the static option which will disable the public_dir option. With this configuration, Sinatra will not serve files from the public directory and therefore files outside of it.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {
        "Date": "2022-11-23"
      },
      "Cves": [
        {
          "CveID": "CVE-2022-29970",
          "Cvss3": "7.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "Cwe": "CWE-22",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2022-29970",
          "Public": "20220502"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:satellite:6.9",
        "cpe:/a:redhat:satellite:6.9::el7",
        "cpe:/a:redhat:satellite_capsule:6.9",
        "cpe:/a:redhat:satellite_capsule:6.9::el7"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20134120012"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20134120011"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rubygem-sinatra is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202229970001"
                  },
                  {
                    "Comment": "rubygem-sinatra is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202229970002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "tfm-ror52-rubygem-rack-protection is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202229970003"
                  },
                  {
                    "Comment": "tfm-ror52-rubygem-rack-protection is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202229970004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "tfm-rubygem-rack-protection is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202229970005"
                  },
                  {
                    "Comment": "tfm-rubygem-rack-protection is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202229970006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "tfm-ror52-rubygem-sinatra is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202229970007"
                  },
                  {
                    "Comment": "tfm-ror52-rubygem-sinatra is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202229970008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "tfm-rubygem-sinatra is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202229970009"
                  },
                  {
                    "Comment": "tfm-rubygem-sinatra is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202229970010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "tfm-rubygem-mustermann is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202229970011"
                  },
                  {
                    "Comment": "tfm-rubygem-mustermann is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202229970012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "tfm-ror52-rubygem-mustermann is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202229970013"
                  },
                  {
                    "Comment": "tfm-ror52-rubygem-mustermann is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202229970014"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}