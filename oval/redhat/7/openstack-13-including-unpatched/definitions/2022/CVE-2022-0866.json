{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20220866",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2022-0866 wildfly: Wildfly management of EJB Session context returns wrong caller principal with Elytron Security enabled (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2022-0866",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2022-0866"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in Wildfly, where it returns an incorrect caller principal under certain heavily concurrent situations when Elytron Security is used. This flaw allows an attacker to gain improper access to information they should not have. \n            STATEMENT: JBoss EAP 7.1 until 7.4 is not affected by default as it comes with Legacy Security enabled out-of-the-box. This only affects application scope range and the methods mentioned, no access to server data.\n            MITIGATION: In order to avoid the possibility of information access, review application source code for '@RunAs' and 'run-as-principal' usage. Also, make sure the application is using or not Elytron Security. It's possible to investigate by checking if the commands from '$JBOSS_HOME/docs/examples/enable-elytron.cli' or similar were executed.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2022-11-03"
      },
      "Cves": [
        {
          "CveID": "CVE-2022-0866",
          "Cvss3": "3.1/CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N",
          "Cwe": "CWE-863-\u003eCWE-1220",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2022-0866",
          "Public": "20220503"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:openstack-optools:13",
        "cpe:/a:redhat:openstack-optools:13::el7",
        "cpe:/a:redhat:openstack:13",
        "cpe:/a:redhat:openstack:13::el7"
      ],
      "Affected": {
        "Resolution": {
          "State": "Out of support scope"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20115034004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20115034003"
          },
          {
            "Comment": "opendaylight is installed",
            "TestRef": "oval:com.redhat.cve:tst:20115034001"
          },
          {
            "Comment": "opendaylight is signed with Red Hat redhatrelease2 key",
            "TestRef": "oval:com.redhat.cve:tst:20115034002"
          }
        ]
      }
    ]
  }
}