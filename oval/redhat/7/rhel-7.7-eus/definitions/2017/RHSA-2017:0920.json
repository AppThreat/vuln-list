{
  "Class": "patch",
  "ID": "oval:com.redhat.rhsa:def:20170920",
  "Version": "641",
  "Metadata": {
    "Title": "RHSA-2017:0920: 389-ds-base security and bug fix update (Important)",
    "AffectedList": [
      {
        "Family": "unix",
        "Platforms": [
          "Red Hat Enterprise Linux 7"
        ]
      }
    ],
    "References": [
      {
        "Source": "RHSA",
        "RefID": "RHSA-2017:0920",
        "RefURL": "https://access.redhat.com/errata/RHSA-2017:0920"
      },
      {
        "Source": "CVE",
        "RefID": "CVE-2017-2668",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2017-2668"
      }
    ],
    "Description": "389 Directory Server is an LDAP version 3 (LDAPv3) compliant server. The base packages include the Lightweight Directory Access Protocol (LDAP) server and command-line utilities for server administration.\n\nSecurity Fix(es):\n\n* An invalid pointer dereference flaw was found in the way 389-ds-base handled LDAP bind requests. A remote unauthenticated attacker could use this flaw to make ns-slapd crash via a specially crafted LDAP bind request, resulting in denial of service. (CVE-2017-2668)\n\nRed Hat would like to thank Joachim Jabs (F24) for reporting this issue.\n\nBug Fix(es):\n\n* Previously, when adding a filtered role definition that uses the \"nsrole\" virtual attribute in the filter, Directory Server terminated unexpectedly. A patch has been applied, and now the roles plug-in ignores all virtual attributes. As a result, an error message is logged when an invalid filter is used. Additionally, the role is deactivated and Directory Server no longer fails. (BZ#1429498)\n\n* In a replication topology, Directory Server incorrectly calculated the size of string format entries when a lot of entries were deleted. The calculated size of entries was smaller than the actual required size. Consequently, Directory Server allocated insufficient memory and terminated unexpectedly when the data was written to it. With this update, the size of string format entries is now calculated correctly in the described situation and Directory Server no longer terminates unexpectedly. (BZ#1429495)",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Rights": "Copyright 2017 Red Hat, Inc.",
      "Issued": {
        "Date": "2017-04-12"
      },
      "Updated": {
        "Date": "2017-04-12"
      },
      "Cves": [
        {
          "CveID": "CVE-2017-2668",
          "Cvss3": "6.5/CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "Cwe": "CWE-119",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2017-2668",
          "Public": "20170410"
        }
      ],
      "Bugzilla": [
        {
          "Href": "https://bugzilla.redhat.com/1436575",
          "ID": "1436575"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:rhel_extras_sap_eus:7.7",
        "cpe:/a:redhat:rhel_extras_sap_hana_eus:7.7",
        "cpe:/o:redhat:rhel_eus:7.7",
        "cpe:/o:redhat:rhel_eus:7.7::computenode",
        "cpe:/o:redhat:rhel_eus:7.7::server"
      ],
      "Affected": {
        "Resolution": {}
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.rhba:tst:20150364028"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.rhba:tst:20150364027"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "389-ds-base is earlier than 0:1.3.5.10-20.el7_3",
                    "TestRef": "oval:com.redhat.rhsa:tst:20170920001"
                  },
                  {
                    "Comment": "389-ds-base is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20151554002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "389-ds-base-devel is earlier than 0:1.3.5.10-20.el7_3",
                    "TestRef": "oval:com.redhat.rhsa:tst:20170920003"
                  },
                  {
                    "Comment": "389-ds-base-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20151554004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "389-ds-base-libs is earlier than 0:1.3.5.10-20.el7_3",
                    "TestRef": "oval:com.redhat.rhsa:tst:20170920005"
                  },
                  {
                    "Comment": "389-ds-base-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhba:tst:20151554006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "389-ds-base-snmp is earlier than 0:1.3.5.10-20.el7_3",
                    "TestRef": "oval:com.redhat.rhsa:tst:20170920007"
                  },
                  {
                    "Comment": "389-ds-base-snmp is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.rhsa:tst:20162594008"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}