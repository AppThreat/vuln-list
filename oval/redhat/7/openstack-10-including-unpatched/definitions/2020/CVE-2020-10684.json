{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202010684",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2020-10684 Ansible: code injection when using ansible_facts as a subkey (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2020-10684",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2020-10684"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in the Ansible Engine. When using ansible_facts as a subkey of itself, and promoting it to a variable when injecting is enabled, overwriting the ansible_facts after the clean, an attacker could take advantage of this by altering the ansible_facts leading to privilege escalation or code injection. The highest threat from this vulnerability are to data integrity and system availability. \n            STATEMENT: * Ansible Engine 2.7.16, 2.8.10, and 2.9.6 as well as previous versions are affected.\n* Ansible Tower 3.4.5, 3.5.5 and 3.6.3 as well as previous versions are affected.\n* Red Hat Gluster Storage and Red Hat Ceph Storage no longer maintains their own version of Ansible. The fix will be consumed from core Ansible. But we still ship ansible separately for ceph ubuntu.\n* Red Hat OpenStack Platform does package the affected code. However, because RHOSP does not use ansible_facts as a subkey directly, the RHOSP impact has been reduced to Moderate and no update will be provided at this time for the RHOSP ansible package.\n            MITIGATION: Currently, there is not a known mitigation except avoiding the functionality of using ansible_facts as a subkey.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2022-10-02"
      },
      "Cves": [
        {
          "CveID": "CVE-2020-10684",
          "Cvss3": "7.9/CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:N/I:H/A:H",
          "Cwe": "CWE-862",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2020-10684",
          "Public": "20200323"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:openstack-optools:10",
        "cpe:/a:redhat:openstack-optools:10::el7",
        "cpe:/a:redhat:openstack:10",
        "cpe:/a:redhat:openstack:10::el7"
      ],
      "Affected": {
        "Resolution": {
          "State": "Out of support scope"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20115034004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20115034003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ansible is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20177550003"
                  },
                  {
                    "Comment": "ansible is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20177550004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ansible-doc is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20177550001"
                  },
                  {
                    "Comment": "ansible-doc is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20177550002"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}