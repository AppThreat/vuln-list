{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202345803",
  "Version": "636",
  "Metadata": {
    "Title": "urllib3: Request body not stripped after redirect from 303 status changes request method to GET (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2023-45803",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2023-45803"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in urllib3, an HTTP client library for Python. urllib3 doesn't remove the HTTP request body when an HTTP redirect response using status 301, 302, or 303, after changing the method in a request from one that could accept a request body such as `POST` to `GET`, as is required by HTTP RFCs. This issue requires a previously trusted service to become compromised in order to have an impact on confidentiality, therefore, the exploitability of this vulnerability is low. Additionally, many users aren't putting sensitive data in HTTP request bodies; if this is the case, this vulnerability isn't exploitable. \n            STATEMENT: Both of the following conditions must be true to be affected by this vulnerability: \n1. Using urllib3 and submitting sensitive information in the HTTP request body such as form data or JSON\n2. The origin service is compromised and starts redirecting using 301, 302, or 303 to a malicious peer or the redirected-to service becomes compromised\n            MITIGATION: Users unable to update should disable redirects for services that aren't expecting to respond with redirects with `redirects=False`, disable automatic redirects with `redirects=False`, and handle 301, 302, and 303 redirects manually by stripping the HTTP request body.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2024-03-15"
      },
      "Cves": [
        {
          "CveID": "CVE-2023-45803",
          "Cvss3": "4.2/CVSS:3.1/AV:A/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N",
          "Cwe": "CWE-200",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2023-45803",
          "Public": "20231013"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:rhel_extras:7",
        "cpe:/a:redhat:rhel_extras_oracle_java:7",
        "cpe:/a:redhat:rhel_extras_rt:7",
        "cpe:/a:redhat:rhel_extras_sap:7",
        "cpe:/a:redhat:rhel_extras_sap_hana:7",
        "cpe:/o:redhat:enterprise_linux:7",
        "cpe:/o:redhat:enterprise_linux:7::client",
        "cpe:/o:redhat:enterprise_linux:7::computenode",
        "cpe:/o:redhat:enterprise_linux:7::server",
        "cpe:/o:redhat:enterprise_linux:7::workstation"
      ],
      "Affected": {
        "Resolution": {
          "State": "Out of support scope"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20042779006"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20042779005"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python-urllib3 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201825091017"
                  },
                  {
                    "Comment": "python-urllib3 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201825091018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python-s3transfer is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201825091001"
                  },
                  {
                    "Comment": "python-s3transfer is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201825091002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "resource-agents-sap is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201825091013"
                  },
                  {
                    "Comment": "resource-agents-sap is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201825091014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "resource-agents-aliyun is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201825091009"
                  },
                  {
                    "Comment": "resource-agents-aliyun is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201825091010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "resource-agents-gcp is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201825091007"
                  },
                  {
                    "Comment": "resource-agents-gcp is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201825091008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "resource-agents-sap-hana is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201825091003"
                  },
                  {
                    "Comment": "resource-agents-sap-hana is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201825091004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python-pip is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201820225003"
                  },
                  {
                    "Comment": "python-pip is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201820225004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "resource-agents-sap-hana-scaleout is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201825091019"
                  },
                  {
                    "Comment": "resource-agents-sap-hana-scaleout is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201825091020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "resource-agents is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201825091005"
                  },
                  {
                    "Comment": "resource-agents is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201825091006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-pip is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201820225001"
                  },
                  {
                    "Comment": "python3-pip is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201820225002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "sap-cluster-connector is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201825091021"
                  },
                  {
                    "Comment": "sap-cluster-connector is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201825091022"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}