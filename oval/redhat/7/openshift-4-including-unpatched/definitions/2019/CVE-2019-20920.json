{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:201920920",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2019-20920 nodejs-handlebars: lookup helper fails to properly validate templates allowing for arbitrary JavaScript execution (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2019-20920",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2019-20920"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in nodejs-handlebars, where affected versions of handlebars are vulnerable to arbitrary code execution. The package lookup helper fails to properly validate templates, allowing attackers to submit templates that execute arbitrary JavaScript into the system. This issue is used to run arbitrary code in a server processing Handlebars templates or on a victim's browser (effectively serving as Cross-Site Scripting). The highest threat from this vulnerability is to confidentiality.\n            STATEMENT: Red Hat Quay includes Handlebars.js as a development dependency. It does not use Handlebars.js at runtime to process templates, so it has been given a low impact rating.\n\nRed Hat Virtualization includes Handlebars.js in two components. In ovirt-engine-ui-extentions, the version used is newer and is not affected by this flaw. In ovirt-web-ui, Handlebars.js is included as a development dependency and is not used at runtime to process templates, so it has been given a low impact rating.\n\nRed Hat OpenShift Container Platform (OCP) 4 delivers the kibana package, which includes Handlebars.js. From OCP 4.6, the kibana package is no longer shipped and will not be fixed. The openshift4/ose-logging-kibana6 container includes Handlebars.js directly as container first code. The vulnerable version of Handlebars.js is also included in openshift4/ose-grafana, but as the Grafana instance is in read-only mode, the configuration/dashboards cannot be modified.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2021-06-29"
      },
      "Cves": [
        {
          "CveID": "CVE-2019-20920",
          "Cvss3": "8.1/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L",
          "Cwe": "CWE-20",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2019-20920",
          "Public": "20191104"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:openshift:4.9",
        "cpe:/a:redhat:openshift:4.9::el7"
      ],
      "Affected": {
        "Resolution": {
          "State": "Will not fix"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201714623004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201714623003"
          },
          {
            "Comment": "kibana is installed",
            "TestRef": "oval:com.redhat.cve:tst:201816487001"
          },
          {
            "Comment": "kibana is signed with Red Hat redhatrelease2 key",
            "TestRef": "oval:com.redhat.cve:tst:201816487002"
          }
        ]
      }
    ]
  }
}