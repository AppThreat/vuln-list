{
  "mitigation": "Bad password lockout is not configured by default, it is only\neffective if a threshold has been set with (eg):\nsamba-tool domain passwordsettings set --account-lockout-threshold=3\nTo mitigate the issue set a shorter 'Reset account lockout after'\nwindow (the ineffective default is 30, anything less than 15 will\nwork):\nsamba-tool domain passwordsettings set --reset-account-lockout-after=15\nNOTE: If a fine-grained password policy (PSO) is set, this must also\nbe done on each PSO.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Not affected",
      "package_name": "samba3x",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "samba4",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Storage 3",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/a:redhat:storage:3"
    },
    {
      "product_name": "Red Hat Virtualization 4",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/a:redhat:enterprise_linux:8::hypervisor"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2018-11-20T00:00:00Z",
  "bugzilla": {
    "description": "samba: Bad password count in AD DC not always effective",
    "id": "1649278",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1649278"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.4",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-358",
  "statement": "This flaw does not affect the version of samba shipped with Red Hat Enterprise Linux because there is no support for samba as Active Directory Domain Controller.",
  "acknowledgement": "Red Hat would like to thank the Samba project for reporting this issue. Upstream acknowledges Isaac Boukris as the original reporter.",
  "name": "CVE-2018-16857",
  "document_distribution": "",
  "details": [
    "Samba from version 4.9.0 and before version 4.9.3 that have AD DC configurations watching for bad passwords (to restrict brute forcing of passwords) in a window of more than 3 minutes may not watch for bad passwords at all. The primary risk from this issue is with regards to domains that have been upgraded from Samba 4.8 and earlier. In these cases the manual testing done to confirm an organisation's password policies apply as expected may not have been re-done after the upgrade.",
    "It was found that the 'bad password observation window' was ineffective when set to a value greater than 3 minutes. This could allow for brute force password attacks in some situations."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2018-16857\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-16857\nhttps://www.samba.org/samba/security/CVE-2018-16857.html"
  ]
}