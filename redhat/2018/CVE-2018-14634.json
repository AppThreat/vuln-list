{
  "mitigation": "To mitigate the issue:\nEnable and install kernel-debuginfo packages as per https://access.redhat.com/solutions/666123\n1) On the host, save the following in a file with the \".stp\" extension:\n// CVE-2018-14634\n//\n// Theory of operations: adjust the thread's # rlimit-in-effect around\n// calls to the vulnerable get_arg_page() function so as to encompass\n// the newly required _STK_LIM / 4 * 3 maximum.\n// Complication: the rlimit is stored in a current-\u003e structure that\n// is shared across the threads of the process.  They may concurrently\n// invoke this operation.\nfunction clamp_stack_rlim_cur:long ()\n%{\nstruct rlimit *rlim = current-\u003esignal-\u003erlim;\nunsigned long rlim_cur = READ_ONCE(rlim[RLIMIT_STACK].rlim_cur);\nunsigned long limit = _STK_LIM / 4 * 3;\nlimit *= 4; // multiply it back up, to the scale used by rlim_cur\nif (rlim_cur \u003e limit) {\nWRITE_ONCE(rlim[RLIMIT_STACK].rlim_cur, limit);\nSTAP_RETURN(limit);\n} else\nSTAP_RETURN(0);\n%}\nprobe kernel.function(\"copy_strings\").call\n{\nl = clamp_stack_rlim_cur()\nif (l)\nprintf(\"lowered process %s(%d) STACK rlim_cur to %p\\n\",\nexecname(), pid(), l)\n}\nprobe begin {\nprintf(\"CVE-2018-14634 mitigation loaded\\n\")\n}\nprobe end {\nprintf(\"CVE-2018-14634 mitigation unloaded\\n\")\n}\n2) Install the \"systemtap\" package and any required dependencies. Refer\nto the \"2. Using SystemTap\" chapter in the Red Hat Enterprise Linux\n\"SystemTap Beginners Guide\" document, available from docs.redhat.com,\nfor information on installing the required -debuginfo and matching kernel-devel packages\n3) Run the \"stap -g [filename-from-step-1].stp\" command as root.\nIf the host is rebooted, the changes will be lost and the script must be\nrun again.\nAlternatively, build the systemtap script on a development system with\n\"stap -g -p 4 [filename-from-step-1].stp\", distribute the resulting\nkernel module to all affected systems, and run \"staprun -L \u003cmodule\u003e\" on those.\nWhen using this approach only systemtap-runtime package is required on\nthe affected systems. Please notice that the kernel version must be the same\nacross all systems.\nThis may not be a suitable workaround if your application uses massive amounts of stack space. Please consider this if there are any adverse affects when running this mitigation.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "release_date": "2018-10-09T00:00:00Z",
      "advisory": "RHSA-2018:2846",
      "package": "kernel-0:2.6.32-754.6.3.el6",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.4 Advanced Update Support",
      "release_date": "2018-11-20T00:00:00Z",
      "advisory": "RHSA-2018:3643",
      "package": "kernel-0:2.6.32-358.94.1.el6",
      "cpe": "cpe:/o:redhat:rhel_aus:6.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.5 Advanced Update Support",
      "release_date": "2018-10-16T00:00:00Z",
      "advisory": "RHSA-2018:2933",
      "package": "kernel-0:2.6.32-431.93.2.el6",
      "cpe": "cpe:/o:redhat:rhel_aus:6.5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.6 Advanced Update Support",
      "release_date": "2018-10-16T00:00:00Z",
      "advisory": "RHSA-2018:2924",
      "package": "kernel-0:2.6.32-504.76.2.el6",
      "cpe": "cpe:/o:redhat:rhel_aus:6.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.6 Telco Extended Update Support",
      "release_date": "2018-10-16T00:00:00Z",
      "advisory": "RHSA-2018:2924",
      "package": "kernel-0:2.6.32-504.76.2.el6",
      "cpe": "cpe:/o:redhat:rhel_tus:6.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.7 Extended Update Support",
      "release_date": "2018-10-17T00:00:00Z",
      "advisory": "RHSA-2018:2925",
      "package": "kernel-0:2.6.32-573.65.2.el6",
      "cpe": "cpe:/o:redhat:rhel_eus:6.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2018-09-25T00:00:00Z",
      "advisory": "RHSA-2018:2763",
      "package": "kernel-rt-0:3.10.0-862.14.4.rt56.821.el7",
      "cpe": "cpe:/a:redhat:rhel_extras_rt:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2018-09-25T00:00:00Z",
      "advisory": "RHSA-2018:2748",
      "package": "kernel-0:3.10.0-862.14.4.el7",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.2 Advanced Update Support",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3590",
      "package": "kernel-0:3.10.0-327.76.1.el7",
      "cpe": "cpe:/o:redhat:rhel_aus:7.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.2 Telco Extended Update Support",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3590",
      "package": "kernel-0:3.10.0-327.76.1.el7",
      "cpe": "cpe:/o:redhat:rhel_tus:7.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.2 Update Services for SAP Solutions",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3590",
      "package": "kernel-0:3.10.0-327.76.1.el7",
      "cpe": "cpe:/o:redhat:rhel_e4s:7.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.3 Extended Update Support",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3591",
      "package": "kernel-0:3.10.0-514.61.1.el7",
      "cpe": "cpe:/o:redhat:rhel_eus:7.3"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.4 Extended Update Support",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3540",
      "package": "kernel-0:3.10.0-693.43.1.el7",
      "cpe": "cpe:/o:redhat:rhel_eus:7.4"
    },
    {
      "product_name": "Red Hat Enterprise MRG 2",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3586",
      "package": "kernel-rt-1:3.10.0-693.43.1.rt56.630.el6rt",
      "cpe": "cpe:/a:redhat:enterprise_mrg:2:server:el6"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-alt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2018-09-25T17:00:00Z",
  "bugzilla": {
    "description": "kernel: Integer overflow in Linux's create_elf_tables function",
    "id": "1624498",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1624498"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.8",
    "cvss3_scoring_vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-190",
  "statement": "This issue does not affect 32-bit systems as they do not have a large enough address space to exploit this flaw.\nSystems with less than 32GB of memory are very unlikely to be affected by this issue due to memory demands during exploitation.\nThis issue does not affect the versions of Linux kernel as shipped with Red Hat Enterprise Linux 5.\nThis issue affects the version of the kernel packages as shipped with Red Hat Enterprise Linux 6, 7 and Red Hat Enterprise MRG 2. Future kernel updates for Red Hat Enterprise Linux 6, 7 and Red Hat Enterprise MRG 2 will address this issue.",
  "acknowledgement": "Red Hat would like to thank Qualys Research Labs for reporting this issue.",
  "name": "CVE-2018-14634",
  "document_distribution": "",
  "details": [
    "An integer overflow flaw was found in the Linux kernel's create_elf_tables() function. An unprivileged local user with access to SUID (or otherwise privileged) binary could use this flaw to escalate their privileges on the system. Kernel versions 2.6.x, 3.10.x and 4.14.x are believed to be vulnerable.",
    "An integer overflow flaw was found in the Linux kernel's create_elf_tables() function.  An unprivileged local user with access to SUID (or otherwise privileged) binary could use this flaw to escalate their privileges on the system."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2018-14634\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-14634\nhttps://access.redhat.com/security/vulnerabilities/mutagen-astronomy\nhttps://www.openwall.com/lists/oss-security/2018/09/25/4"
  ]
}