{
  "mitigation": "One may change the default 4MB and 3MB values of net.ipv4.ipfrag_high_thresh and net.ipv4.ipfrag_low_thresh (and their ipv6 counterparts net.ipv6.ipfrag_high_thresh and net.ipv6.ipfrag_low_thresh) to 256 kB and 192 kB (respectively) or below. Tests show some to significant CPU saturation drop during an attack, depending on a hardware, configuration and environment.\nThere can be some impact on performance though, due to ipfrag_high_thresh of 262144 bytes, as only two 64K fragments can fit in the reassembly queue at the same time. For example, there is a risk of breaking applications that rely on large UDP packets.\nSee the Mitigation section in the https://access.redhat.com/articles/3553061 article for the script to quickly change to/from default and lower settings.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "release_date": "2018-10-09T00:00:00Z",
      "advisory": "RHSA-2018:2846",
      "package": "kernel-0:2.6.32-754.6.3.el6",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.4 Advanced Update Support",
      "release_date": "2018-09-25T00:00:00Z",
      "advisory": "RHSA-2018:2791",
      "package": "kernel-0:2.6.32-358.93.1.el6",
      "cpe": "cpe:/o:redhat:rhel_aus:6.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.5 Advanced Update Support",
      "release_date": "2018-10-16T00:00:00Z",
      "advisory": "RHSA-2018:2933",
      "package": "kernel-0:2.6.32-431.93.2.el6",
      "cpe": "cpe:/o:redhat:rhel_aus:6.5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.6 Advanced Update Support",
      "release_date": "2018-10-16T00:00:00Z",
      "advisory": "RHSA-2018:2924",
      "package": "kernel-0:2.6.32-504.76.2.el6",
      "cpe": "cpe:/o:redhat:rhel_aus:6.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.6 Telco Extended Update Support",
      "release_date": "2018-10-16T00:00:00Z",
      "advisory": "RHSA-2018:2924",
      "package": "kernel-0:2.6.32-504.76.2.el6",
      "cpe": "cpe:/o:redhat:rhel_tus:6.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.7 Extended Update Support",
      "release_date": "2018-10-17T00:00:00Z",
      "advisory": "RHSA-2018:2925",
      "package": "kernel-0:2.6.32-573.65.2.el6",
      "cpe": "cpe:/o:redhat:rhel_eus:6.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2018-10-30T00:00:00Z",
      "advisory": "RHSA-2018:3096",
      "package": "kernel-rt-0:3.10.0-957.rt56.910.el7",
      "cpe": "cpe:/a:redhat:rhel_extras_rt:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2018-10-30T00:00:00Z",
      "advisory": "RHSA-2018:2948",
      "package": "kernel-alt-0:4.14.0-115.el7a",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2018-10-30T00:00:00Z",
      "advisory": "RHSA-2018:3083",
      "package": "kernel-0:3.10.0-957.el7",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.2 Advanced Update Support",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3590",
      "package": "kernel-0:3.10.0-327.76.1.el7",
      "cpe": "cpe:/o:redhat:rhel_aus:7.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.2 Telco Extended Update Support",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3590",
      "package": "kernel-0:3.10.0-327.76.1.el7",
      "cpe": "cpe:/o:redhat:rhel_tus:7.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.2 Update Services for SAP Solutions",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3590",
      "package": "kernel-0:3.10.0-327.76.1.el7",
      "cpe": "cpe:/o:redhat:rhel_e4s:7.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.3 Extended Update Support",
      "release_date": "2018-09-25T00:00:00Z",
      "advisory": "RHSA-2018:2785",
      "package": "kernel-0:3.10.0-514.58.1.el7",
      "cpe": "cpe:/o:redhat:rhel_eus:7.3"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.4 Extended Update Support",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3540",
      "package": "kernel-0:3.10.0-693.43.1.el7",
      "cpe": "cpe:/o:redhat:rhel_eus:7.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.5 Extended Update Support",
      "release_date": "2018-11-06T00:00:00Z",
      "advisory": "RHSA-2018:3459",
      "package": "kernel-0:3.10.0-862.20.2.el7",
      "cpe": "cpe:/o:redhat:rhel_eus:7.5"
    },
    {
      "product_name": "Red Hat Enterprise MRG 2",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3586",
      "package": "kernel-rt-1:3.10.0-693.43.1.rt56.630.el6rt",
      "cpe": "cpe:/a:redhat:enterprise_mrg:2:server:el6"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Will not fix",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2018-08-14T16:00:00Z",
  "bugzilla": {
    "description": "kernel: IP fragments with random offsets allow a remote denial of service (FragmentSmack)",
    "id": "1609664",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1609664"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-400",
  "statement": "Red Hat Product Security is aware of this issue. Updates will be released as they become available. For additional information, please refer to the Red Hat Knowledgebase article: https://access.redhat.com/articles/3553061\nThis issue affects the versions of the Linux kernel as shipped with Red Hat Enterprise Linux 6, 7, its real-time kernel, Red Hat Enterprise MRG 2, Red Hat Enterprise Linux 7 for ARM 64, and Red Hat Enterprise Linux 7 for Power 9. Future kernel updates for the respective releases will address this issue.\nThis issue affects the Linux kernel packages as shipped with Red Hat Enterprise Linux 5, but to a lesser degree. As such, the issue severity for RHEL5 is considered Moderate. This is not currently planned to be addressed in future updates of the product due to its life cycle and the issue severity. For additional information, refer to the Red Hat Enterprise Linux Life Cycle: https://access.redhat.com/support/policy/updates/errata/.",
  "acknowledgement": "Red Hat would like to thank Juha-Matti Tilli (Aalto University - Department of Communications and Networking and Nokia Bell Labs) for reporting this issue.",
  "name": "CVE-2018-5391",
  "document_distribution": "",
  "details": [
    "The Linux kernel, versions 3.9+, is vulnerable to a denial of service attack with low rates of specially modified packets targeting IP fragment re-assembly. An attacker may cause a denial of service condition by sending specially crafted IP fragments. Various vulnerabilities in IP fragmentation have been discovered and fixed over the years. The current vulnerability (CVE-2018-5391) became exploitable in the Linux kernel with the increase of the IP fragment reassembly queue size.",
    "A flaw named FragmentSmack was found in the way the Linux kernel handled reassembly of fragmented IPv4 and IPv6 packets. A remote attacker could use this flaw to trigger time and calculation expensive fragment reassembly algorithm by sending specially crafted packets which could lead to a CPU saturation and hence a denial of service on the system."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2018-5391\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-5391\nhttps://access.redhat.com/articles/3553061\nhttps://www.kb.cert.org/vuls/id/641765"
  ]
}