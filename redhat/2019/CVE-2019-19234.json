{
  "mitigation": "This flaw basically allows users which have disabled account in /etc/shadow (password is replaced with '!) to have sudo access. Systems not having such disabled account, or systems disabling sudo access for such accounts using other means (such as not allowing such users to run sudo via access control mechanisms) are not affected by this flaw.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2020-04-28T00:00:00Z",
      "advisory": "RHSA-2020:1804",
      "package": "sudo-0:1.8.29-5.el8",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Will not fix",
      "package_name": "sudo",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Will not fix",
      "package_name": "sudo",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Will not fix",
      "package_name": "sudo",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2019-12-19T00:00:00Z",
  "bugzilla": {
    "description": "sudo: by using ! character in the shadow file instead of a password hash can access to a run as all sudoer account",
    "id": "1786708",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1786708"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-284",
  "statement": "The new runas_check_shell sudoers setting can be used to require that the runas user have a shell listed in the /etc/shells file. On many systems, users such as bin, do not have a valid shell and this flag can be used to prevent commands from being run as those users.",
  "acknowledgement": "",
  "name": "CVE-2019-19234",
  "document_distribution": "",
  "details": [
    "In Sudo through 1.8.29, the fact that a user has been blocked (e.g., by using the ! character in the shadow file instead of a password hash) is not considered, allowing an attacker (who has access to a Runas ALL sudoer account) to impersonate any blocked user. NOTE: The software maintainer believes that this CVE is not valid. Disabling local password authentication for a user is not the same as disabling all access to that user--the user may still be able to login via other means (ssh key, kerberos, etc). Both the Linux shadow(5) and passwd(1) manuals are clear on this. Indeed it is a valid use case to have local accounts that are _only_ accessible via sudo and that cannot be logged into with a password. Sudo 1.8.30 added an optional setting to check the _shell_ of the target user (not the encrypted password!) against the contents of /etc/shells but that is not the same thing as preventing access to users with an invalid password hash",
    "When an account is disabled via the shadow file, by replacing the password hash with \"!\", it is not considered disabled by sudo. And depending on the configuration, sudo can be run by using such disabled account."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2019-19234\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-19234\nhttps://www.sudo.ws/stable.html#1.8.30"
  ]
}