{
  "mitigation": "Only clients configured directly in LDAP or via a Windows tools could have been marked as sensitive and so have been expected to have this protection.  Therefore most Samba sites will not have been using this feature and so are not impacted either way.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "samba4",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Storage 3",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/a:redhat:storage:3"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2019-12-10T00:00:00Z",
  "bugzilla": {
    "description": "samba: The DelegationNotAllowed Kerberos feature restriction was not being applied when processing protocol transition requests (S4U2Self), in the AD DC KDC",
    "id": "1778589",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1778589"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.4",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-285",
  "statement": "This flaw does not affect the version of samba shipped with Red Hat Enterprise Linux because there is no support for samba as Active Directory Domain Controller.",
  "acknowledgement": "Red Hat would like to thank the Samba project for reporting this issue. Upstream acknowledges Isaac Boukris (Red Hat and Samba Team) as the original reporter.",
  "name": "CVE-2019-14870",
  "document_distribution": "",
  "details": [
    "All Samba versions 4.x.x before 4.9.17, 4.10.x before 4.10.11 and 4.11.x before 4.11.3 have an issue, where the S4U (MS-SFU) Kerberos delegation model includes a feature allowing for a subset of clients to be opted out of constrained delegation in any way, either S4U2Self or regular Kerberos authentication, by forcing all tickets for these clients to be non-forwardable. In AD this is implemented by a user attribute delegation_not_allowed (aka not-delegated), which translates to disallow-forwardable. However the Samba AD DC does not do that for S4U2Self and does set the forwardable flag even if the impersonated client has the not-delegated flag set."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2019-14870\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-14870\nhttps://www.samba.org/samba/security/CVE-2019-14870.html"
  ]
}