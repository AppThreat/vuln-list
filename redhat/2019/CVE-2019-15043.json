{
  "mitigation": "Block access to the snapshot feature by blocking the /api/snapshots \nURL via a web application firewall, load balancer, reverse proxy etc.\nYou can also set 'external_enabled' to false to disable external \nsnapshot publish endpoint (default true). Note, it will completely\ndisable this feature.\n# cat /etc/grafana/grafana.ini\n[...]\n[snapshots]\n# snapshot sharing options\nexternal_enabled = false\nexternal_snapshot_url = https://snapshots-origin.raintank.io\nexternal_snapshot_name = Publish to snapshot.raintank.io\n[...]",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2020-04-28T00:00:00Z",
      "advisory": "RHSA-2020:1659",
      "package": "grafana-0:6.3.6-1.el8",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Ceph Storage 2",
      "fix_state": "Out of support scope",
      "package_name": "grafana",
      "cpe": "cpe:/a:redhat:ceph_storage:2"
    },
    {
      "product_name": "Red Hat Ceph Storage 3",
      "fix_state": "Affected",
      "package_name": "grafana",
      "cpe": "cpe:/a:redhat:ceph_storage:3"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Affected",
      "package_name": "openshift3/grafana",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Affected",
      "package_name": "openshift4/ose-grafana",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat Storage 3",
      "fix_state": "Fix deferred",
      "package_name": "grafana",
      "cpe": "cpe:/a:redhat:storage:3"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2019-08-29T18:00:00Z",
  "bugzilla": {
    "description": "grafana: incorrect access control in snapshot HTTP API leads to denial of service",
    "id": "1746945",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1746945"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "4.3",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L",
    "status": "verified"
  },
  "iava": "",
  "cwe": "(CWE-284|CWE-200)",
  "statement": "OpenShift Container Platform secures all usages of Grafana behind the oauth-proxy, preventing access to Grafana without authentication. Red Hat Product Security have rated this vulnerability as Low for OpenShift Container Platform.\nThis issue affects the version of Grafana as shipped with Red Hat Gluster Storage 3 and Red Hat Ceph Storage 3, as it contains the vulnerable snapshot functionality.",
  "acknowledgement": "Red Hat would like to thank the Grafana team for reporting this issue.",
  "name": "CVE-2019-15043",
  "document_distribution": "",
  "details": [
    "In Grafana 2.x through 6.x before 6.3.4, parts of the HTTP API allow unauthenticated use. This makes it possible to run a denial of service attack against the server running Grafana."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2019-15043\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-15043\nhttps://grafana.com/blog/2019/08/29/grafana-5.4.5-and-6.3.4-released-with-important-security-fix/"
  ]
}