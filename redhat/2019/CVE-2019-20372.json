{
  "mitigation": "To mitigate this issue, use a named location instead of having the error_page handler do the redirect, this configuration is not vulnerable to request smuggling on all versions of NGINX we tested.\nserver {\nlisten 80;\nserver_name localhost;\nerror_page 401 @401;\nlocation / {\nreturn 401;\n}\nlocation @401 {\nreturn 302 http://example.org;\n}\n}",
  "affected_release": [
    {
      "product_name": "Red Hat Ansible Tower 3.6 for RHEL 7",
      "release_date": "2021-03-09T00:00:00Z",
      "advisory": "RHSA-2021:0778",
      "package": "ansible-tower-36/ansible-tower:3.6.7-1",
      "cpe": "cpe:/a:redhat:ansible_tower:3.6::el7"
    },
    {
      "product_name": "Red Hat Ansible Tower 3.7 for RHEL 7",
      "release_date": "2021-03-09T00:00:00Z",
      "advisory": "RHSA-2021:0779",
      "package": "ansible-tower-37/ansible-tower-rhel7:3.7.5-1",
      "cpe": "cpe:/a:redhat:ansible_tower:3.7::el7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2020-12-15T00:00:00Z",
      "advisory": "RHSA-2020:5495",
      "package": "nginx:1.16-8030020201124104955.229f0a1c",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2020-07-02T00:00:00Z",
      "advisory": "RHSA-2020:2817",
      "package": "rh-nginx116-nginx-1:1.16.1-4.el7.1",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
      "release_date": "2020-07-02T00:00:00Z",
      "advisory": "RHSA-2020:2817",
      "package": "rh-nginx116-nginx-1:1.16.1-4.el7.1",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
      "release_date": "2020-07-02T00:00:00Z",
      "advisory": "RHSA-2020:2817",
      "package": "rh-nginx116-nginx-1:1.16.1-4.el7.1",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    }
  ],
  "package_state": [
    {
      "product_name": "CloudForms Management Engine 5",
      "fix_state": "Will not fix",
      "package_name": "nginx",
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Will not fix",
      "package_name": "nginx:1.14/nginx",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Software Collections",
      "fix_state": "Will not fix",
      "package_name": "rh-nginx110-nginx",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections",
      "fix_state": "Will not fix",
      "package_name": "rh-nginx114-nginx",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2020-01-09T00:00:00Z",
  "bugzilla": {
    "description": "nginx: HTTP request smuggling in configurations with URL redirect used as error_page",
    "id": "1790277",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1790277"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.3",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-444",
  "statement": "Ansible Tower 3.5 and 3.6 are not vulnerable by default as are not using error_page variable in the nginx configuration. However, Ansible Tower 3.5 and 3.6 are distributing nginx 1.14 and 1.16 vulnerable versions as a dependency and configuration could be modified making it vulnerable.\nRed Hat CloudForms Management Engine 5.9 and 5.10 are not vulnerable by default as are not using error_page variable in the nginx configuration. However, both mentioned builds ships vulnerable nginx versions 1.10 and 1.14 respectively. CloudForms 5.11 does not use nginx directly hence it is not vulnerable.\nRed Hat Quay's configuration of nginx means it's not affected by this issue. It doesn't use error_page to do a 302 redirect. It's only use of error_page uses a named location ie:\nerror_page 404 /404.html;\nlocation = /40x.html {\n}\nerror_page 500 502 503 504 /50x.html;\nlocation = /50x.html {\n}",
  "acknowledgement": "",
  "name": "CVE-2019-20372",
  "document_distribution": "",
  "details": [
    "NGINX before 1.17.7, with certain error_page configurations, allows HTTP request smuggling, as demonstrated by the ability of an attacker to read unauthorized web pages in environments where NGINX is being fronted by a load balancer."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2019-20372\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-20372"
  ]
}