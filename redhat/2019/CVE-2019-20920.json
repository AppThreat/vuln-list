{
  "affected_release": [
    {
      "product_name": "Red Hat OpenShift Container Platform 4.6",
      "release_date": "2021-06-29T00:00:00Z",
      "advisory": "RHSA-2021:2500",
      "package": "openshift4/ose-logging-kibana6:v4.6.0-202106181629.p0.git.40f3e72",
      "cpe": "cpe:/a:redhat:openshift:4.6::el8"
    },
    {
      "product_name": "Red Hat Quay 3",
      "release_date": "2021-10-19T00:00:00Z",
      "advisory": "RHSA-2021:3917",
      "package": "quay/quay-rhel8:v3.6.0-62",
      "cpe": "cpe:/a:redhat:quay:3::el8"
    },
    {
      "product_name": "Red Hat Virtualization Engine 4.4",
      "release_date": "2020-11-24T00:00:00Z",
      "advisory": "RHSA-2020:5179",
      "package": "ovirt-web-ui-0:1.6.5-1.el8ev",
      "cpe": "cpe:/a:redhat:rhev_manager:4.4:el8"
    },
    {
      "product_name": "RHPAM 7.13.1 async",
      "release_date": "2023-03-20T00:00:00Z",
      "advisory": "RHSA-2023:1334",
      "package": "handlebars",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7.13"
    }
  ],
  "package_state": [
    {
      "product_name": "OpenShift Service Mesh 1",
      "fix_state": "Not affected",
      "package_name": "kiali",
      "cpe": "cpe:/a:redhat:service_mesh:1"
    },
    {
      "product_name": "OpenShift Service Mesh 1",
      "fix_state": "Will not fix",
      "package_name": "servicemesh-grafana",
      "cpe": "cpe:/a:redhat:service_mesh:1"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "handlebars",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Will not fix",
      "package_name": "kibana",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Will not fix",
      "package_name": "openshift3/grafana",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Will not fix",
      "package_name": "kibana",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Will not fix",
      "package_name": "openshift4/ose-grafana",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat Virtualization 4",
      "fix_state": "Not affected",
      "package_name": "ovirt-engine-ui-extensions",
      "cpe": "cpe:/a:redhat:enterprise_linux:8::hypervisor"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2019-11-04T00:00:00Z",
  "bugzilla": {
    "description": "nodejs-handlebars: lookup helper fails to properly validate templates allowing for arbitrary JavaScript execution",
    "id": "1882260",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1882260"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-20",
  "statement": "Red Hat Quay includes Handlebars.js as a development dependency. It does not use Handlebars.js at runtime to process templates, so it has been given a low impact rating.\nRed Hat Virtualization includes Handlebars.js in two components. In ovirt-engine-ui-extentions, the version used is newer and is not affected by this flaw. In ovirt-web-ui, Handlebars.js is included as a development dependency and is not used at runtime to process templates, so it has been given a low impact rating.\nRed Hat OpenShift Container Platform (OCP) 4 delivers the kibana package, which includes Handlebars.js. From OCP 4.6, the kibana package is no longer shipped and will not be fixed. The openshift4/ose-logging-kibana6 container includes Handlebars.js directly as container first code. The vulnerable version of Handlebars.js is also included in openshift4/ose-grafana, but as the Grafana instance is in read-only mode, the configuration/dashboards cannot be modified.",
  "acknowledgement": "",
  "name": "CVE-2019-20920",
  "document_distribution": "",
  "details": [
    "Handlebars before 3.0.8 and 4.x before 4.5.3 is vulnerable to Arbitrary Code Execution. The lookup helper fails to properly validate templates, allowing attackers to submit templates that execute arbitrary JavaScript. This can be used to run arbitrary code on a server processing Handlebars templates or in a victim's browser (effectively serving as XSS).",
    "A flaw was found in nodejs-handlebars, where affected versions of handlebars are vulnerable to arbitrary code execution. The package lookup helper fails to properly validate templates, allowing attackers to submit templates that execute arbitrary JavaScript into the system. This issue is used to run arbitrary code in a server processing Handlebars templates or on a victim's browser (effectively serving as Cross-Site Scripting). The highest threat from this vulnerability is to confidentiality."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2019-20920\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-20920\nhttps://www.npmjs.com/advisories/1316\nhttps://www.npmjs.com/advisories/1324"
  ]
}