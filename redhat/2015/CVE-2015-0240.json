{
  "mitigation": "On Samba versions 4.0.0 and above, add the line:\nrpc_server:netlogon=disabled\nto the [global] section of your smb.conf. For Samba versions 3.6.x and\nearlier, this workaround is not available.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "release_date": "2015-02-23T00:00:00Z",
      "advisory": "RHSA-2015:0249",
      "package": "samba3x-0:3.6.23-9.el5_11",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 5.6 Long Life",
      "release_date": "2015-02-23T00:00:00Z",
      "advisory": "RHSA-2015:0253",
      "package": "samba3x-0:3.5.4-0.70.el5_6.4",
      "cpe": "cpe:/o:redhat:rhel_mission_critical:5.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 5.9 Extended Update Support",
      "release_date": "2015-02-23T00:00:00Z",
      "advisory": "RHSA-2015:0253",
      "package": "samba3x-0:3.6.6-0.131.el5_9",
      "cpe": "cpe:/o:redhat:rhel_eus:5.9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "release_date": "2015-02-23T00:00:00Z",
      "advisory": "RHSA-2015:0250",
      "package": "samba4-0:4.0.0-66.el6_6.rc4",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "release_date": "2015-02-23T00:00:00Z",
      "advisory": "RHSA-2015:0251",
      "package": "samba-0:3.6.23-14.el6_6",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.2 Advanced Update Support",
      "release_date": "2015-02-23T00:00:00Z",
      "advisory": "RHSA-2015:0254",
      "package": "samba-0:3.5.10-119.el6_2",
      "cpe": "cpe:/o:redhat:rhel_mission_critical:6.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.4 Extended Update Support",
      "release_date": "2015-02-23T00:00:00Z",
      "advisory": "RHSA-2015:0254",
      "package": "samba-0:3.6.9-151.el6_4.3",
      "cpe": "cpe:/o:redhat:rhel_eus:6.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.4 Extended Update Support",
      "release_date": "2015-02-23T00:00:00Z",
      "advisory": "RHSA-2015:0255",
      "package": "samba4-0:4.0.0-57.el6_4.rc4",
      "cpe": "cpe:/o:redhat:rhel_eus:6.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.5 Extended Update Support",
      "release_date": "2015-02-23T00:00:00Z",
      "advisory": "RHSA-2015:0254",
      "package": "samba-0:3.6.9-171.el6_5",
      "cpe": "cpe:/o:redhat:rhel_eus:6.5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.5 Extended Update Support",
      "release_date": "2015-02-23T00:00:00Z",
      "advisory": "RHSA-2015:0255",
      "package": "samba4-0:4.0.0-65.el6_5.rc4",
      "cpe": "cpe:/o:redhat:rhel_eus:6.5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2015-02-23T00:00:00Z",
      "advisory": "RHSA-2015:0252",
      "package": "samba-0:4.1.1-38.el7_0",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Storage 2.1",
      "release_date": "2015-02-23T00:00:00Z",
      "advisory": "RHSA-2015:0257",
      "package": "samba-0:3.6.9-167.10.3.el6rhs",
      "cpe": "cpe:/a:redhat:storage:2.1:server:el6"
    },
    {
      "product_name": "Red Hat Storage 3 for RHEL 6",
      "release_date": "2015-02-23T00:00:00Z",
      "advisory": "RHSA-2015:0256",
      "package": "samba-0:3.6.509-169.6.el6rhs",
      "cpe": "cpe:/a:redhat:storage:3:server:el6"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 4",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux Extended Update Support 5.6",
      "fix_state": "Affected",
      "package_name": "samba3x",
      "cpe": "cpe:/o:redhat:rhel_eus:5.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux Extended Update Support 6.2",
      "fix_state": "Not affected",
      "package_name": "samba4",
      "cpe": "cpe:/o:redhat:rhel_eus:6.2"
    }
  ],
  "threat_severity": "Critical",
  "public_date": "2015-02-23T00:00:00Z",
  "bugzilla": {
    "description": "samba: talloc free on uninitialized stack pointer in netlogon server could lead to remote-code execution",
    "id": "1191325",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1191325"
  },
  "cvss": {
    "cvss_base_score": "7.9",
    "cvss_scoring_vector": "AV:A/AC:M/Au:N/C:C/I:C/A:C",
    "status": "verified"
  },
  "cvss3": {
    "cvss3_base_score": "",
    "cvss3_scoring_vector": "",
    "status": ""
  },
  "iava": "",
  "cwe": "CWE-119",
  "statement": "This issue does not affect the version of samba package as shipped with Red Hat Enterprise Linux 4 and 5. It does affect the version of samba as shipped with Red Hat Enterprise Linux 6 and 7, as well as the version of samba3x shipped with Red Hat Enterprise Linux 5 and the version of samba4 as shipped with Red Hat Enterprise Linux 6.\nRed Hat Product Security has determined that this vulnerability has Important impact on Red Hat Enterprise Linux 7 because the Samba version shipped in this version of the operating system only executes the vulnerable code after a memory allocation failure, making it more difficult to exploit this flaw.",
  "acknowledgement": "Red Hat would like to thank Samba project for reporting this issue. Upstream acknowledges Richard van Eeden (Microsoft Vulnerability Research) as the original reporter.",
  "name": "CVE-2015-0240",
  "document_distribution": "",
  "details": [
    "The Netlogon server implementation in smbd in Samba 3.5.x and 3.6.x before 3.6.25, 4.0.x before 4.0.25, 4.1.x before 4.1.17, and 4.2.x before 4.2.0rc5 performs a free operation on an uninitialized stack pointer, which allows remote attackers to execute arbitrary code via crafted Netlogon packets that use the ServerPasswordSet RPC API, as demonstrated by packets reaching the _netr_ServerPasswordSet function in rpc_server/netlogon/srv_netlog_nt.c.",
    "An uninitialized pointer use flaw was found in the Samba daemon (smbd). A malicious Samba client could send specially crafted netlogon packets that, when processed by smbd, could potentially lead to arbitrary code execution with the privileges of the user running smbd (by default, the root user)."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2015-0240\nhttps://nvd.nist.gov/vuln/detail/CVE-2015-0240\nhttps://access.redhat.com/articles/1346913\nhttps://securityblog.redhat.com/2015/02/23/samba-vulnerability-cve-2015-0240/\nhttps://www.samba.org/samba/security/CVE-2015-0240"
  ]
}