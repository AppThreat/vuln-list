{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Under investigation",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Under investigation",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Under investigation",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Under investigation",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-04-17T00:00:00Z",
  "bugzilla": {
    "description": "kernel: NFSv4.2: fix nfs4_listxattr kernel BUG at mm/usercopy.c:102",
    "id": "2275711",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2275711"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-26870",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nNFSv4.2: fix nfs4_listxattr kernel BUG at mm/usercopy.c:102\nA call to listxattr() with a buffer size = 0 returns the actual\nsize of the buffer needed for a subsequent call. When size \u003e 0,\nnfs4_listxattr() does not return an error because either\ngeneric_listxattr() or nfs4_listxattr_nfs4_label() consumes\nexactly all the bytes then size is 0 when calling\nnfs4_listxattr_nfs4_user() which then triggers the following\nkernel BUG:\n[   99.403778] kernel BUG at mm/usercopy.c:102!\n[   99.404063] Internal error: Oops - BUG: 00000000f2000800 [#1] SMP\n[   99.408463] CPU: 0 PID: 3310 Comm: python3 Not tainted 6.6.0-61.fc40.aarch64 #1\n[   99.415827] Call trace:\n[   99.415985]  usercopy_abort+0x70/0xa0\n[   99.416227]  __check_heap_object+0x134/0x158\n[   99.416505]  check_heap_object+0x150/0x188\n[   99.416696]  __check_object_size.part.0+0x78/0x168\n[   99.416886]  __check_object_size+0x28/0x40\n[   99.417078]  listxattr+0x8c/0x120\n[   99.417252]  path_listxattr+0x78/0xe0\n[   99.417476]  __arm64_sys_listxattr+0x28/0x40\n[   99.417723]  invoke_syscall+0x78/0x100\n[   99.417929]  el0_svc_common.constprop.0+0x48/0xf0\n[   99.418186]  do_el0_svc+0x24/0x38\n[   99.418376]  el0_svc+0x3c/0x110\n[   99.418554]  el0t_64_sync_handler+0x120/0x130\n[   99.418788]  el0t_64_sync+0x194/0x198\n[   99.418994] Code: aa0003e3 d000a3e0 91310000 97f49bdb (d4210000)\nIssue is reproduced when generic_listxattr() returns 'system.nfs4_acl',\nthus calling lisxattr() with size = 16 will trigger the bug.\nAdd check on nfs4_listxattr() to return ERANGE error when it is\ncalled with size \u003e 0 and the return value is greater than size."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-26870\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-26870\nhttps://lore.kernel.org/linux-cve-announce/2024041738-CVE-2024-26870-7aea@gregkh/T"
  ]
}