{
  "mitigation": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": [
    {
      "product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 8",
      "release_date": "2024-02-29T00:00:00Z",
      "advisory": "RHSA-2024:1057",
      "package": "python3x-jinja2-0:3.1.3-1.el8ap",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el8"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 8",
      "release_date": "2024-04-02T00:00:00Z",
      "advisory": "RHSA-2024:1640",
      "package": "automation-controller-0:4.5.5-2.el8ap",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el8"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 9",
      "release_date": "2024-02-29T00:00:00Z",
      "advisory": "RHSA-2024:1057",
      "package": "python-jinja2-0:3.1.3-1.el9ap",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el9"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 9",
      "release_date": "2024-04-02T00:00:00Z",
      "advisory": "RHSA-2024:1640",
      "package": "automation-controller-0:4.5.5-2.el9ap",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-04-30T00:00:00Z",
      "advisory": "RHSA-2024:2132",
      "package": "fence-agents-0:4.10.0-62.el9",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-04-30T00:00:00Z",
      "advisory": "RHSA-2024:2348",
      "package": "python-jinja2-0:2.11.3-5.el9",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.0 Extended Update Support",
      "release_date": "2024-03-05T00:00:00Z",
      "advisory": "RHSA-2024:1155",
      "package": "fence-agents-0:4.10.0-20.el9_0.11",
      "cpe": "cpe:/a:redhat:rhel_eus:9.0"
    },
    {
      "product_name": "Red Hat Satellite 6.14 for RHEL 8",
      "release_date": "2024-03-27T00:00:00Z",
      "advisory": "RHSA-2024:1536",
      "package": "python-jinja2-0:3.1.3-0.1.el8pc",
      "cpe": "cpe:/a:redhat:satellite:6.14::el8"
    },
    {
      "product_name": "Red Hat Satellite 6.14 for RHEL 8",
      "release_date": "2024-03-27T00:00:00Z",
      "advisory": "RHSA-2024:1536",
      "package": "python-jinja2-0:3.1.3-0.1.el8pc",
      "cpe": "cpe:/a:redhat:satellite_capsule:6.14::el8"
    },
    {
      "product_name": "Red Hat Satellite 6.15 for RHEL 8",
      "release_date": "2024-04-23T00:00:00Z",
      "advisory": "RHSA-2024:2010",
      "package": "python-jinja2-0:3.1.3-1.el8pc",
      "cpe": "cpe:/a:redhat:satellite:6.15::el8"
    },
    {
      "product_name": "Red Hat Satellite 6.15 for RHEL 8",
      "release_date": "2024-04-23T00:00:00Z",
      "advisory": "RHSA-2024:2010",
      "package": "python-jinja2-0:3.1.3-1.el8pc",
      "cpe": "cpe:/a:redhat:satellite_capsule:6.15::el8"
    },
    {
      "product_name": "RHUI 4 for RHEL 8",
      "release_date": "2024-04-18T00:00:00Z",
      "advisory": "RHSA-2024:1878",
      "package": "python-jinja2-0:3.1.3-1.el8ui",
      "cpe": "cpe:/a:redhat:rhui:4::el8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Ansible Automation Platform 1.2",
      "fix_state": "Out of support scope",
      "package_name": "ansible-tower",
      "cpe": "cpe:/a:redhat:ansible_automation_platform"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2",
      "fix_state": "Not affected",
      "package_name": "ansible-lint",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2",
      "fix_state": "Not affected",
      "package_name": "python3-jinja2",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2",
      "fix_state": "Not affected",
      "package_name": "python3x-ansible-compat",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2",
      "fix_state": "Not affected",
      "package_name": "python3x-django-lifecycle",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2",
      "fix_state": "Not affected",
      "package_name": "python-ansible-compat",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2",
      "fix_state": "Not affected",
      "package_name": "python-django-lifecycle",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2"
    },
    {
      "product_name": "Red Hat Ceph Storage 5",
      "fix_state": "Affected",
      "package_name": "cephadm-ansible",
      "cpe": "cpe:/a:redhat:ceph_storage:5"
    },
    {
      "product_name": "Red Hat Ceph Storage 6",
      "fix_state": "Affected",
      "package_name": "cephadm-ansible",
      "cpe": "cpe:/a:redhat:ceph_storage:6"
    },
    {
      "product_name": "Red Hat Ceph Storage 7",
      "fix_state": "Affected",
      "package_name": "cephadm-ansible",
      "cpe": "cpe:/a:redhat:ceph_storage:7"
    },
    {
      "product_name": "Red Hat Developer Hub",
      "fix_state": "Not affected",
      "package_name": "rhdh-hub-container",
      "cpe": "cpe:/a:redhat:rhdh:1"
    },
    {
      "product_name": "Red Hat Discovery",
      "fix_state": "Affected",
      "package_name": "discovery/discovery-server-rhel8",
      "cpe": "cpe:/a:redhat:discovery:1.0::el8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "python-jinja2",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "python-jinja2",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "fence-agents",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "python27:2.7/python-jinja2",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "rust-srpm-macros",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "rust-srpm-macros",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Not affected",
      "package_name": "openshift4-aws-iso",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Not affected",
      "package_name": "openshift4/ztp-site-generate-rhel8",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenStack Platform 17.1",
      "fix_state": "Affected",
      "package_name": "openstack-ansible-core",
      "cpe": "cpe:/a:redhat:openstack:17.1"
    },
    {
      "product_name": "Red Hat Quay 3",
      "fix_state": "Affected",
      "package_name": "quay/quay-rhel8",
      "cpe": "cpe:/a:redhat:quay:3"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Affected",
      "package_name": "satellite-capsule:el8/python-jinja2",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Affected",
      "package_name": "satellite:el8/python-jinja2",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Will not fix",
      "package_name": "tfm-pulpcore-python-jinja2",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Software Collections",
      "fix_state": "Will not fix",
      "package_name": "rh-python38-python-jinja2",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Storage 3",
      "fix_state": "Affected",
      "package_name": "gdeploy",
      "cpe": "cpe:/a:redhat:storage:3"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-01-11T00:00:00Z",
  "bugzilla": {
    "description": "jinja2: HTML attribute injection when passing user input as keys to xmlattr filter",
    "id": "2257854",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2257854"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.4",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-79",
  "statement": "The identified issue is classified as moderate due to a cross-site scripting (XSS) vulnerability in Jinja2. This flaw arises from the xmlattr filter, which permits keys with spaces, contrary to XML/HTML attribute standards. In scenarios where an application accepts user-input keys and renders them for other users, attackers can exploit this vulnerability to inject additional attributes, potentially resulting in XSS attacks. The misuse of the xmlattr filter facilitates the injection of arbitrary HTML attributes, allowing attackers to bypass auto-escaping mechanisms and potentially evade attribute validation checks, posing a moderate security risk.",
  "acknowledgement": "",
  "name": "CVE-2024-22195",
  "document_distribution": "",
  "details": [
    "Jinja is an extensible templating engine. Special placeholders in the template allow writing code similar to Python syntax. It is possible to inject arbitrary HTML attributes into the rendered HTML template, potentially leading to Cross-Site Scripting (XSS). The Jinja `xmlattr` filter can be abused to inject arbitrary HTML attribute keys and values, bypassing the auto escaping mechanism and potentially leading to XSS. It may also be possible to bypass attribute validation checks if they are blacklist-based.",
    "A  cross-site scripting (XSS) flaw was found in Jinja2 due to the xmlattr filter allowing keys with spaces, contrary to XML/HTML attribute standards. If an application accepts user-input keys and renders them for other users, attackers can inject additional attributes, potentially leading to XSS. This misuse of the xmlattr filter enables the injection of arbitrary HTML attributes, bypassing auto-escaping and potentially circumventing attribute validation checks."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-22195\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-22195\nhttps://github.com/pallets/jinja/releases/tag/3.1.3\nhttps://github.com/pallets/jinja/security/advisories/GHSA-h5c8-rqwp-cp95"
  ]
}