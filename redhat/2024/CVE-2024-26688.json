{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-04-03T00:00:00Z",
  "bugzilla": {
    "description": "kernel: fs,hugetlb: fix NULL pointer dereference in hugetlbs_fill_super",
    "id": "2273105",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2273105"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "4.7",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-476",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-26688",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nfs,hugetlb: fix NULL pointer dereference in hugetlbs_fill_super\nWhen configuring a hugetlb filesystem via the fsconfig() syscall, there is\na possible NULL dereference in hugetlbfs_fill_super() caused by assigning\nNULL to ctx-\u003ehstate in hugetlbfs_parse_param() when the requested pagesize\nis non valid.\nE.g: Taking the following steps:\nfd = fsopen(\"hugetlbfs\", FSOPEN_CLOEXEC);\nfsconfig(fd, FSCONFIG_SET_STRING, \"pagesize\", \"1024\", 0);\nfsconfig(fd, FSCONFIG_CMD_CREATE, NULL, NULL, 0);\nGiven that the requested \"pagesize\" is invalid, ctxt-\u003ehstate will be replaced\nwith NULL, losing its previous value, and we will print an error:\n...\n...\ncase Opt_pagesize:\nps = memparse(param-\u003estring, \u0026rest);\nctx-\u003ehstate = h;\nif (!ctx-\u003ehstate) {\npr_err(\"Unsupported page size %lu MB\\n\", ps / SZ_1M);\nreturn -EINVAL;\n}\nreturn 0;\n...\n...\nThis is a problem because later on, we will dereference ctxt-\u003ehstate in\nhugetlbfs_fill_super()\n...\n...\nsb-\u003es_blocksize = huge_page_size(ctx-\u003ehstate);\n...\n...\nCausing below Oops.\nFix this by replacing cxt-\u003ehstate value only when then pagesize is known\nto be valid.\nkernel: hugetlbfs: Unsupported page size 0 MB\nkernel: BUG: kernel NULL pointer dereference, address: 0000000000000028\nkernel: #PF: supervisor read access in kernel mode\nkernel: #PF: error_code(0x0000) - not-present page\nkernel: PGD 800000010f66c067 P4D 800000010f66c067 PUD 1b22f8067 PMD 0\nkernel: Oops: 0000 [#1] PREEMPT SMP PTI\nkernel: CPU: 4 PID: 5659 Comm: syscall Tainted: G            E      6.8.0-rc2-default+ #22 5a47c3fef76212addcc6eb71344aabc35190ae8f\nkernel: Hardware name: Intel Corp. GROVEPORT/GROVEPORT, BIOS GVPRCRB1.86B.0016.D04.1705030402 05/03/2017\nkernel: RIP: 0010:hugetlbfs_fill_super+0xb4/0x1a0\nkernel: Code: 48 8b 3b e8 3e c6 ed ff 48 85 c0 48 89 45 20 0f 84 d6 00 00 00 48 b8 ff ff ff ff ff ff ff 7f 4c 89 e7 49 89 44 24 20 48 8b 03 \u003c8b\u003e 48 28 b8 00 10 00 00 48 d3 e0 49 89 44 24 18 48 8b 03 8b 40 28\nkernel: RSP: 0018:ffffbe9960fcbd48 EFLAGS: 00010246\nkernel: RAX: 0000000000000000 RBX: ffff9af5272ae780 RCX: 0000000000372004\nkernel: RDX: ffffffffffffffff RSI: ffffffffffffffff RDI: ffff9af555e9b000\nkernel: RBP: ffff9af52ee66b00 R08: 0000000000000040 R09: 0000000000370004\nkernel: R10: ffffbe9960fcbd48 R11: 0000000000000040 R12: ffff9af555e9b000\nkernel: R13: ffffffffa66b86c0 R14: ffff9af507d2f400 R15: ffff9af507d2f400\nkernel: FS:  00007ffbc0ba4740(0000) GS:ffff9b0bd7000000(0000) knlGS:0000000000000000\nkernel: CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nkernel: CR2: 0000000000000028 CR3: 00000001b1ee0000 CR4: 00000000001506f0\nkernel: Call Trace:\nkernel:  \u003cTASK\u003e\nkernel:  ? __die_body+0x1a/0x60\nkernel:  ? page_fault_oops+0x16f/0x4a0\nkernel:  ? search_bpf_extables+0x65/0x70\nkernel:  ? fixup_exception+0x22/0x310\nkernel:  ? exc_page_fault+0x69/0x150\nkernel:  ? asm_exc_page_fault+0x22/0x30\nkernel:  ? __pfx_hugetlbfs_fill_super+0x10/0x10\nkernel:  ? hugetlbfs_fill_super+0xb4/0x1a0\nkernel:  ? hugetlbfs_fill_super+0x28/0x1a0\nkernel:  ? __pfx_hugetlbfs_fill_super+0x10/0x10\nkernel:  vfs_get_super+0x40/0xa0\nkernel:  ? __pfx_bpf_lsm_capable+0x10/0x10\nkernel:  vfs_get_tree+0x25/0xd0\nkernel:  vfs_cmd_create+0x64/0xe0\nkernel:  __x64_sys_fsconfig+0x395/0x410\nkernel:  do_syscall_64+0x80/0x160\nkernel:  ? syscall_exit_to_user_mode+0x82/0x240\nkernel:  ? do_syscall_64+0x8d/0x160\nkernel:  ? syscall_exit_to_user_mode+0x82/0x240\nkernel:  ? do_syscall_64+0x8d/0x160\nkernel:  ? exc_page_fault+0x69/0x150\nkernel:  entry_SYSCALL_64_after_hwframe+0x6e/0x76\nkernel: RIP: 0033:0x7ffbc0cb87c9\nkernel: Code: 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 66 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 \u003c48\u003e 3d 01 f0 ff ff 73 01 c3 48 8b 0d 97 96 0d 00 f7 d8 64 89 01 48\nkernel: RSP: 002b:00007ffc29d2f388 EFLAGS: 00000206 ORIG_RAX: 00000000000001af\nkernel: RAX: fffffffffff\n---truncated---"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-26688\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-26688\nhttps://lore.kernel.org/linux-cve-announce/2024040336-CVE-2024-26688-7b0e@gregkh/T"
  ]
}