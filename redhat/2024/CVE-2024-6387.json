{
  "mitigation": "This issue can be mitigated by setting the LoginGraceTime parameter to 0 in the sshd configuration file.\n1) As root user, open the /etc/ssh/sshd_config\n2) Add or edit the parameter configuration:\n~~~\nLoginGraceTime 0\n~~~\n3) Save and close the file\n4) Restart the sshd daemon:\n~~~\nsystemctl restart sshd.service\n~~~\nNotice the sshd server will still be vulnerable to Denial of Service attacks due to the possibility os MaxStartups connection exhaustion, however it'll be safe against possible remote code execution attacks.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "openssh",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "openssh",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "openssh",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "openssh",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2024-07-01T08:00:00Z",
  "bugzilla": {
    "description": "openssh: Possible remote code execution due to a race condition in signal handling",
    "id": "2294604",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2294604"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-364",
  "statement": "This flaw doesnâ€™t affected OpenSSH versions as shipped with Red Hat Enterprise Linux 8 as the vulnerable code was introduced in later OpenSSH version in upstream and was never backported to Red Hat Enterprise Linux 8. Only Red Hat Enterprise Linux 9 is affected.\nRed Hat has rated this flaw with the severity of Important. Although the possibility of remote code execution, the complexity to achieve that is very high and time consuming due to the need of wining a race condition. If the attacker doesn't achieve such win, the most likely outcome is to have the sshd server to crash, generating only the availability impact. In order to achieve the condition mentioned before a huge amount of connections to the targeted server may be needed, which may eventually be easily notice via network monitoring tools.",
  "acknowledgement": "",
  "name": "CVE-2024-6387",
  "document_distribution": "",
  "details": [
    "A signal handler race condition was found in OpenSSH's server (sshd), where a client does not authenticate within LoginGraceTime seconds (120 by default, 600 in old OpenSSH versions), then sshd's SIGALRM handler is called asynchronously. However, this signal handler calls various functions that are not async-signal-safe, for example, syslog().",
    "A signal handler race condition was found in OpenSSH's server (sshd), where a client does not authenticate within LoginGraceTime seconds (120 by default, 600 in old OpenSSH versions), then sshd's SIGALRM handler is called asynchronously. However, this signal handler calls various functions that are not async-signal-safe, for example, syslog()."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-6387\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-6387\nhttps://www.qualys.com/2024/07/01/cve-2024-6387/regresshion.txt"
  ]
}