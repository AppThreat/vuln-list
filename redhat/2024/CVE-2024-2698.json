{
  "mitigation": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-06-10T00:00:00Z",
      "advisory": "RHSA-2024:3755",
      "package": "idm:DL1-8100020240528133707.823393f5",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
      "release_date": "2024-06-10T00:00:00Z",
      "advisory": "RHSA-2024:3759",
      "package": "idm:DL1-8080020240530051744.b0a6ceea",
      "cpe": "cpe:/a:redhat:rhel_eus:8.8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-06-10T00:00:00Z",
      "advisory": "RHSA-2024:3754",
      "package": "ipa-0:4.11.0-15.el9_4",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
      "release_date": "2024-06-10T00:00:00Z",
      "advisory": "RHSA-2024:3757",
      "package": "ipa-0:4.10.1-12.el9_2.2",
      "cpe": "cpe:/a:redhat:rhel_eus:9.2"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "ipa",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Affected",
      "package_name": "ipa",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "idm:client/ipa",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "ipa",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2024-06-10T00:00:00Z",
  "bugzilla": {
    "description": "freeipa: delegation rules allow a proxy service to impersonate any user to access another target service",
    "id": "2270353",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2270353"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-284",
  "statement": "This vulnerability does not affect default FreeIPA deployments because the services that have delegation rules defined are on IPA servers themselves. Services having resource-based constrained delegation (RBCD) rules  are not affected by this vulnerability.",
  "acknowledgement": "",
  "name": "CVE-2024-2698",
  "document_distribution": "",
  "details": [
    "A vulnerability was found in FreeIPA in how the initial implementation of MS-SFU by MIT Kerberos was missing a condition for granting the \"forwardable\" flag on S4U2Self tickets. Fixing this mistake required adding a special case for the check_allowed_to_delegate() function: If the target service argument is NULL, then it means the KDC is probing for general constrained delegation rules and not checking a specific S4U2Proxy request.\nIn FreeIPA 4.11.0, the behavior of ipadb_match_acl() was modified to match the changes from upstream MIT Kerberos 1.20. However, a mistake resulting in this mechanism applies in cases where the target service argument is set AND where it is unset. This results in S4U2Proxy requests being accepted regardless of whether or not there is a matching service delegation rule.",
    "A vulnerability was found in FreeIPA in how the initial implementation of MS-SFU by MIT Kerberos was missing a condition for granting the \"forwardable\" flag on S4U2Self tickets. Fixing this mistake required adding a special case for the check_allowed_to_delegate() function: If the target service argument is NULL, then it means the KDC is probing for general constrained delegation rules and not checking a specific S4U2Proxy request.\nIn FreeIPA 4.11.0, the behavior of ipadb_match_acl() was modified to match the changes from upstream MIT Kerberos 1.20. However, a mistake resulting in this mechanism applies in cases where the target service argument is set AND where it is unset. This results in S4U2Proxy requests being accepted regardless of whether or not there is a matching service delegation rule."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-2698\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-2698\nhttps://www.freeipa.org/release-notes/4-12-1.html"
  ]
}