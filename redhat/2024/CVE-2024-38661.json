{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-06-25T00:00:00Z",
  "bugzilla": {
    "description": "kernel: s390/ap: Fix crash in AP internal function modify_bitmap()",
    "id": "2294277",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2294277"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-38661",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\ns390/ap: Fix crash in AP internal function modify_bitmap()\nA system crash like this\nFailing address: 200000cb7df6f000 TEID: 200000cb7df6f403\nFault in home space mode while using kernel ASCE.\nAS:00000002d71bc007 R3:00000003fe5b8007 S:000000011a446000 P:000000015660c13d\nOops: 0038 ilc:3 [#1] PREEMPT SMP\nModules linked in: mlx5_ib ...\nCPU: 8 PID: 7556 Comm: bash Not tainted 6.9.0-rc7 #8\nHardware name: IBM 3931 A01 704 (LPAR)\nKrnl PSW : 0704e00180000000 0000014b75e7b606 (ap_parse_bitmap_str+0x10e/0x1f8)\nR:0 T:1 IO:1 EX:1 Key:0 M:1 W:0 P:0 AS:3 CC:2 PM:0 RI:0 EA:3\nKrnl GPRS: 0000000000000001 ffffffffffffffc0 0000000000000001 00000048f96b75d3\n000000cb00000100 ffffffffffffffff ffffffffffffffff 000000cb7df6fce0\n000000cb7df6fce0 00000000ffffffff 000000000000002b 00000048ffffffff\n000003ff9b2dbc80 200000cb7df6fcd8 0000014bffffffc0 000000cb7df6fbc8\nKrnl Code: 0000014b75e7b5fc: a7840047            brc     8,0000014b75e7b68a\n0000014b75e7b600: 18b2                lr      %r11,%r2\n#0000014b75e7b602: a7f4000a            brc     15,0000014b75e7b616\n\u003e0000014b75e7b606: eb22d00000e6        laog    %r2,%r2,0(%r13)\n0000014b75e7b60c: a7680001            lhi     %r6,1\n0000014b75e7b610: 187b                lr      %r7,%r11\n0000014b75e7b612: 84960021            brxh    %r9,%r6,0000014b75e7b654\n0000014b75e7b616: 18e9                lr      %r14,%r9\nCall Trace:\n[\u003c0000014b75e7b606\u003e] ap_parse_bitmap_str+0x10e/0x1f8\n([\u003c0000014b75e7b5dc\u003e] ap_parse_bitmap_str+0xe4/0x1f8)\n[\u003c0000014b75e7b758\u003e] apmask_store+0x68/0x140\n[\u003c0000014b75679196\u003e] kernfs_fop_write_iter+0x14e/0x1e8\n[\u003c0000014b75598524\u003e] vfs_write+0x1b4/0x448\n[\u003c0000014b7559894c\u003e] ksys_write+0x74/0x100\n[\u003c0000014b7618a440\u003e] __do_syscall+0x268/0x328\n[\u003c0000014b761a3558\u003e] system_call+0x70/0x98\nINFO: lockdep is turned off.\nLast Breaking-Event-Address:\n[\u003c0000014b75e7b636\u003e] ap_parse_bitmap_str+0x13e/0x1f8\nKernel panic - not syncing: Fatal exception: panic_on_oops\noccured when /sys/bus/ap/a[pq]mask was updated with a relative mask value\n(like +0x10-0x12,+60,-90) with one of the numeric values exceeding INT_MAX.\nThe fix is simple: use unsigned long values for the internal variables. The\ncorrect checks are already in place in the function but a simple int for\nthe internal variables was used with the possibility to overflow."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-38661\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-38661"
  ]
}