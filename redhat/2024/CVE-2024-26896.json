{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-04-17T00:00:00Z",
  "bugzilla": {
    "description": "kernel: wifi: wfx: fix memory leak when starting AP",
    "id": "2275657",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2275657"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-26896",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nwifi: wfx: fix memory leak when starting AP\nKmemleak reported this error:\nunreferenced object 0xd73d1180 (size 184):\ncomm \"wpa_supplicant\", pid 1559, jiffies 13006305 (age 964.245s)\nhex dump (first 32 bytes):\n00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n00 00 00 00 00 00 00 00 1e 00 01 00 00 00 00 00  ................\nbacktrace:\n[\u003c5ca11420\u003e] kmem_cache_alloc+0x20c/0x5ac\n[\u003c127bdd74\u003e] __alloc_skb+0x144/0x170\n[\u003cfb8a5e38\u003e] __netdev_alloc_skb+0x50/0x180\n[\u003c0f9fa1d5\u003e] __ieee80211_beacon_get+0x290/0x4d4 [mac80211]\n[\u003c7accd02d\u003e] ieee80211_beacon_get_tim+0x54/0x18c [mac80211]\n[\u003c41e25cc3\u003e] wfx_start_ap+0xc8/0x234 [wfx]\n[\u003c93a70356\u003e] ieee80211_start_ap+0x404/0x6b4 [mac80211]\n[\u003ca4a661cd\u003e] nl80211_start_ap+0x76c/0x9e0 [cfg80211]\n[\u003c47bd8b68\u003e] genl_rcv_msg+0x198/0x378\n[\u003c453ef796\u003e] netlink_rcv_skb+0xd0/0x130\n[\u003c6b7c977a\u003e] genl_rcv+0x34/0x44\n[\u003c66b2d04d\u003e] netlink_unicast+0x1b4/0x258\n[\u003cf965b9b6\u003e] netlink_sendmsg+0x1e8/0x428\n[\u003caadb8231\u003e] ____sys_sendmsg+0x1e0/0x274\n[\u003cd2b5212d\u003e] ___sys_sendmsg+0x80/0xb4\n[\u003c69954f45\u003e] __sys_sendmsg+0x64/0xa8\nunreferenced object 0xce087000 (size 1024):\ncomm \"wpa_supplicant\", pid 1559, jiffies 13006305 (age 964.246s)\nhex dump (first 32 bytes):\n00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n10 00 07 40 00 00 00 00 00 00 00 00 00 00 00 00  ...@............\nbacktrace:\n[\u003c9a993714\u003e] __kmalloc_track_caller+0x230/0x600\n[\u003cf83ea192\u003e] kmalloc_reserve.constprop.0+0x30/0x74\n[\u003ca2c61343\u003e] __alloc_skb+0xa0/0x170\n[\u003cfb8a5e38\u003e] __netdev_alloc_skb+0x50/0x180\n[\u003c0f9fa1d5\u003e] __ieee80211_beacon_get+0x290/0x4d4 [mac80211]\n[\u003c7accd02d\u003e] ieee80211_beacon_get_tim+0x54/0x18c [mac80211]\n[\u003c41e25cc3\u003e] wfx_start_ap+0xc8/0x234 [wfx]\n[\u003c93a70356\u003e] ieee80211_start_ap+0x404/0x6b4 [mac80211]\n[\u003ca4a661cd\u003e] nl80211_start_ap+0x76c/0x9e0 [cfg80211]\n[\u003c47bd8b68\u003e] genl_rcv_msg+0x198/0x378\n[\u003c453ef796\u003e] netlink_rcv_skb+0xd0/0x130\n[\u003c6b7c977a\u003e] genl_rcv+0x34/0x44\n[\u003c66b2d04d\u003e] netlink_unicast+0x1b4/0x258\n[\u003cf965b9b6\u003e] netlink_sendmsg+0x1e8/0x428\n[\u003caadb8231\u003e] ____sys_sendmsg+0x1e0/0x274\n[\u003cd2b5212d\u003e] ___sys_sendmsg+0x80/0xb4\nHowever, since the kernel is build optimized, it seems the stack is not\naccurate. It appears the issue is related to wfx_set_mfp_ap(). The issue\nis obvious in this function: memory allocated by ieee80211_beacon_get()\nis never released. Fixing this leak makes kmemleak happy."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-26896\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-26896\nhttps://lore.kernel.org/linux-cve-announce/2024041744-CVE-2024-26896-79fe@gregkh/T"
  ]
}