{
  "mitigation": "1. This flaw can be mitigated by preventing the affected netfilter (nf_tables) kernel module from being loaded. For instructions on how to blacklist a kernel module, please see https://access.redhat.com/solutions/41278.\n2. If the module cannot be disabled, on non-containerized deployments of Red Hat Enterprise Linux, the mitigation is to disable user namespaces:\n```\n# echo \"user.max_user_namespaces=0\" \u003e /etc/sysctl.d/userns.conf\n# sysctl -p /etc/sysctl.d/userns.conf\n```\nOn containerized deployments, such as Red Hat OpenShift Container Platform, do not use the second mitigation (disabling user namespaces) as the functionality is needed to be enabled. The first mitigation (blacklisting nf_tables) is still viable for containerized deployments, providing the environment is not using netfilter.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2024-03-14T00:00:00Z",
      "advisory": "RHSA-2024:1332",
      "package": "kernel-rt-0:3.10.0-1160.114.2.rt56.1266.el7",
      "cpe": "cpe:/a:redhat:rhel_extras_rt:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2024-03-12T00:00:00Z",
      "advisory": "RHSA-2024:1249",
      "package": "kernel-0:3.10.0-1160.114.2.el7",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.6 Advanced Update Support",
      "release_date": "2024-05-23T00:00:00Z",
      "advisory": "RHSA-2024:3318",
      "package": "kernel-0:3.10.0-957.113.1.el7",
      "cpe": "cpe:/o:redhat:rhel_aus:7.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.7 Advanced Update Support",
      "release_date": "2024-05-23T00:00:00Z",
      "advisory": "RHSA-2024:3319",
      "package": "kernel-0:3.10.0-1062.88.1.el7",
      "cpe": "cpe:/o:redhat:rhel_aus:7.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-04-02T00:00:00Z",
      "advisory": "RHSA-2024:1614",
      "package": "kernel-rt-0:4.18.0-513.24.1.rt7.326.el8_9",
      "cpe": "cpe:/a:redhat:enterprise_linux:8::nfv"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-04-02T00:00:00Z",
      "advisory": "RHSA-2024:1607",
      "package": "kernel-0:4.18.0-513.24.1.el8_9",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Advanced Update Support",
      "release_date": "2024-05-31T00:00:00Z",
      "advisory": "RHSA-2024:3528",
      "package": "kernel-0:4.18.0-193.135.1.el8_2",
      "cpe": "cpe:/o:redhat:rhel_aus:8.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Advanced Mission Critical Update Support",
      "release_date": "2024-05-31T00:00:00Z",
      "advisory": "RHSA-2024:3529",
      "package": "kernel-0:4.18.0-305.131.1.el8_4",
      "cpe": "cpe:/o:redhat:rhel_aus:8.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Telecommunications Update Service",
      "release_date": "2024-05-31T00:00:00Z",
      "advisory": "RHSA-2024:3530",
      "package": "kernel-rt-0:4.18.0-305.131.1.rt7.207.el8_4",
      "cpe": "cpe:/a:redhat:rhel_tus:8.4::nfv"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Telecommunications Update Service",
      "release_date": "2024-05-31T00:00:00Z",
      "advisory": "RHSA-2024:3529",
      "package": "kernel-0:4.18.0-305.131.1.el8_4",
      "cpe": "cpe:/o:redhat:rhel_tus:8.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Update Services for SAP Solutions",
      "release_date": "2024-05-31T00:00:00Z",
      "advisory": "RHSA-2024:3529",
      "package": "kernel-0:4.18.0-305.131.1.el8_4",
      "cpe": "cpe:/o:redhat:rhel_e4s:8.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.6 Extended Update Support",
      "release_date": "2024-02-21T00:00:00Z",
      "advisory": "RHSA-2024:0930",
      "package": "kernel-0:4.18.0-372.93.1.el8_6",
      "cpe": "cpe:/o:redhat:rhel_eus:8.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
      "release_date": "2024-03-19T00:00:00Z",
      "advisory": "RHSA-2024:1404",
      "package": "kernel-0:4.18.0-477.51.1.el8_8",
      "cpe": "cpe:/o:redhat:rhel_eus:8.8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
      "release_date": "2024-05-06T00:00:00Z",
      "advisory": "RHSA-2024:2697",
      "package": "kpatch-patch",
      "cpe": "cpe:/o:redhat:rhel_eus:8.8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-04-30T00:00:00Z",
      "advisory": "RHSA-2024:2394",
      "package": "kernel-0:5.14.0-427.13.1.el9_4",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-04-30T00:00:00Z",
      "advisory": "RHSA-2024:2394",
      "package": "kernel-0:5.14.0-427.13.1.el9_4",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.0 Extended Update Support",
      "release_date": "2024-05-28T00:00:00Z",
      "advisory": "RHSA-2024:3421",
      "package": "kernel-0:5.14.0-70.101.1.el9_0",
      "cpe": "cpe:/a:redhat:rhel_eus:9.0"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.0 Extended Update Support",
      "release_date": "2024-05-28T00:00:00Z",
      "advisory": "RHSA-2024:3414",
      "package": "kernel-rt-0:5.14.0-70.101.1.rt21.173.el9_0",
      "cpe": "cpe:/a:redhat:rhel_eus:9.0::nfv"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.0 Extended Update Support",
      "release_date": "2024-05-28T00:00:00Z",
      "advisory": "RHSA-2024:3427",
      "package": "kpatch-patch",
      "cpe": "cpe:/o:redhat:rhel_eus:9.0"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
      "release_date": "2024-02-28T00:00:00Z",
      "advisory": "RHSA-2024:1018",
      "package": "kernel-0:5.14.0-284.55.1.el9_2",
      "cpe": "cpe:/a:redhat:rhel_eus:9.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
      "release_date": "2024-02-28T00:00:00Z",
      "advisory": "RHSA-2024:1019",
      "package": "kernel-rt-0:5.14.0-284.55.1.rt14.340.el9_2",
      "cpe": "cpe:/a:redhat:rhel_eus:9.2::nfv"
    },
    {
      "product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 8",
      "release_date": "2024-02-21T00:00:00Z",
      "advisory": "RHSA-2024:0930",
      "package": "kernel-0:4.18.0-372.93.1.el8_6",
      "cpe": "cpe:/o:redhat:rhev_hypervisor:4.4::el8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2024-01-31T00:00:00Z",
  "bugzilla": {
    "description": "kernel: nf_tables: use-after-free vulnerability in the nft_verdict_init() function",
    "id": "2262126",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2262126"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-416",
  "statement": "This flaw is rated as having an Important impact. There is the limitation that it can only be exploited by a local user with access to Netfilter, but can still allow privilege escalation if user namespaces are enabled and Netfilter is being used.",
  "acknowledgement": "",
  "name": "CVE-2024-1086",
  "document_distribution": "",
  "details": [
    "A use-after-free vulnerability in the Linux kernel's netfilter: nf_tables component can be exploited to achieve local privilege escalation.\nThe nft_verdict_init() function allows positive values as drop error within the hook verdict, and hence the nf_hook_slow() function can cause a double free vulnerability when NF_DROP is issued with a drop error which resembles NF_ACCEPT.\nWe recommend upgrading past commit f342de4e2f33e0e39165d8639387aa6c19dff660.",
    "A flaw was found in the Netfilter subsystem in the Linux kernel. This issue occurs in the nft_verdict_init() function, allowing positive values as a drop error within the hook verdict, therefore, the nf_hook_slow() function can cause a double-free vulnerability when NF_DROP is issued with a drop error that resembles NF_ACCEPT. The nf_tables component can be exploited to achieve local privilege escalation."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-1086\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-1086\nhttps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=f342de4e2f33e0e39165d8639387aa6c19dff660\nhttps://kernel.dance/f342de4e2f33e0e39165d8639387aa6c19dff660"
  ]
}