{
  "mitigation": "A possible mitigation for this issue is to disable http2 support until the package can be updated.\nThis can be performed by running the following command:\n~~~\nvarnishadm param.set feature -http2\n~~~\nNote: you must remove `h2` from the list of protocols if your TLS terminator is advertising it with ALPN.\nIt's also possible to use the `MAIN.sc_bankrupt` counter to monitor possible on-going attacks to the varnish server.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-04-08T00:00:00Z",
      "advisory": "RHSA-2024:1690",
      "package": "varnish:6-8090020240328195416.a75119d5",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Advanced Mission Critical Update Support",
      "release_date": "2024-05-21T00:00:00Z",
      "advisory": "RHSA-2024:2938",
      "package": "varnish:6-8040020240513125037.522a0ee4",
      "cpe": "cpe:/a:redhat:rhel_aus:8.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Telecommunications Update Service",
      "release_date": "2024-05-21T00:00:00Z",
      "advisory": "RHSA-2024:2938",
      "package": "varnish:6-8040020240513125037.522a0ee4",
      "cpe": "cpe:/a:redhat:rhel_tus:8.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Update Services for SAP Solutions",
      "release_date": "2024-05-21T00:00:00Z",
      "advisory": "RHSA-2024:2938",
      "package": "varnish:6-8040020240513125037.522a0ee4",
      "cpe": "cpe:/a:redhat:rhel_e4s:8.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
      "release_date": "2024-05-23T00:00:00Z",
      "advisory": "RHSA-2024:3305",
      "package": "varnish:6-8080020240510134818.63b34585",
      "cpe": "cpe:/a:redhat:rhel_eus:8.8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-04-08T00:00:00Z",
      "advisory": "RHSA-2024:1691",
      "package": "varnish-0:6.6.2-4.el9_3.1",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.0 Extended Update Support",
      "release_date": "2024-05-06T00:00:00Z",
      "advisory": "RHSA-2024:2700",
      "package": "varnish-0:6.6.2-2.el9_0.3",
      "cpe": "cpe:/a:redhat:rhel_eus:9.0"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
      "release_date": "2024-05-13T00:00:00Z",
      "advisory": "RHSA-2024:2820",
      "package": "varnish-0:6.6.2-3.el9_2.2",
      "cpe": "cpe:/a:redhat:rhel_eus:9.2"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2024-04-08T00:00:00Z",
      "advisory": "RHSA-2024:1689",
      "package": "rh-varnish6-varnish-0:6.0.13-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2024-04-08T00:00:00Z",
      "advisory": "RHSA-2024:1689",
      "package": "rh-varnish6-varnish-modules-0:0.15.0-8.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "varnish-modules",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Software Collections",
      "fix_state": "Not affected",
      "package_name": "rh-varnish6-jemalloc",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2024-03-24T00:00:00Z",
  "bugzilla": {
    "description": "varnish: HTTP/2 Broken Window Attack may result in denial of service",
    "id": "2271486",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2271486"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-400",
  "statement": "CVE-2024-30156 represents a important severity issue due to its potential to cause widespread denial of service (DoS) across Varnish Cacher servers with HTTP/2 protocol enabled. By exploiting this vulnerability, attackers can exhaust the server's HTTP/2 connection control flow window credits, thereby halting the processing of streams and indefinitely retaining associated resources. This can lead to a complete service outage, impacting the availability and performance of web services relying on Varnish Cache. Given the prevalence of HTTP/2 adoption for its performance benefits, the vulnerability poses a significant risk to web infrastructure, necessitating immediate mitigation measures to prevent exploitation and mitigate the impact on affected systems.",
  "acknowledgement": "",
  "name": "CVE-2024-30156",
  "document_distribution": "",
  "details": [
    "Varnish Cache before 7.3.2 and 7.4.x before 7.4.3 (and before 6.0.13 LTS), and Varnish Enterprise 6 before 6.0.12r6, allows credits exhaustion for an HTTP/2 connection control flow window, aka a Broke Window Attack.",
    "A flaw was found in the Varnish cache server, with HTTP/2 support enabled, that may allow a Denial of Service type of attack. A malicious actor can cause the server to run out of credits during the HTTP/2 connection control flow. As a consequence, the server will stop to properly process the active HTTP streams, retaining the already allocated resources, leading to resource starvation."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-30156\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-30156\nhttps://varnish-cache.org/security/VSV00014.html"
  ]
}