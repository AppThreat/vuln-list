{
  "mitigation": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat build of Apache Camel 4.0 for Spring Boot",
      "fix_state": "Affected",
      "package_name": "apache-pulsar",
      "cpe": "cpe:/a:redhat:camel_spring_boot:4"
    },
    {
      "product_name": "Red Hat build of Apache Camel for Spring Boot",
      "fix_state": "Affected",
      "package_name": "apache-pulsar",
      "cpe": "cpe:/a:redhat:camel_spring_boot:3"
    },
    {
      "product_name": "Red Hat Integration Camel K",
      "fix_state": "Not affected",
      "package_name": "apache-pulsar",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 8",
      "fix_state": "Not affected",
      "package_name": "apache-pulsar",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:8"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Affected",
      "package_name": "apache-pulsar",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2024-03-12T00:00:00Z",
  "bugzilla": {
    "description": "apache-pulsar: Pulsar Functions Worker's Archive Extraction Vulnerability Allows Unauthorized File Modification",
    "id": "2269257",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2269257"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.4",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-22",
  "statement": "Apache Pulsar is not part of EAP - it's not present in the EAP dependency tree and not distributed in the product maven repository. EAP is not affected.",
  "acknowledgement": "",
  "name": "CVE-2024-27317",
  "document_distribution": "",
  "details": [
    "In Pulsar Functions Worker, authenticated users can upload functions in jar or nar files. These files, essentially zip files, are extracted by the Functions Worker. However, if a malicious file is uploaded, it could exploit a directory traversal vulnerability. This occurs when the filenames in the zip files, which aren't properly validated, contain special elements like \"..\", altering the directory path. This could allow an attacker to create or modify files outside of the designated extraction directory, potentially influencing system behavior. This vulnerability also applies to the Pulsar Broker when it is configured with \"functionsWorkerEnabled=true\".\nThis issue affects Apache Pulsar versions from 2.4.0 to 2.10.5, from 2.11.0 to 2.11.3, from 3.0.0 to 3.0.2, from 3.1.0 to 3.1.2, and 3.2.0. \n2.10 Pulsar Function Worker users should upgrade to at least 2.10.6.\n2.11 Pulsar Function Worker users should upgrade to at least 2.11.4.\n3.0 Pulsar Function Worker users should upgrade to at least 3.0.3.\n3.1 Pulsar Function Worker users should upgrade to at least 3.1.3.\n3.2 Pulsar Function Worker users should upgrade to at least 3.2.1.\nUsers operating versions prior to those listed above should upgrade to the aforementioned patched versions or newer versions.",
    "A path traversal vulnerability was found in Apache Pulsar. Pulsar allows authenticated users to upload functions to be run by the Pulsar Function Workers, these codes are in the format of a ZIP file. When extracting the uploaded ZIP file Pulsar fails to properly validate the file names contained in the uploaded ZIP file. This flaw allows an attacker to create or modify files outside of the intended directory, possibly influencing the system's behavior. Pulsar Broker is also vulnerable to this flaw when configured with \"functionsWorkerEnabled=true\"."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-27317\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-27317\nhttps://pulsar.apache.org/security/CVE-2024-27317/"
  ]
}