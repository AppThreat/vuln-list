{
  "mitigation": "This issue can be mitigated by removing the ISO-2022-CN-EXT from glibc-gconv-extra's modules configuration. This can be done by:\n1) Verify if the module is loaded by running:\n~~~\n$ iconv -l | grep -E 'CN-?EXT'\nISO-2022-CN-EXT//\nISO2022CNEXT//\n~~~\nIf the grep output looks like the above, ISO-2022-CN-EXT module is enabled.\n2) Disabled the module by editing the file located at /usr/lib64/gconv/gconv-modules.d/gconv-modules-extra.conf and comment the following lines. For RHEL 7 the file that needs to be edited is /usr/lib64/gconv/gconv-modules. This step requires to be executed by a privileged user:\n~~~\n#       from                    to                      module          cost\nalias   ISO2022CNEXT//          ISO-2022-CN-EXT//\nmodule  ISO-2022-CN-EXT//       INTERNAL                ISO-2022-CN-EXT 1\nmodule  INTERNAL                ISO-2022-CN-EXT//       ISO-2022-CN-EXT 1\n~~~\nFor commenting those lines just add the '#' character at the beginning of mentioned lines:\n~~~\n#       from                    to                      module          cost\n#alias  ISO2022CNEXT//          ISO-2022-CN-EXT//\n#module ISO-2022-CN-EXT//       INTERNAL                ISO-2022-CN-EXT 1\n#module INTERNAL                ISO-2022-CN-EXT//       ISO-2022-CN-EXT 1\n~~~\n3) Update the iconv cache by running:\n~~~\nsudo iconvconfig\n~~~\n4) Check if the module was disabled by running the first step again. This time  ISO-2022-CN-EXT should not appear in the output.\nPlease notice that disabling the mentioned gconv module may lead applications relying in the affected module to fail in converting characters and should be used as a temporary mitigation before being able to fully update the affected package.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-05-07T00:00:00Z",
      "advisory": "RHSA-2024:2722",
      "package": "glibc-0:2.28-236.el8_9.13",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-05-22T00:00:00Z",
      "advisory": "RHSA-2024:3269",
      "package": "glibc-0:2.28-251.el8_10.1",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-05-07T00:00:00Z",
      "advisory": "RHSA-2024:2722",
      "package": "glibc-0:2.28-236.el8_9.13",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-05-22T00:00:00Z",
      "advisory": "RHSA-2024:3269",
      "package": "glibc-0:2.28-251.el8_10.1",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Advanced Mission Critical Update Support",
      "release_date": "2024-05-23T00:00:00Z",
      "advisory": "RHSA-2024:3309",
      "package": "glibc-0:2.28-151.el8_4.2",
      "cpe": "cpe:/a:redhat:rhel_aus:8.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Telecommunications Update Service",
      "release_date": "2024-05-23T00:00:00Z",
      "advisory": "RHSA-2024:3309",
      "package": "glibc-0:2.28-151.el8_4.2",
      "cpe": "cpe:/a:redhat:rhel_tus:8.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Update Services for SAP Solutions",
      "release_date": "2024-05-23T00:00:00Z",
      "advisory": "RHSA-2024:3309",
      "package": "glibc-0:2.28-151.el8_4.2",
      "cpe": "cpe:/a:redhat:rhel_e4s:8.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.6 Extended Update Support",
      "release_date": "2024-05-09T00:00:00Z",
      "advisory": "RHSA-2024:2799",
      "package": "glibc-0:2.28-189.10.el8_6",
      "cpe": "cpe:/a:redhat:rhel_eus:8.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
      "release_date": "2024-05-23T00:00:00Z",
      "advisory": "RHSA-2024:3312",
      "package": "glibc-0:2.28-225.el8_8.11",
      "cpe": "cpe:/a:redhat:rhel_eus:8.8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-05-23T00:00:00Z",
      "advisory": "RHSA-2024:3339",
      "package": "glibc-0:2.34-100.el9_4.2",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-05-23T00:00:00Z",
      "advisory": "RHSA-2024:3339",
      "package": "glibc-0:2.34-100.el9_4.2",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.0 Extended Update Support",
      "release_date": "2024-05-28T00:00:00Z",
      "advisory": "RHSA-2024:3423",
      "package": "glibc-0:2.34-28.el9_0.6",
      "cpe": "cpe:/a:redhat:rhel_eus:9.0"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
      "release_date": "2024-05-28T00:00:00Z",
      "advisory": "RHSA-2024:3411",
      "package": "glibc-0:2.34-60.el9_2.14",
      "cpe": "cpe:/a:redhat:rhel_eus:9.2"
    },
    {
      "product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 8",
      "release_date": "2024-05-09T00:00:00Z",
      "advisory": "RHSA-2024:2799",
      "package": "glibc-0:2.28-189.10.el8_6",
      "cpe": "cpe:/o:redhat:rhev_hypervisor:4.4::el8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "compat-glibc",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "glibc",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "compat-glibc",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Affected",
      "package_name": "glibc",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2024-04-17T00:00:00Z",
  "bugzilla": {
    "description": "glibc: Out of bounds write in iconv may lead to remote code execution",
    "id": "2273404",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2273404"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-787",
  "statement": "The described vulnerability in the iconv() function of GNU C Library, particularly affecting ISO-2022-CN-EXT character set conversions, poses a important severity issue due to its potential for out-of-bound writes. Such buffer overflows can lead to arbitrary memory corruption, which can be exploited by attackers to execute arbitrary code, crash applications, or overwrite critical data structures, including neighboring variables. Given that the overflow can occur with specific, predictable values through SS2designation and SS3designation escape sequences, an attacker could craft malicious input to specifically trigger these overflows. Exploitation of this vulnerability could result in denial of service, privilege escalation, or even remote code execution, posing a significant threat to the security and integrity of affected systems.",
  "acknowledgement": "Red Hat would like to thank Charles Fol for reporting this issue.",
  "name": "CVE-2024-2961",
  "document_distribution": "",
  "details": [
    "The iconv() function in the GNU C Library versions 2.39 and older may overflow the output buffer passed to it by up to 4 bytes when converting strings to the ISO-2022-CN-EXT character set, which may be used to crash an application or overwrite a neighbouring variable.",
    "An out-of-bounds write flaw was found in the ISO-2022-CN-EXT plugin for glibc's iconv library. When converting from UCS4 charset, adding certain escape charterers is required to indicate where the charset was changed to the library. During this process, iconv improperly checks the boundaries of internal buffers, leading to a buffer overflow, which allows writing up to 3 bytes outside the desired memory location. This issue may allow an attacker to craft a malicious characters sequence that will trigger the out-of-bounds write and perform remote code execution, presenting a high impact to the Integrity, Confidentiality, and Availability triad."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-2961\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-2961\nhttps://www.openwall.com/lists/oss-security/2024/04/17/9"
  ]
}