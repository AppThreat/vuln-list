{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-03-06T00:00:00Z",
  "bugzilla": {
    "description": "kernel: llc: call sock_orphan() at release time",
    "id": "2268218",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2268218"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-416",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-26625",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nllc: call sock_orphan() at release time\nsyzbot reported an interesting trace [1] caused by a stale sk-\u003esk_wq\npointer in a closed llc socket.\nIn commit ff7b11aa481f (\"net: socket: set sock-\u003esk to NULL after\ncalling proto_ops::release()\") Eric Biggers hinted that some protocols\nare missing a sock_orphan(), we need to perform a full audit.\nIn net-next, I plan to clear sock-\u003esk from sock_orphan() and\namend Eric patch to add a warning.\n[1]\nBUG: KASAN: slab-use-after-free in list_empty include/linux/list.h:373 [inline]\nBUG: KASAN: slab-use-after-free in waitqueue_active include/linux/wait.h:127 [inline]\nBUG: KASAN: slab-use-after-free in sock_def_write_space_wfree net/core/sock.c:3384 [inline]\nBUG: KASAN: slab-use-after-free in sock_wfree+0x9a8/0x9d0 net/core/sock.c:2468\nRead of size 8 at addr ffff88802f4fc880 by task ksoftirqd/1/27\nCPU: 1 PID: 27 Comm: ksoftirqd/1 Not tainted 6.8.0-rc1-syzkaller-00049-g6098d87eaf31 #0\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.2-debian-1.16.2-1 04/01/2014\nCall Trace:\n\u003cTASK\u003e\n__dump_stack lib/dump_stack.c:88 [inline]\ndump_stack_lvl+0xd9/0x1b0 lib/dump_stack.c:106\nprint_address_description mm/kasan/report.c:377 [inline]\nprint_report+0xc4/0x620 mm/kasan/report.c:488\nkasan_report+0xda/0x110 mm/kasan/report.c:601\nlist_empty include/linux/list.h:373 [inline]\nwaitqueue_active include/linux/wait.h:127 [inline]\nsock_def_write_space_wfree net/core/sock.c:3384 [inline]\nsock_wfree+0x9a8/0x9d0 net/core/sock.c:2468\nskb_release_head_state+0xa3/0x2b0 net/core/skbuff.c:1080\nskb_release_all net/core/skbuff.c:1092 [inline]\nnapi_consume_skb+0x119/0x2b0 net/core/skbuff.c:1404\ne1000_unmap_and_free_tx_resource+0x144/0x200 drivers/net/ethernet/intel/e1000/e1000_main.c:1970\ne1000_clean_tx_irq drivers/net/ethernet/intel/e1000/e1000_main.c:3860 [inline]\ne1000_clean+0x4a1/0x26e0 drivers/net/ethernet/intel/e1000/e1000_main.c:3801\n__napi_poll.constprop.0+0xb4/0x540 net/core/dev.c:6576\nnapi_poll net/core/dev.c:6645 [inline]\nnet_rx_action+0x956/0xe90 net/core/dev.c:6778\n__do_softirq+0x21a/0x8de kernel/softirq.c:553\nrun_ksoftirqd kernel/softirq.c:921 [inline]\nrun_ksoftirqd+0x31/0x60 kernel/softirq.c:913\nsmpboot_thread_fn+0x660/0xa10 kernel/smpboot.c:164\nkthread+0x2c6/0x3a0 kernel/kthread.c:388\nret_from_fork+0x45/0x80 arch/x86/kernel/process.c:147\nret_from_fork_asm+0x11/0x20 arch/x86/entry/entry_64.S:242\n\u003c/TASK\u003e\nAllocated by task 5167:\nkasan_save_stack+0x33/0x50 mm/kasan/common.c:47\nkasan_save_track+0x14/0x30 mm/kasan/common.c:68\nunpoison_slab_object mm/kasan/common.c:314 [inline]\n__kasan_slab_alloc+0x81/0x90 mm/kasan/common.c:340\nkasan_slab_alloc include/linux/kasan.h:201 [inline]\nslab_post_alloc_hook mm/slub.c:3813 [inline]\nslab_alloc_node mm/slub.c:3860 [inline]\nkmem_cache_alloc_lru+0x142/0x6f0 mm/slub.c:3879\nalloc_inode_sb include/linux/fs.h:3019 [inline]\nsock_alloc_inode+0x25/0x1c0 net/socket.c:308\nalloc_inode+0x5d/0x220 fs/inode.c:260\nnew_inode_pseudo+0x16/0x80 fs/inode.c:1005\nsock_alloc+0x40/0x270 net/socket.c:634\n__sock_create+0xbc/0x800 net/socket.c:1535\nsock_create net/socket.c:1622 [inline]\n__sys_socket_create net/socket.c:1659 [inline]\n__sys_socket+0x14c/0x260 net/socket.c:1706\n__do_sys_socket net/socket.c:1720 [inline]\n__se_sys_socket net/socket.c:1718 [inline]\n__x64_sys_socket+0x72/0xb0 net/socket.c:1718\ndo_syscall_x64 arch/x86/entry/common.c:52 [inline]\ndo_syscall_64+0xd3/0x250 arch/x86/entry/common.c:83\nentry_SYSCALL_64_after_hwframe+0x63/0x6b\nFreed by task 0:\nkasan_save_stack+0x33/0x50 mm/kasan/common.c:47\nkasan_save_track+0x14/0x30 mm/kasan/common.c:68\nkasan_save_free_info+0x3f/0x60 mm/kasan/generic.c:640\npoison_slab_object mm/kasan/common.c:241 [inline]\n__kasan_slab_free+0x121/0x1b0 mm/kasan/common.c:257\nkasan_slab_free include/linux/kasan.h:184 [inline]\nslab_free_hook mm/slub.c:2121 [inlin\n---truncated---"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-26625\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-26625\nhttps://lore.kernel.org/linux-cve-announce/2024030648-CVE-2024-26625-3549@gregkh/T"
  ]
}