{
  "mitigation": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat build of Apache Camel 4.0 for Spring Boot",
      "fix_state": "Affected",
      "package_name": "apache-pulsar",
      "cpe": "cpe:/a:redhat:camel_spring_boot:4"
    },
    {
      "product_name": "Red Hat build of Apache Camel for Spring Boot",
      "fix_state": "Affected",
      "package_name": "apache-pulsar",
      "cpe": "cpe:/a:redhat:camel_spring_boot:3"
    },
    {
      "product_name": "Red Hat Integration Camel K",
      "fix_state": "Not affected",
      "package_name": "apache-pulsar",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 8",
      "fix_state": "Not affected",
      "package_name": "apache-pulsar",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:8"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Affected",
      "package_name": "apache-pulsar",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2024-03-12T00:00:00Z",
  "bugzilla": {
    "description": "apache-pulsar: Pulsar Functions Worker Allows Unauthorized File Access and Unauthorized HTTP/HTTPS Proxying",
    "id": "2269259",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2269259"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-20-\u003eCWE-552",
  "statement": "Apache Pulsar is not part of EAP - it's not present in the EAP dependency tree and not distributed in the product maven repository. EAP is not affected.",
  "acknowledgement": "",
  "name": "CVE-2024-27894",
  "document_distribution": "",
  "details": [
    "The Pulsar Functions Worker includes a capability that permits authenticated users to create functions where the function's implementation is referenced by a URL. The supported URL schemes include \"file\", \"http\", and \"https\". When a function is created using this method, the Functions Worker will retrieve the implementation from the URL provided by the user. However, this feature introduces a vulnerability that can be exploited by an attacker to gain unauthorized access to any file that the Pulsar Functions Worker process has permissions to read. This includes reading the process environment which potentially includes sensitive information, such as secrets. Furthermore, an attacker could leverage this vulnerability to use the Pulsar Functions Worker as a proxy to access the content of remote HTTP and HTTPS endpoint URLs. This could also be used to carry out denial of service attacks.\nThis vulnerability also applies to the Pulsar Broker when it is configured with \"functionsWorkerEnabled=true\".\nThis issue affects Apache Pulsar versions from 2.4.0 to 2.10.5, from 2.11.0 to 2.11.3, from 3.0.0 to 3.0.2, from 3.1.0 to 3.1.2, and 3.2.0. \n2.10 Pulsar Function Worker users should upgrade to at least 2.10.6.\n2.11 Pulsar Function Worker users should upgrade to at least 2.11.4.\n3.0 Pulsar Function Worker users should upgrade to at least 3.0.3.\n3.1 Pulsar Function Worker users should upgrade to at least 3.1.3.\n3.2 Pulsar Function Worker users should upgrade to at least 3.2.1.\nUsers operating versions prior to those listed above should upgrade to the aforementioned patched versions or newer versions.\nThe updated versions of Pulsar Functions Worker will, by default, impose restrictions on the creation of functions using URLs. For users who rely on this functionality, the Function Worker configuration provides two configuration keys: \"additionalEnabledConnectorUrlPatterns\" and \"additionalEnabledFunctionsUrlPatterns\". These keys allow users to specify a set of URL patterns that are permitted, enabling the creation of functions using URLs that match the defined patterns. This approach ensures that the feature remains available to those who require it, while limiting the potential for unauthorized access and exploitation.",
    "A vulnerability was found in Apache Pulsar's ability to create functions through URL schemes. When retrieving the function implementation contained in the URL, Pulsar fails to limit access to some privileged resources. As a result, this flaw allows an attacker to gain access to sensitive information such as secrets, access to remote HTTP and HTTPS endpoints data, and possibly cause a denial of service. This vulnerability also affects Pulsar Broker deployments with the flag \"functionsWorkerEnabled=true\"."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-27894\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-27894\nhttps://pulsar.apache.org/security/CVE-2024-27894/"
  ]
}