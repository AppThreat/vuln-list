{
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-07-02T00:00:00Z",
      "advisory": "RHSA-2024:4211",
      "package": "kernel-0:4.18.0-553.8.1.el8_10",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Low",
  "public_date": "2024-04-17T00:00:00Z",
  "bugzilla": {
    "description": "kernel: net/bnx2x: Prevent access to a freed page in page_pool",
    "id": "2275733",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2275733"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "4.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-362",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-26859",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnet/bnx2x: Prevent access to a freed page in page_pool\nFix race condition leading to system crash during EEH error handling\nDuring EEH error recovery, the bnx2x driver's transmit timeout logic\ncould cause a race condition when handling reset tasks. The\nbnx2x_tx_timeout() schedules reset tasks via bnx2x_sp_rtnl_task(),\nwhich ultimately leads to bnx2x_nic_unload(). In bnx2x_nic_unload()\nSGEs are freed using bnx2x_free_rx_sge_range(). However, this could\noverlap with the EEH driver's attempt to reset the device using\nbnx2x_io_slot_reset(), which also tries to free SGEs. This race\ncondition can result in system crashes due to accessing freed memory\nlocations in bnx2x_free_rx_sge()\n799  static inline void bnx2x_free_rx_sge(struct bnx2x *bp,\n800struct bnx2x_fastpath *fp, u16 index)\n801  {\n802struct sw_rx_page *sw_buf = \u0026fp-\u003erx_page_ring[index];\n803     struct page *page = sw_buf-\u003epage;\n....\nwhere sw_buf was set to NULL after the call to dma_unmap_page()\nby the preceding thread.\nEEH: Beginning: 'slot_reset'\nPCI 0011:01:00.0#10000: EEH: Invoking bnx2x-\u003eslot_reset()\nbnx2x: [bnx2x_io_slot_reset:14228(eth1)]IO slot reset initializing...\nbnx2x 0011:01:00.0: enabling device (0140 -\u003e 0142)\nbnx2x: [bnx2x_io_slot_reset:14244(eth1)]IO slot reset --\u003e driver unload\nKernel attempted to read user page (0) - exploit attempt? (uid: 0)\nBUG: Kernel NULL pointer dereference on read at 0x00000000\nFaulting instruction address: 0xc0080000025065fc\nOops: Kernel access of bad area, sig: 11 [#1]\n.....\nCall Trace:\n[c000000003c67a20] [c00800000250658c] bnx2x_io_slot_reset+0x204/0x610 [bnx2x] (unreliable)\n[c000000003c67af0] [c0000000000518a8] eeh_report_reset+0xb8/0xf0\n[c000000003c67b60] [c000000000052130] eeh_pe_report+0x180/0x550\n[c000000003c67c70] [c00000000005318c] eeh_handle_normal_event+0x84c/0xa60\n[c000000003c67d50] [c000000000053a84] eeh_event_handler+0xf4/0x170\n[c000000003c67da0] [c000000000194c58] kthread+0x1c8/0x1d0\n[c000000003c67e10] [c00000000000cf64] ret_from_kernel_thread+0x5c/0x64\nTo solve this issue, we need to verify page pool allocations before\nfreeing."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-26859\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-26859\nhttps://lore.kernel.org/linux-cve-announce/2024041735-CVE-2024-26859-a906@gregkh/T"
  ]
}