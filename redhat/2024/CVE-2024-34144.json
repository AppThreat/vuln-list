{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "OpenShift Developer Tools and Services",
      "fix_state": "Affected",
      "package_name": "jenkins",
      "cpe": "cpe:/a:redhat:ocp_tools"
    },
    {
      "product_name": "OpenShift Developer Tools and Services",
      "fix_state": "Affected",
      "package_name": "jenkins-2-plugins",
      "cpe": "cpe:/a:redhat:ocp_tools"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Out of support scope",
      "package_name": "jenkins",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Out of support scope",
      "package_name": "jenkins-2-plugins",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2024-05-02T00:00:00Z",
  "bugzilla": {
    "description": "jenkins-plugin/script-security: sandbox bypass via crafted constructor bodies",
    "id": "2278820",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2278820"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-693",
  "statement": "Red Hat rates the security impact of this vulnerability as Important due to the worst case scenario resulting in a process being able to access resources outside an assigned sandbox.\nThe vulnerabilities that allow for sandbox bypass have been identified in versions up to 1335.vf07d9ce377a_e of the Script Security Plugin. These vulnerabilities include exploiting specially crafted constructor bodies, utilizing certain groovy classes.",
  "acknowledgement": "",
  "name": "CVE-2024-34144",
  "document_distribution": "",
  "details": [
    "A sandbox bypass vulnerability involving crafted constructor bodies in Jenkins Script Security Plugin 1335.vf07d9ce377a_e and earlier allows attackers with permission to define and run sandboxed scripts, including Pipelines, to bypass the sandbox protection and execute arbitrary code in the context of the Jenkins controller JVM.",
    "A sandbox bypass vulnerability was found in the Jenkins Script Security Plugin involving crafted constructor bodies, enabling the circumvention of security restrictions. With crafted constructor bodies, this flaw allows authenticated attackers to define and execute sandboxed scripts, including Pipelines, bypassing sandbox protection mechanisms and executing arbitrary code within the context of the Jenkins controller JVM.\nThe Script Security Plugin features a sandbox functionality designed to enable users with limited privileges to create scripts, including Pipelines, which are generally safe for execution. This security mechanism intercepts calls within sandboxed scripts, referencing various allowlists to decide whether these calls should be permitted.\nThe vulnerabilities that allow for sandbox bypass have been identified in versions up to 1335.vf07d9ce377a_e of the Script Security Plugin. These vulnerabilities include:\n- Exploiting crafted constructor bodies that trigger other constructors, thereby allowing the construction of any subclassable type through implicit casts.\n- Utilizing Groovy classes defined within the sandbox that overshadow certain non-sandboxed classes, facilitating the creation of any subclassable type.\nThese vulnerabilities enable attackers, who have the permission to create and execute sandboxed scripts including Pipelines, to circumvent sandbox protections and execute arbitrary code within the context of the Jenkins controller JVM.\nThe fixed version of this script incorporates enhanced restrictions and sanity checks. These improvements ensure that calls to super constructors are intercepted by the sandbox, including:\n- Ensuring that calls to other constructors via 'this' are now appropriately managed within the sandbox.\n- No longer overlooking classes in packages that may be overshadowed by Groovy-defined classes when intercepting super constructor calls."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-34144\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-34144\nhttp://www.openwall.com/lists/oss-security/2024/05/02/3\nhttps://www.jenkins.io/security/advisory/2024-05-02/#SECURITY-3341"
  ]
}