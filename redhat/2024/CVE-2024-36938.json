{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Under investigation",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Under investigation",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Under investigation",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Low",
  "public_date": "2024-05-30T00:00:00Z",
  "bugzilla": {
    "description": "kernel: bpf, skmsg: Fix NULL pointer dereference in sk_psock_skb_ingress_enqueue",
    "id": "2284479",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2284479"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-36938",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nbpf, skmsg: Fix NULL pointer dereference in sk_psock_skb_ingress_enqueue\nFix NULL pointer data-races in sk_psock_skb_ingress_enqueue() which\nsyzbot reported [1].\n[1]\nBUG: KCSAN: data-race in sk_psock_drop / sk_psock_skb_ingress_enqueue\nwrite to 0xffff88814b3278b8 of 8 bytes by task 10724 on cpu 1:\nsk_psock_stop_verdict net/core/skmsg.c:1257 [inline]\nsk_psock_drop+0x13e/0x1f0 net/core/skmsg.c:843\nsk_psock_put include/linux/skmsg.h:459 [inline]\nsock_map_close+0x1a7/0x260 net/core/sock_map.c:1648\nunix_release+0x4b/0x80 net/unix/af_unix.c:1048\n__sock_release net/socket.c:659 [inline]\nsock_close+0x68/0x150 net/socket.c:1421\n__fput+0x2c1/0x660 fs/file_table.c:422\n__fput_sync+0x44/0x60 fs/file_table.c:507\n__do_sys_close fs/open.c:1556 [inline]\n__se_sys_close+0x101/0x1b0 fs/open.c:1541\n__x64_sys_close+0x1f/0x30 fs/open.c:1541\ndo_syscall_64+0xd3/0x1d0\nentry_SYSCALL_64_after_hwframe+0x6d/0x75\nread to 0xffff88814b3278b8 of 8 bytes by task 10713 on cpu 0:\nsk_psock_data_ready include/linux/skmsg.h:464 [inline]\nsk_psock_skb_ingress_enqueue+0x32d/0x390 net/core/skmsg.c:555\nsk_psock_skb_ingress_self+0x185/0x1e0 net/core/skmsg.c:606\nsk_psock_verdict_apply net/core/skmsg.c:1008 [inline]\nsk_psock_verdict_recv+0x3e4/0x4a0 net/core/skmsg.c:1202\nunix_read_skb net/unix/af_unix.c:2546 [inline]\nunix_stream_read_skb+0x9e/0xf0 net/unix/af_unix.c:2682\nsk_psock_verdict_data_ready+0x77/0x220 net/core/skmsg.c:1223\nunix_stream_sendmsg+0x527/0x860 net/unix/af_unix.c:2339\nsock_sendmsg_nosec net/socket.c:730 [inline]\n__sock_sendmsg+0x140/0x180 net/socket.c:745\n____sys_sendmsg+0x312/0x410 net/socket.c:2584\n___sys_sendmsg net/socket.c:2638 [inline]\n__sys_sendmsg+0x1e9/0x280 net/socket.c:2667\n__do_sys_sendmsg net/socket.c:2676 [inline]\n__se_sys_sendmsg net/socket.c:2674 [inline]\n__x64_sys_sendmsg+0x46/0x50 net/socket.c:2674\ndo_syscall_64+0xd3/0x1d0\nentry_SYSCALL_64_after_hwframe+0x6d/0x75\nvalue changed: 0xffffffff83d7feb0 -\u003e 0x0000000000000000\nReported by Kernel Concurrency Sanitizer on:\nCPU: 0 PID: 10713 Comm: syz-executor.4 Tainted: G        W          6.8.0-syzkaller-08951-gfe46a7dd189e #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 02/29/2024\nPrior to this, commit 4cd12c6065df (\"bpf, sockmap: Fix NULL pointer\ndereference in sk_psock_verdict_data_ready()\") fixed one NULL pointer\nsimilarly due to no protection of saved_data_ready. Here is another\ndifferent caller causing the same issue because of the same reason. So\nwe should protect it with sk_callback_lock read lock because the writer\nside in the sk_psock_drop() uses \"write_lock_bh(\u0026sk-\u003esk_callback_lock);\".\nTo avoid errors that could happen in future, I move those two pairs of\nlock into the sk_psock_data_ready(), which is suggested by John Fastabend."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-36938\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-36938\nhttps://lore.kernel.org/linux-cve-announce/2024053043-CVE-2024-36938-7242@gregkh/T"
  ]
}