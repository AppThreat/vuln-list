{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-04-03T00:00:00Z",
  "bugzilla": {
    "description": "kernel: powerpc/pseries/iommu: DLPAR add doesn't completely initialize pci_controller",
    "id": "2273272",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2273272"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-26738",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\npowerpc/pseries/iommu: DLPAR add doesn't completely initialize pci_controller\nWhen a PCI device is dynamically added, the kernel oopses with a NULL\npointer dereference:\nBUG: Kernel NULL pointer dereference on read at 0x00000030\nFaulting instruction address: 0xc0000000006bbe5c\nOops: Kernel access of bad area, sig: 11 [#1]\nLE PAGE_SIZE=64K MMU=Radix SMP NR_CPUS=2048 NUMA pSeries\nModules linked in: rpadlpar_io rpaphp rpcsec_gss_krb5 auth_rpcgss nfsv4 dns_resolver nfs lockd grace fscache netfs xsk_diag bonding nft_compat nf_tables nfnetlink rfkill binfmt_misc dm_multipath rpcrdma sunrpc rdma_ucm ib_srpt ib_isert iscsi_target_mod target_core_mod ib_umad ib_iser libiscsi scsi_transport_iscsi ib_ipoib rdma_cm iw_cm ib_cm mlx5_ib ib_uverbs ib_core pseries_rng drm drm_panel_orientation_quirks xfs libcrc32c mlx5_core mlxfw sd_mod t10_pi sg tls ibmvscsi ibmveth scsi_transport_srp vmx_crypto pseries_wdt psample dm_mirror dm_region_hash dm_log dm_mod fuse\nCPU: 17 PID: 2685 Comm: drmgr Not tainted 6.7.0-203405+ #66\nHardware name: IBM,9080-HEX POWER10 (raw) 0x800200 0xf000006 of:IBM,FW1060.00 (NH1060_008) hv:phyp pSeries\nNIP:  c0000000006bbe5c LR: c000000000a13e68 CTR: c0000000000579f8\nREGS: c00000009924f240 TRAP: 0300   Not tainted  (6.7.0-203405+)\nMSR:  8000000000009033 \u003cSF,EE,ME,IR,DR,RI,LE\u003e  CR: 24002220  XER: 20040006\nCFAR: c000000000a13e64 DAR: 0000000000000030 DSISR: 40000000 IRQMASK: 0\n...\nNIP sysfs_add_link_to_group+0x34/0x94\nLR  iommu_device_link+0x5c/0x118\nCall Trace:\niommu_init_device+0x26c/0x318 (unreliable)\niommu_device_link+0x5c/0x118\niommu_init_device+0xa8/0x318\niommu_probe_device+0xc0/0x134\niommu_bus_notifier+0x44/0x104\nnotifier_call_chain+0xb8/0x19c\nblocking_notifier_call_chain+0x64/0x98\nbus_notify+0x50/0x7c\ndevice_add+0x640/0x918\npci_device_add+0x23c/0x298\nof_create_pci_dev+0x400/0x884\nof_scan_pci_dev+0x124/0x1b0\n__of_scan_bus+0x78/0x18c\npcibios_scan_phb+0x2a4/0x3b0\ninit_phb_dynamic+0xb8/0x110\ndlpar_add_slot+0x170/0x3b8 [rpadlpar_io]\nadd_slot_store.part.0+0xb4/0x130 [rpadlpar_io]\nkobj_attr_store+0x2c/0x48\nsysfs_kf_write+0x64/0x78\nkernfs_fop_write_iter+0x1b0/0x290\nvfs_write+0x350/0x4a0\nksys_write+0x84/0x140\nsystem_call_exception+0x124/0x330\nsystem_call_vectored_common+0x15c/0x2ec\nCommit a940904443e4 (\"powerpc/iommu: Add iommu_ops to report capabilities\nand allow blocking domains\") broke DLPAR add of PCI devices.\nThe above added iommu_device structure to pci_controller. During\nsystem boot, PCI devices are discovered and this newly added iommu_device\nstructure is initialized by a call to iommu_device_register().\nDuring DLPAR add of a PCI device, a new pci_controller structure is\nallocated but there are no calls made to iommu_device_register()\ninterface.\nFix is to register the iommu device during DLPAR add as well."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-26738\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-26738\nhttps://lore.kernel.org/linux-cve-announce/2024040300-CVE-2024-26738-844b@gregkh/T"
  ]
}