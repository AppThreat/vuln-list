{
  "mitigation": "Use an alternate auth_type: auth_type: client_id+client_secret. Disabling the policy entirely might be a temporary solution if the alternate {{auth_type is not feasible for some reason. The only purpose the token introspection endpoint serves is for sessions that are revoked in RH SSO before the standard TTL expires via the exp claim.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat 3scale API Management Platform 2",
      "fix_state": "Affected",
      "package_name": "apicast",
      "cpe": "cpe:/a:redhat:red_hat_3scale_amp:2"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-02-28T00:00:00Z",
  "bugzilla": {
    "description": "apicast: use_3scale_oidc_issuer_endpoint of Token Introspection policy isn't compatible with RH-SSO 7.5 or later versions",
    "id": "2258456",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2258456"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.3",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-280",
  "statement": "Red Hat considers this as a Moderate flaw, as 3Scale will allow revoked or expired tokens, however, it will not allow tokens belonging to an unauthorized client. A client cannot access the services to which it is not subscribed because the authrep request is still performed correctly and will reject the client_id extracted from the JWT. This requires the attacker to obtain a token and could jeopardize a small and uncontrolled amount of data.",
  "acknowledgement": "",
  "name": "CVE-2024-0560",
  "document_distribution": "",
  "details": [
    "A vulnerability was found in 3Scale, when used with Keycloak 15 (or RHSSO 7.5.0) and superiors. When the auth_type is use_3scale_oidc_issuer_endpoint, the Token Introspection policy discovers the Token Introspection endpoint from the token_introspection_endpoint field, but the field was removed on RH-SSO 7.5. As a result, the policy doesn't inspect tokens, it determines that all tokens are valid.",
    "A vulnerability was found in 3Scale, when used with Keycloak 15 (or RHSSO 7.5.0) and superiors. When the auth_type is use_3scale_oidc_issuer_endpoint, the Token Introspection policy discovers the Token Introspection endpoint from the token_introspection_endpoint field, but the field was removed on RH-SSO 7.5. As a result, the policy doesn't inspect tokens, it determines that all tokens are valid."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-0560\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-0560\nhttps://github.com/3scale/APIcast/pull/1438"
  ]
}