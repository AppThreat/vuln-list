{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-06-25T00:00:00Z",
  "bugzilla": {
    "description": "kernel: nilfs2: fix potential kernel bug due to lack of writeback flag waiting",
    "id": "2294285",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2294285"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-37078",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnilfs2: fix potential kernel bug due to lack of writeback flag waiting\nDestructive writes to a block device on which nilfs2 is mounted can cause\na kernel bug in the folio/page writeback start routine or writeback end\nroutine (__folio_start_writeback in the log below):\nkernel BUG at mm/page-writeback.c:3070!\nOops: invalid opcode: 0000 [#1] PREEMPT SMP KASAN PTI\n...\nRIP: 0010:__folio_start_writeback+0xbaa/0x10e0\nCode: 25 ff 0f 00 00 0f 84 18 01 00 00 e8 40 ca c6 ff e9 17 f6 ff ff\ne8 36 ca c6 ff 4c 89 f7 48 c7 c6 80 c0 12 84 e8 e7 b3 0f 00 90 \u003c0f\u003e\n0b e8 1f ca c6 ff 4c 89 f7 48 c7 c6 a0 c6 12 84 e8 d0 b3 0f 00\n...\nCall Trace:\n\u003cTASK\u003e\nnilfs_segctor_do_construct+0x4654/0x69d0 [nilfs2]\nnilfs_segctor_construct+0x181/0x6b0 [nilfs2]\nnilfs_segctor_thread+0x548/0x11c0 [nilfs2]\nkthread+0x2f0/0x390\nret_from_fork+0x4b/0x80\nret_from_fork_asm+0x1a/0x30\n\u003c/TASK\u003e\nThis is because when the log writer starts a writeback for segment summary\nblocks or a super root block that use the backing device's page cache, it\ndoes not wait for the ongoing folio/page writeback, resulting in an\ninconsistent writeback state.\nFix this issue by waiting for ongoing writebacks when putting\nfolios/pages on the backing device into writeback state."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-37078\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-37078\nhttps://lore.kernel.org/linux-cve-announce/2024062547-CVE-2024-37078-3aaa@gregkh/T"
  ]
}