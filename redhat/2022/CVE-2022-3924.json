{
  "mitigation": "Disabling stale-answer-client-timeout entirely or setting the timeout value to zero prevents the problem.\nIt is not possible to disable the limit on recursive-clients, though it could be set to a very high value in order to reduce the likelihood of encountering this scenario. However, this is not recommended as the limit on recursive clients is important for preventing exhaustion of server resources.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2023-05-16T00:00:00Z",
      "advisory": "RHSA-2023:2792",
      "package": "bind9.16-32:9.16.23-0.14.el8",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-05-09T00:00:00Z",
      "advisory": "RHSA-2023:2261",
      "package": "bind-32:9.16.23-11.el9",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "bind",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "bind",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "bind",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "dhcp",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2023-01-25T00:00:00Z",
  "bugzilla": {
    "description": "bind: sending specific queries to the resolver may cause a DoS",
    "id": "2164039",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2164039"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-20",
  "statement": "The flaw exists in the implementation of the stale-answer-client-timeout option, which was first effectively introduced in BIND 9.16.12",
  "acknowledgement": "Red Hat would like to thank Maksym Odinintsev (AWS) for reporting this issue.",
  "name": "CVE-2022-3924",
  "document_distribution": "",
  "details": [
    "This issue can affect BIND 9 resolvers with `stale-answer-enable yes;` that also make use of the option `stale-answer-client-timeout`, configured with a value greater than zero.\nIf the resolver receives many queries that require recursion, there will be a corresponding increase in the number of clients that are waiting for recursion to complete. If there are sufficient clients already waiting when a new client query is received so that it is necessary to SERVFAIL the longest waiting client (see BIND 9 ARM `recursive-clients` limit and soft quota), then it is possible for a race to occur between providing a stale answer to this older client and sending an early timeout SERVFAIL, which may cause an assertion failure.\nThis issue affects BIND 9 versions 9.16.12 through 9.16.36, 9.18.0 through 9.18.10, 9.19.0 through 9.19.8, and 9.16.12-S1 through 9.16.36-S1.",
    "A flaw was found in Bind. When resolver receives many queries requiring recursion, there will be a corresponding increase in the number of clients waiting for recursion to complete. This may, under certain conditions, lead to an assertion failure and a denial of service."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-3924\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-3924\nhttps://kb.isc.org/docs/cve-2022-3924"
  ]
}