{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-06-20T00:00:00Z",
  "bugzilla": {
    "description": "kernel: net, neigh: Do not trigger immediate probes on NUD_FAILED from neigh_managed_work",
    "id": "2293283",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2293283"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-48719",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnet, neigh: Do not trigger immediate probes on NUD_FAILED from neigh_managed_work\nsyzkaller was able to trigger a deadlock for NTF_MANAGED entries [0]:\nkworker/0:16/14617 is trying to acquire lock:\nffffffff8d4dd370 (\u0026tbl-\u003elock){++-.}-{2:2}, at: ___neigh_create+0x9e1/0x2990 net/core/neighbour.c:652\n[...]\nbut task is already holding lock:\nffffffff8d4dd370 (\u0026tbl-\u003elock){++-.}-{2:2}, at: neigh_managed_work+0x35/0x250 net/core/neighbour.c:1572\nThe neighbor entry turned to NUD_FAILED state, where __neigh_event_send()\ntriggered an immediate probe as per commit cd28ca0a3dd1 (\"neigh: reduce\narp latency\") via neigh_probe() given table lock was held.\nOne option to fix this situation is to defer the neigh_probe() back to\nthe neigh_timer_handler() similarly as pre cd28ca0a3dd1. For the case\nof NTF_MANAGED, this deferral is acceptable given this only happens on\nactual failure state and regular / expected state is NUD_VALID with the\nentry already present.\nThe fix adds a parameter to __neigh_event_send() in order to communicate\nwhether immediate probe is allowed or disallowed. Existing call-sites\nof neigh_event_send() default as-is to immediate probe. However, the\nneigh_managed_work() disables it via use of neigh_event_send_probe().\n[0] \u003cTASK\u003e\n__dump_stack lib/dump_stack.c:88 [inline]\ndump_stack_lvl+0xcd/0x134 lib/dump_stack.c:106\nprint_deadlock_bug kernel/locking/lockdep.c:2956 [inline]\ncheck_deadlock kernel/locking/lockdep.c:2999 [inline]\nvalidate_chain kernel/locking/lockdep.c:3788 [inline]\n__lock_acquire.cold+0x149/0x3ab kernel/locking/lockdep.c:5027\nlock_acquire kernel/locking/lockdep.c:5639 [inline]\nlock_acquire+0x1ab/0x510 kernel/locking/lockdep.c:5604\n__raw_write_lock_bh include/linux/rwlock_api_smp.h:202 [inline]\n_raw_write_lock_bh+0x2f/0x40 kernel/locking/spinlock.c:334\n___neigh_create+0x9e1/0x2990 net/core/neighbour.c:652\nip6_finish_output2+0x1070/0x14f0 net/ipv6/ip6_output.c:123\n__ip6_finish_output net/ipv6/ip6_output.c:191 [inline]\n__ip6_finish_output+0x61e/0xe90 net/ipv6/ip6_output.c:170\nip6_finish_output+0x32/0x200 net/ipv6/ip6_output.c:201\nNF_HOOK_COND include/linux/netfilter.h:296 [inline]\nip6_output+0x1e4/0x530 net/ipv6/ip6_output.c:224\ndst_output include/net/dst.h:451 [inline]\nNF_HOOK include/linux/netfilter.h:307 [inline]\nndisc_send_skb+0xa99/0x17f0 net/ipv6/ndisc.c:508\nndisc_send_ns+0x3a9/0x840 net/ipv6/ndisc.c:650\nndisc_solicit+0x2cd/0x4f0 net/ipv6/ndisc.c:742\nneigh_probe+0xc2/0x110 net/core/neighbour.c:1040\n__neigh_event_send+0x37d/0x1570 net/core/neighbour.c:1201\nneigh_event_send include/net/neighbour.h:470 [inline]\nneigh_managed_work+0x162/0x250 net/core/neighbour.c:1574\nprocess_one_work+0x9ac/0x1650 kernel/workqueue.c:2307\nworker_thread+0x657/0x1110 kernel/workqueue.c:2454\nkthread+0x2e9/0x3a0 kernel/kthread.c:377\nret_from_fork+0x1f/0x30 arch/x86/entry/entry_64.S:295\n\u003c/TASK\u003e"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-48719\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-48719\nhttps://lore.kernel.org/linux-cve-announce/2024062056-CVE-2022-48719-4312@gregkh/T"
  ]
}