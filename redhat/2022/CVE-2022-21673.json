{
  "affected_release": [
    {
      "product_name": "Red Hat Ceph Storage 5.2",
      "release_date": "2022-08-09T00:00:00Z",
      "advisory": "RHSA-2022:6024",
      "package": "rhceph/rhceph-5-dashboard-rhel8:5-56",
      "cpe": "cpe:/a:redhat:ceph_storage:5.2::el8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2022-11-08T00:00:00Z",
      "advisory": "RHSA-2022:7519",
      "package": "grafana-0:7.5.15-3.el8",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2022-11-15T00:00:00Z",
      "advisory": "RHSA-2022:8057",
      "package": "grafana-0:7.5.15-3.el9",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.10",
      "release_date": "2022-03-10T00:00:00Z",
      "advisory": "RHSA-2022:0056",
      "package": "openshift4/ose-grafana:v4.10.0-202202160023.p0.g48aec35.assembly.stream",
      "cpe": "cpe:/a:redhat:openshift:4.10::el8"
    }
  ],
  "package_state": [
    {
      "product_name": "OpenShift Service Mesh 2.0",
      "fix_state": "Will not fix",
      "package_name": "servicemesh-grafana",
      "cpe": "cpe:/a:redhat:service_mesh:2.0"
    },
    {
      "product_name": "OpenShift Service Mesh 2.1",
      "fix_state": "Will not fix",
      "package_name": "servicemesh-grafana",
      "cpe": "cpe:/a:redhat:service_mesh:2.1"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Affected",
      "package_name": "grafana",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Ceph Storage 2",
      "fix_state": "Out of support scope",
      "package_name": "grafana",
      "cpe": "cpe:/a:redhat:ceph_storage:2"
    },
    {
      "product_name": "Red Hat Ceph Storage 3",
      "fix_state": "Out of support scope",
      "package_name": "grafana",
      "cpe": "cpe:/a:redhat:ceph_storage:3"
    },
    {
      "product_name": "Red Hat Ceph Storage 3",
      "fix_state": "Out of support scope",
      "package_name": "rhceph/rhceph-3-dashboard-rhel7",
      "cpe": "cpe:/a:redhat:ceph_storage:3"
    },
    {
      "product_name": "Red Hat Ceph Storage 4",
      "fix_state": "Affected",
      "package_name": "rhceph/rhceph-4-dashboard-rhel8",
      "cpe": "cpe:/a:redhat:ceph_storage:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Not affected",
      "package_name": "openshift3/grafana",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    },
    {
      "product_name": "Red Hat Storage 3",
      "fix_state": "Not affected",
      "package_name": "grafana",
      "cpe": "cpe:/a:redhat:storage:3"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2022-01-18T00:00:00Z",
  "bugzilla": {
    "description": "grafana: Forward OAuth Identity Token can allow users to access some data sources",
    "id": "2044628",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2044628"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "4.3",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-200-\u003eCWE-201",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-21673",
  "document_distribution": "",
  "details": [
    "Grafana is an open-source platform for monitoring and observability. In affected versions when a data source has the Forward OAuth Identity feature enabled, sending a query to that datasource with an API token (and no other user credentials) will forward the OAuth Identity of the most recently logged-in user. This can allow API token holders to retrieve data for which they may not have intended access. This attack relies on the Grafana instance having data sources that support the Forward OAuth Identity feature, the Grafana instance having a data source with the Forward OAuth Identity feature toggled on, the Grafana instance having OAuth enabled, and the Grafana instance having usable API keys. This issue has been patched in versions 7.5.13 and 8.3.4.",
    "An information-disclosure flaw was found in grafana. When a data source has the Forward OAuth Identity feature enabled, sending a query to that data source with an API token (and no other user credentials) will forward the OAuth Identity of the most recently logged-in user. This flaw allows API token holders to retrieve data to which they may not be authorized."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-21673\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-21673\nhttps://grafana.com/blog/2022/01/18/grafana-8.3.4-and-7.5.13-released-with-important-security-fix/"
  ]
}