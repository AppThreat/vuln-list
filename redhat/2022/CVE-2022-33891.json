{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat build of Apache Camel for Spring Boot",
      "fix_state": "Not affected",
      "package_name": "apache-spark",
      "cpe": "cpe:/a:redhat:camel_spring_boot:3"
    },
    {
      "product_name": "Red Hat Integration Camel K",
      "fix_state": "Not affected",
      "package_name": "apache-spark",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat JBoss Data Grid 7",
      "fix_state": "Not affected",
      "package_name": "apache-spark",
      "cpe": "cpe:/a:redhat:jboss_data_grid:7"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Not affected",
      "package_name": "apache-spark",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2022-07-18T00:00:00Z",
  "bugzilla": {
    "description": "apache-spark: Apache Spark shell command injection vulnerability via Spark UI",
    "id": "2174263",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2174263"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-77",
  "statement": "Red Hat Middleware as  Data Grid 7 and Fuse 7 products listed in this CVE page does not ship Apache Spark with their source code or binaries. Those who ship Apache Spark partially do are running versions \u003c 3.x. Since 3.x is written in Scala and 2.x is written in Java, there's a difference in their source code. \nIn 2.4 version this demands 'spark.acls.enable' which comes disabled by default, needs to be set 'true' in order to be vulnerable. Red Hat Middleware stack does not have this option enabled.",
  "acknowledgement": "",
  "name": "CVE-2022-33891",
  "document_distribution": "",
  "details": [
    "The Apache Spark UI offers the possibility to enable ACLs via the configuration option spark.acls.enable. With an authentication filter, this checks whether a user has access permissions to view or modify the application. If ACLs are enabled, a code path in HttpSecurityFilter can allow someone to perform impersonation by providing an arbitrary user name. A malicious user might then be able to reach a permission check function that will ultimately build a Unix shell command based on their input, and execute it. This will result in arbitrary shell command execution as the user Spark is currently running as. This affects Apache Spark versions 3.0.3 and earlier, versions 3.1.1 to 3.1.2, and versions 3.2.0 to 3.2.1.",
    "A flaw was found in Apache Spark. This flaw allows a malicious user to impersonate another user and jeopardize the environment by executing shell commands."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-33891\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-33891"
  ]
}