{
  "mitigation": "In order to avoid the possibility of information access, review application source code for '@RunAs' and 'run-as-principal' usage. Also, make sure the application is using or not Elytron Security. It's possible to investigate by checking if the commands from '$JBOSS_HOME/docs/examples/enable-elytron.cli' or similar were executed.",
  "affected_release": [
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 7",
      "release_date": "2022-06-06T00:00:00Z",
      "advisory": "RHSA-2022:4922",
      "package": "wildfly",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 7.4 for RHEL 8",
      "release_date": "2022-06-06T00:00:00Z",
      "advisory": "RHSA-2022:4919",
      "package": "eap7-wildfly-0:7.4.5-3.GA_redhat_00001.1.el8eap",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4::el8"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 7.4 on RHEL 7",
      "release_date": "2022-06-06T00:00:00Z",
      "advisory": "RHSA-2022:4918",
      "package": "eap7-wildfly-0:7.4.5-3.GA_redhat_00001.1.el7eap",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4::el7"
    },
    {
      "product_name": "Red Hat Single Sign-On 7",
      "release_date": "2022-10-04T00:00:00Z",
      "advisory": "RHSA-2022:6787",
      "package": "wildfly",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.5 for RHEL 7",
      "release_date": "2022-10-04T00:00:00Z",
      "advisory": "RHSA-2022:6782",
      "package": "rh-sso7-keycloak-0:15.0.8-1.redhat_00001.1.el7sso",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.5::el7"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.5 for RHEL 8",
      "release_date": "2022-10-04T00:00:00Z",
      "advisory": "RHSA-2022:6783",
      "package": "rh-sso7-keycloak-0:15.0.8-1.redhat_00001.1.el8sso",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.5::el8"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.6.1",
      "release_date": "2022-11-03T00:00:00Z",
      "advisory": "RHSA-2022:7417",
      "package": "wildfly",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6.1"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.6 for RHEL 7",
      "release_date": "2022-11-03T00:00:00Z",
      "advisory": "RHSA-2022:7409",
      "package": "rh-sso7-keycloak-0:18.0.3-1.redhat_00001.1.el7sso",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el7"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.6 for RHEL 8",
      "release_date": "2022-11-03T00:00:00Z",
      "advisory": "RHSA-2022:7410",
      "package": "rh-sso7-keycloak-0:18.0.3-1.redhat_00001.1.el8sso",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el8"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.6 for RHEL 9",
      "release_date": "2022-11-03T00:00:00Z",
      "advisory": "RHSA-2022:7411",
      "package": "rh-sso7-0:1-5.el9sso",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el9"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.6 for RHEL 9",
      "release_date": "2022-11-03T00:00:00Z",
      "advisory": "RHSA-2022:7411",
      "package": "rh-sso7-javapackages-tools-0:6.0.0-7.el9sso",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el9"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.6 for RHEL 9",
      "release_date": "2022-11-03T00:00:00Z",
      "advisory": "RHSA-2022:7411",
      "package": "rh-sso7-keycloak-0:18.0.3-1.redhat_00001.1.el9sso",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el9"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat build of Quarkus",
      "fix_state": "Not affected",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:quarkus:2"
    },
    {
      "product_name": "Red Hat Data Grid 8",
      "fix_state": "Not affected",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:jboss_data_grid:8"
    },
    {
      "product_name": "Red Hat Decision Manager 7",
      "fix_state": "Out of support scope",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7"
    },
    {
      "product_name": "Red Hat Integration Camel K",
      "fix_state": "Not affected",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat Integration Camel Quarkus",
      "fix_state": "Not affected",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:camel_quarkus:2"
    },
    {
      "product_name": "Red Hat Integration Change Data Capture",
      "fix_state": "Not affected",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat Integration Data Virtualisation Operator",
      "fix_state": "Not affected",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat Integration Service Registry",
      "fix_state": "Not affected",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:service_registry:2"
    },
    {
      "product_name": "Red Hat JBoss A-MQ Streams",
      "fix_state": "Not affected",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:amq_streams:1"
    },
    {
      "product_name": "Red Hat JBoss Data Grid 7",
      "fix_state": "Out of support scope",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:jboss_data_grid:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Out of support scope",
      "package_name": "keycloak-adapter-eap6",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Out of support scope",
      "package_name": "keycloak-adapter-sso7_2-eap6",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Out of support scope",
      "package_name": "keycloak-adapter-sso7_3-eap6",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Out of support scope",
      "package_name": "keycloak-adapter-sso7_4-eap6",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Out of support scope",
      "package_name": "keycloak-adapter-sso7_5-eap6",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Out of support scope",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack",
      "fix_state": "Not affected",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:jbosseapxp"
    },
    {
      "product_name": "Red Hat JBoss Fuse 6",
      "fix_state": "Out of support scope",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:jboss_fuse:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Not affected",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat JBoss Fuse Service Works 6",
      "fix_state": "Out of support scope",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:jboss_fuse_service_works:6"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13 (Queens)",
      "fix_state": "Out of support scope",
      "package_name": "opendaylight",
      "cpe": "cpe:/a:redhat:openstack:13"
    },
    {
      "product_name": "Red Hat Process Automation 7",
      "fix_state": "Out of support scope",
      "package_name": "wildfly",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2022-05-03T00:00:00Z",
  "bugzilla": {
    "description": "CVE-2022-0866 wildfly: Wildfly management of EJB Session context returns wrong caller principal with Elytron Security enabled",
    "id": "2060929",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2060929"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "3.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-863-\u003eCWE-1220",
  "statement": "JBoss EAP 7.1 until 7.4 is not affected by default as it comes with Legacy Security enabled out-of-the-box. This only affects application scope range and the methods mentioned, no access to server data.",
  "acknowledgement": "Red Hat would like to thank Oliver Bieri (Schindler Elevator Ltd., Switzerland) for reporting this issue.",
  "name": "CVE-2022-0866",
  "document_distribution": "",
  "details": [
    "This is a concurrency issue that can result in the wrong caller principal being returned from the session context of an EJB that is configured with a RunAs principal. In particular, the org.jboss.as.ejb3.component.EJBComponent class has an incomingRunAsIdentity field. This field is used by the org.jboss.as.ejb3.security.RunAsPrincipalInterceptor to keep track of the current identity prior to switching to a new identity created using the RunAs principal. The exploit consist that the EJBComponent#incomingRunAsIdentity field is currently just a SecurityIdentity. This means in a concurrent environment, where multiple users are repeatedly invoking an EJB that is configured with a RunAs principal, it's possible for the wrong the caller principal to be returned from EJBComponent#getCallerPrincipal. Similarly, it's also possible for EJBComponent#isCallerInRole to return the wrong value. Both of these methods rely on incomingRunAsIdentity. Affects all versions of JBoss EAP from 7.1.0 and all versions of WildFly 11+ when Elytron is enabled.",
    "A flaw was found in Wildfly, where it returns an incorrect caller principal under certain heavily concurrent situations when Elytron Security is used. This flaw allows an attacker to gain improper access to information they should not have."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-0866\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-0866"
  ]
}