{
  "mitigation": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat build of Apache Camel 4.0 for Spring Boot",
      "fix_state": "Affected",
      "package_name": "apache-pulsar",
      "cpe": "cpe:/a:redhat:camel_spring_boot:4"
    },
    {
      "product_name": "Red Hat build of Apache Camel for Spring Boot",
      "fix_state": "Affected",
      "package_name": "apache-pulsar",
      "cpe": "cpe:/a:redhat:camel_spring_boot:3"
    },
    {
      "product_name": "Red Hat Integration Camel K",
      "fix_state": "Not affected",
      "package_name": "apache-pulsar",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 8",
      "fix_state": "Not affected",
      "package_name": "apache-pulsar",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:8"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Will not fix",
      "package_name": "apache-pulsar",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2024-03-12T00:00:00Z",
  "bugzilla": {
    "description": "apache-pulsar: Improper Authentication for Pulsar Proxy Statistics Endpoint",
    "id": "2269250",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2269250"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.2",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:L",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-306",
  "statement": "Apache Pulsar is not part of EAP - it's not present in the EAP dependency tree and not distributed in the product maven repository. EAP is not affected.",
  "acknowledgement": "",
  "name": "CVE-2022-34321",
  "document_distribution": "",
  "details": [
    "Improper Authentication vulnerability in Apache Pulsar Proxy allows an attacker to connect to the /proxy-stats endpoint without authentication. The vulnerable endpoint exposes detailed statistics about live connections, along with the capability to modify the logging level of proxied connections without requiring proper authentication credentials.\nThis issue affects Apache Pulsar versions from 2.6.0 to 2.10.5, from 2.11.0 to 2.11.2, from 3.0.0 to 3.0.1, and 3.1.0.\nThe known risks include exposing sensitive information such as connected client IP and unauthorized logging level manipulation which could lead to a denial-of-service condition by significantly increasing the proxy's logging overhead. When deployed via the Apache Pulsar Helm chart within Kubernetes environments, the actual client IP might not be revealed through the load balancer's default behavior, which typically obscures the original source IP addresses when externalTrafficPolicy is being configured to \"Cluster\" by default. The /proxy-stats endpoint contains topic level statistics, however, in the default configuration, the topic level statistics aren't known to be exposed.\n2.10 Pulsar Proxy users should upgrade to at least 2.10.6.\n2.11 Pulsar Proxy users should upgrade to at least 2.11.3.\n3.0 Pulsar Proxy users should upgrade to at least 3.0.2.\n3.1 Pulsar Proxy users should upgrade to at least 3.1.1.\nUsers operating versions prior to those listed above should upgrade to the aforementioned patched versions or newer versions. Additionally, it's imperative to recognize that the Apache Pulsar Proxy is not intended for direct exposure to the internet. The architectural design of Pulsar Proxy assumes that it will operate within a secured network environment, safeguarded by appropriate perimeter defenses.",
    "A flaw was found in Apache Pulsar. Due to missing authentication checking, unauthenticated users can connect to the `/proxy-stats` endpoint. This endpoint exposes confidential information about the deployment and may allow the attacker to increase the logging level. As a result, the attacker may have information about IP addresses connected to the service. Additionally, it may lead to a denial Of service when the logging level is increased."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-34321\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-34321\nhttps://pulsar.apache.org/security/CVE-2022-34321/"
  ]
}