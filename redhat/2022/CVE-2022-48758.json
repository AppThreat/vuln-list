{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-06-20T00:00:00Z",
  "bugzilla": {
    "description": "kernel: scsi: bnx2fc: Flush destroy_work queue before calling bnx2fc_interface_put()",
    "id": "2293381",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2293381"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-48758",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nscsi: bnx2fc: Flush destroy_work queue before calling bnx2fc_interface_put()\nThe bnx2fc_destroy() functions are removing the interface before calling\ndestroy_work. This results multiple WARNings from sysfs_remove_group() as\nthe controller rport device attributes are removed too early.\nReplace the fcoe_port's destroy_work queue. It's not needed.\nThe problem is easily reproducible with the following steps.\nExample:\n$ dmesg -w \u0026\n$ systemctl enable --now fcoe\n$ fipvlan -s -c ens2f1\n$ fcoeadm -d ens2f1.802\n[  583.464488] host2: libfc: Link down on port (7500a1)\n[  583.472651] bnx2fc: 7500a1 - rport not created Yet!!\n[  583.490468] ------------[ cut here ]------------\n[  583.538725] sysfs group 'power' not found for kobject 'rport-2:0-0'\n[  583.568814] WARNING: CPU: 3 PID: 192 at fs/sysfs/group.c:279 sysfs_remove_group+0x6f/0x80\n[  583.607130] Modules linked in: dm_service_time 8021q garp mrp stp llc bnx2fc cnic uio rpcsec_gss_krb5 auth_rpcgss nfsv4 ...\n[  583.942994] CPU: 3 PID: 192 Comm: kworker/3:2 Kdump: loaded Not tainted 5.14.0-39.el9.x86_64 #1\n[  583.984105] Hardware name: HP ProLiant DL120 G7, BIOS J01 07/01/2013\n[  584.016535] Workqueue: fc_wq_2 fc_rport_final_delete [scsi_transport_fc]\n[  584.050691] RIP: 0010:sysfs_remove_group+0x6f/0x80\n[  584.074725] Code: ff 5b 48 89 ef 5d 41 5c e9 ee c0 ff ff 48 89 ef e8 f6 b8 ff ff eb d1 49 8b 14 24 48 8b 33 48 c7 c7 ...\n[  584.162586] RSP: 0018:ffffb567c15afdc0 EFLAGS: 00010282\n[  584.188225] RAX: 0000000000000000 RBX: ffffffff8eec4220 RCX: 0000000000000000\n[  584.221053] RDX: ffff8c1586ce84c0 RSI: ffff8c1586cd7cc0 RDI: ffff8c1586cd7cc0\n[  584.255089] RBP: 0000000000000000 R08: 0000000000000000 R09: ffffb567c15afc00\n[  584.287954] R10: ffffb567c15afbf8 R11: ffffffff8fbe7f28 R12: ffff8c1486326400\n[  584.322356] R13: ffff8c1486326480 R14: ffff8c1483a4a000 R15: 0000000000000004\n[  584.355379] FS:  0000000000000000(0000) GS:ffff8c1586cc0000(0000) knlGS:0000000000000000\n[  584.394419] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[  584.421123] CR2: 00007fe95a6f7840 CR3: 0000000107674002 CR4: 00000000000606e0\n[  584.454888] Call Trace:\n[  584.466108]  device_del+0xb2/0x3e0\n[  584.481701]  device_unregister+0x13/0x60\n[  584.501306]  bsg_unregister_queue+0x5b/0x80\n[  584.522029]  bsg_remove_queue+0x1c/0x40\n[  584.541884]  fc_rport_final_delete+0xf3/0x1d0 [scsi_transport_fc]\n[  584.573823]  process_one_work+0x1e3/0x3b0\n[  584.592396]  worker_thread+0x50/0x3b0\n[  584.609256]  ? rescuer_thread+0x370/0x370\n[  584.628877]  kthread+0x149/0x170\n[  584.643673]  ? set_kthread_struct+0x40/0x40\n[  584.662909]  ret_from_fork+0x22/0x30\n[  584.680002] ---[ end trace 53575ecefa942ece ]---"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-48758\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-48758\nhttps://lore.kernel.org/linux-cve-announce/2024062007-CVE-2022-48758-1500@gregkh/T"
  ]
}