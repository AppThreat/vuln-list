{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "rhacm2/multicluster-operators-subscription-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Security 3",
      "fix_state": "Not affected",
      "package_name": "advanced-cluster-security/rhacs-main-rhel8",
      "cpe": "cpe:/a:redhat:advanced_cluster_security:3"
    },
    {
      "product_name": "Red Hat Advanced Cluster Security 3",
      "fix_state": "Not affected",
      "package_name": "advanced-cluster-security/rhacs-scanner-rhel8",
      "cpe": "cpe:/a:redhat:advanced_cluster_security:3"
    },
    {
      "product_name": "Red Hat OpenShift GitOps",
      "fix_state": "Affected",
      "package_name": "openshift-gitops-1/applicationset-rhel8",
      "cpe": "cpe:/a:redhat:openshift_gitops:1"
    },
    {
      "product_name": "Red Hat OpenShift GitOps",
      "fix_state": "Affected",
      "package_name": "openshift-gitops-1/argocd-rhel8",
      "cpe": "cpe:/a:redhat:openshift_gitops:1"
    },
    {
      "product_name": "Red Hat OpenShift GitOps",
      "fix_state": "Not affected",
      "package_name": "openshift-gitops-1/gitops-rhel8",
      "cpe": "cpe:/a:redhat:openshift_gitops:1"
    },
    {
      "product_name": "Red Hat OpenShift GitOps",
      "fix_state": "Not affected",
      "package_name": "openshift-gitops-1/gitops-rhel8-operator",
      "cpe": "cpe:/a:redhat:openshift_gitops:1"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2022-07-21T00:00:00Z",
  "bugzilla": {
    "description": "ghinstallation:  Leak of bearer JWT from http.RoundTripper response",
    "id": "2155942",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2155942"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.0",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:N/A:L",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-402",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-39304",
  "document_distribution": "",
  "details": [
    "ghinstallation provides transport, which implements http.RoundTripper to provide authentication as an installation for GitHub Apps. In ghinstallation version 1, when the request to refresh an installation token failed, the HTTP request and response would be returned for debugging. The request contained the bearer JWT for the App, and was returned back to clients. This token is short lived (10 minute maximum). This issue has been patched and is available in version 2.0.0.",
    "A flaw was found in ghinstallation. When a request to refresh an installation token fails, the HTTP request and response are returned for debugging. The returned request contains the short-lived (10-min maximum) bearer JWT for the app and is returned back to clients."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-39304\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-39304\nhttps://docs.github.com/en/developers/apps/building-github-apps/authenticating-with-github-apps#authenticating-as-an-installation\nhttps://github.com/bradleyfalzon/ghinstallation/blob/24e56b3fb7669f209134a01eff731d7e2ef72a5c/transport.go#L172-L174\nhttps://github.com/bradleyfalzon/ghinstallation/commit/d24f14f8be70d94129d76026e8b0f4f9170c8c3e\nhttps://github.com/bradleyfalzon/ghinstallation/security/advisories/GHSA-h4q8-96p6-jcgr"
  ]
}