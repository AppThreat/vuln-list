{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "A-MQ Clients 2",
      "fix_state": "Not affected",
      "package_name": "hadoop",
      "cpe": "cpe:/a:redhat:a_mq_clients:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "rhacm2/volsync-mover-rclone-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Data Grid 8",
      "fix_state": "Not affected",
      "package_name": "hadoop",
      "cpe": "cpe:/a:redhat:jboss_data_grid:8"
    },
    {
      "product_name": "Red Hat Integration Camel K",
      "fix_state": "Will not fix",
      "package_name": "hadoop",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat Integration Camel Quarkus",
      "fix_state": "Will not fix",
      "package_name": "hadoop",
      "cpe": "cpe:/a:redhat:camel_quarkus:2"
    },
    {
      "product_name": "Red Hat Integration Data Virtualisation Operator",
      "fix_state": "Out of support scope",
      "package_name": "hadoop",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat JBoss A-MQ 7",
      "fix_state": "Not affected",
      "package_name": "hadoop",
      "cpe": "cpe:/a:redhat:amq_broker:7"
    },
    {
      "product_name": "Red Hat JBoss Data Grid 7",
      "fix_state": "Out of support scope",
      "package_name": "hadoop",
      "cpe": "cpe:/a:redhat:jboss_data_grid:7"
    },
    {
      "product_name": "Red Hat JBoss Data Virtualization 6",
      "fix_state": "Out of support scope",
      "package_name": "hadoop",
      "cpe": "cpe:/a:redhat:jboss_data_virtualization:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 7",
      "fix_state": "Not affected",
      "package_name": "hadoop",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack",
      "fix_state": "Not affected",
      "package_name": "hadoop",
      "cpe": "cpe:/a:redhat:jbosseapxp"
    },
    {
      "product_name": "Red Hat JBoss Fuse 6",
      "fix_state": "Out of support scope",
      "package_name": "hadoop",
      "cpe": "cpe:/a:redhat:jboss_fuse:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Not affected",
      "package_name": "hadoop",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat JBoss Fuse Service Works 6",
      "fix_state": "Out of support scope",
      "package_name": "hadoop",
      "cpe": "cpe:/a:redhat:jboss_fuse_service_works:6"
    },
    {
      "product_name": "Red Hat JBoss Operations Network 3",
      "fix_state": "Out of support scope",
      "package_name": "hadoop",
      "cpe": "cpe:/a:redhat:jboss_operations_network:3"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Affected",
      "package_name": "openshift4/ose-metering-hadoop",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "streams for Apache Kafka",
      "fix_state": "Not affected",
      "package_name": "hadoop",
      "cpe": "cpe:/a:redhat:amq_streams:1"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2022-08-08T00:00:00Z",
  "bugzilla": {
    "description": "hadoop: Command injection in org.apache.hadoop.fs.FileUtil.unTarUsingTar",
    "id": "2119084",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2119084"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "9.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-88",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-25168",
  "document_distribution": "",
  "details": [
    "Apache Hadoop's FileUtil.unTar(File, File) API does not escape the input file name before being passed to the shell. An attacker can inject arbitrary commands. This is only used in Hadoop 3.3 InMemoryAliasMap.completeBootstrapTransfer, which is only ever run by a local user. It has been used in Hadoop 2.x for yarn localization, which does enable remote code execution. It is used in Apache Spark, from the SQL command ADD ARCHIVE. As the ADD ARCHIVE command adds new binaries to the classpath, being able to execute shell scripts does not confer new permissions to the caller. SPARK-38305. \"Check existence of file before untarring/zipping\", which is included in 3.3.0, 3.1.4, 3.2.2, prevents shell commands being executed, regardless of which version of the hadoop libraries are in use. Users should upgrade to Apache Hadoop 2.10.2, 3.2.4, 3.3.3 or upper (including HADOOP-18136).",
    "A flaw was found in the hadoop-common package. This flaw allows an attacker to benefit from command injection using the org.apache.hadoop.fs.FileUtil.unTarUsingTar function."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-25168\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-25168\nhttps://lists.apache.org/thread/mxqnb39jfrwgs3j6phwvlrfq4mlox130"
  ]
}