{
  "mitigation": "Disable the static option which will disable the public_dir option. With this configuration, Sinatra will not serve files from the public directory and therefore files outside of it.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2022-05-18T00:00:00Z",
      "advisory": "RHSA-2022:4661",
      "package": "pcs-0:0.10.12-6.el8_6.1",
      "cpe": "cpe:/a:redhat:enterprise_linux:8::highavailability"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.1 Update Services for SAP Solutions",
      "release_date": "2022-05-16T00:00:00Z",
      "advisory": "RHSA-2022:2255",
      "package": "pcs-0:0.10.2-4.el8_1.2",
      "cpe": "cpe:/a:redhat:rhel_e4s:8.1::highavailability"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
      "release_date": "2022-05-16T00:00:00Z",
      "advisory": "RHSA-2022:2253",
      "package": "pcs-0:0.10.4-6.el8_2.2",
      "cpe": "cpe:/a:redhat:rhel_eus:8.2::highavailability"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Extended Update Support",
      "release_date": "2022-05-16T00:00:00Z",
      "advisory": "RHSA-2022:2256",
      "package": "pcs-0:0.10.8-1.el8_4.1",
      "cpe": "cpe:/a:redhat:rhel_eus:8.4::highavailability"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2022-05-18T00:00:00Z",
      "advisory": "RHSA-2022:4587",
      "package": "pcs-0:0.11.1-10.el9_0.1",
      "cpe": "cpe:/a:redhat:enterprise_linux:9::highavailability"
    },
    {
      "product_name": "Red Hat Satellite 6.12 for RHEL 8",
      "release_date": "2022-11-16T00:00:00Z",
      "advisory": "RHSA-2022:8506",
      "package": "rubygem-sinatra-1:2.2.0-1.el8sat",
      "cpe": "cpe:/a:redhat:satellite:6.12::el8"
    },
    {
      "product_name": "Red Hat Satellite 6.12 for RHEL 8",
      "release_date": "2022-11-16T00:00:00Z",
      "advisory": "RHSA-2022:8506",
      "package": "rubygem-sinatra-1:2.2.0-1.el8sat",
      "cpe": "cpe:/a:redhat:satellite_capsule:6.12::el8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Affected",
      "package_name": "pcs",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Affected",
      "package_name": "tfm-ror51-rubygem-mustermann",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Affected",
      "package_name": "tfm-ror51-rubygem-rack-protection",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Affected",
      "package_name": "tfm-ror51-rubygem-sinatra",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Affected",
      "package_name": "tfm-ror52-rubygem-mustermann",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Affected",
      "package_name": "tfm-ror52-rubygem-rack-protection",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Affected",
      "package_name": "tfm-ror52-rubygem-sinatra",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Affected",
      "package_name": "tfm-rubygem-mustermann",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Affected",
      "package_name": "tfm-rubygem-rack-protection",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Affected",
      "package_name": "tfm-rubygem-sinatra",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Storage 3",
      "fix_state": "Affected",
      "package_name": "rubygem-sinatra",
      "cpe": "cpe:/a:redhat:storage:3"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2022-05-02T00:00:00Z",
  "bugzilla": {
    "description": "sinatra: path traversal possible outside of public_dir when serving static files",
    "id": "2081096",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2081096"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-22",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-29970",
  "document_distribution": "",
  "details": [
    "Sinatra before 2.2.0 does not validate that the expanded path matches public_dir when serving static files.",
    "A flaw was found in Sinatra when serving static files from the public directory. The requested path is not validated if it is in the public directory, allowing files outside of the public directory to be served."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-29970\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-29970"
  ]
}