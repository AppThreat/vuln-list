{
  "mitigation": "Disable gRPC health checking and/or replace it with a different health checking type.",
  "affected_release": [
    {
      "product_name": "OpenShift Service Mesh 2.0",
      "release_date": "2022-06-13T00:00:00Z",
      "advisory": "RHSA-2022:5003",
      "package": "servicemesh-proxy-0:2.0.10-1.el8",
      "cpe": "cpe:/a:redhat:service_mesh:2.0::el8"
    },
    {
      "product_name": "OpenShift Service Mesh 2.1",
      "release_date": "2022-06-13T00:00:00Z",
      "advisory": "RHSA-2022:5004",
      "package": "servicemesh-proxy-0:2.1.3-1.el8",
      "cpe": "cpe:/a:redhat:service_mesh:2.1::el8"
    }
  ],
  "package_state": null,
  "threat_severity": "Moderate",
  "public_date": "2022-06-09T14:00:00Z",
  "bugzilla": {
    "description": "envoy: Segfault in GrpcHealthCheckerImpl",
    "id": "2088738",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2088738"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.9",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-476",
  "statement": "",
  "acknowledgement": "Red Hat would like to thank the Envoy security team for reporting this issue.",
  "name": "CVE-2022-29224",
  "document_distribution": "",
  "details": [
    "Envoy is a cloud-native high-performance proxy. Versions of envoy prior to 1.22.1 are subject to a segmentation fault in the GrpcHealthCheckerImpl. Envoy can perform various types of upstream health checking. One of them uses gRPC. Envoy also has a feature which can “hold” (prevent removal) upstream hosts obtained via service discovery until configured active health checking fails. If an attacker controls an upstream host and also controls service discovery of that host (via DNS, the EDS API, etc.), an attacker can crash Envoy by forcing removal of the host from service discovery, and then failing the gRPC health check request. This will crash Envoy via a null pointer dereference. Users are advised to upgrade to resolve this vulnerability. Users unable to upgrade may disable gRPC health checking and/or replace it with a different health checking type as a mitigation.",
    "A flaw was found in Envoy. This flaw allows an attacker who controls an upstream host and also controls service discovery of that host (via DNS, the EDS API, etc.) to crash Envoy by forcing the removal of the host from service discovery and then failing the gRPC health check request. This issue crashes Envoy via a NULL pointer dereference."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-29224\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-29224\nhttps://github.com/envoyproxy/envoy/security/advisories/GHSA-m4j9-86g3-8f49"
  ]
}