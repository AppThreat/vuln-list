{
  "mitigation": "Prevent users from executing Lua scripts. This can be done using ACL to restrict EVAL and EVALSHA commands.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat 3scale API Management Platform 2",
      "fix_state": "Affected",
      "package_name": "3scale-amp-backend-container",
      "cpe": "cpe:/a:redhat:red_hat_3scale_amp:2"
    },
    {
      "product_name": "Red Hat 3scale API Management Platform 2",
      "fix_state": "Will not fix",
      "package_name": "3scale-amp-system-container",
      "cpe": "cpe:/a:redhat:red_hat_3scale_amp:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "rhacm2/search-api-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 1.2",
      "fix_state": "Not affected",
      "package_name": "ansible-tower",
      "cpe": "cpe:/a:redhat:ansible_automation_platform"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Will not fix",
      "package_name": "redis:6/redis",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Will not fix",
      "package_name": "redis",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "redis-6-container",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Not affected",
      "package_name": "redis",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat OpenStack Platform 16.1",
      "fix_state": "Not affected",
      "package_name": "rhosp-rhel8/openstack-redis",
      "cpe": "cpe:/a:redhat:openstack:16.1"
    },
    {
      "product_name": "Red Hat OpenStack Platform 16.1",
      "fix_state": "Not affected",
      "package_name": "rhosp-rhel8/openstack-redis-base",
      "cpe": "cpe:/a:redhat:openstack:16.1"
    },
    {
      "product_name": "Red Hat OpenStack Platform 16.2",
      "fix_state": "Not affected",
      "package_name": "rhosp-rhel8/openstack-redis",
      "cpe": "cpe:/a:redhat:openstack:16.2"
    },
    {
      "product_name": "Red Hat OpenStack Platform 17.0",
      "fix_state": "Not affected",
      "package_name": "rhosp-rhel9/openstack-redis",
      "cpe": "cpe:/a:redhat:openstack:17.0"
    },
    {
      "product_name": "Red Hat OpenStack Platform 17.1",
      "fix_state": "Not affected",
      "package_name": "rhosp-rhel9/openstack-redis",
      "cpe": "cpe:/a:redhat:openstack:17.1"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Not affected",
      "package_name": "satellite:el8/rubygem-gitlab-sidekiq-fetcher",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Not affected",
      "package_name": "tfm-rubygem-gitlab-sidekiq-fetcher",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Software Collections",
      "fix_state": "Will not fix",
      "package_name": "rh-redis6-redis",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2023-07-10T00:00:00Z",
  "bugzilla": {
    "description": "redis: heap overflow in the lua cjson and cmsgpack libraries",
    "id": "2221662",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2221662"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.0",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-680",
  "statement": "The problem exists in all versions of Redis with Lua scripting support, starting from 2.6, and affects only authenticated and authorized users.",
  "acknowledgement": "",
  "name": "CVE-2022-24834",
  "document_distribution": "",
  "details": [
    "Redis is an in-memory database that persists on disk. A specially crafted Lua script executing in Redis can trigger a heap overflow in the cjson library, and result with heap corruption and potentially remote code execution. The problem exists in all versions of Redis with Lua scripting support, starting from 2.6, and affects only authenticated and authorized users. The problem is fixed in versions 7.0.12, 6.2.13, and 6.0.20.",
    "A heap-based buffer overflow flaw was found in Redis. This flaw allows a local authenticated attacker user or attacker to execute a specially crafted Lua script in Redis. This attack triggers a heap overflow in the cjson and cmsgpack libraries, resulting in heap corruption and potential remote code execution."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-24834\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-24834\nhttps://github.com/redis/redis/security/advisories/GHSA-p8x2-9v9q-c838\nhttps://groups.google.com/g/redis-db/c/JDjKS0GubsQ"
  ]
}