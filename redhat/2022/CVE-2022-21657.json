{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "OpenShift Service Mesh 2",
      "fix_state": "Not affected",
      "package_name": "openshift-service-mesh/proxyv2-rhel8",
      "cpe": "cpe:/a:redhat:service_mesh:2"
    },
    {
      "product_name": "OpenShift Service Mesh 2.0",
      "fix_state": "Will not fix",
      "package_name": "servicemesh-proxy",
      "cpe": "cpe:/a:redhat:service_mesh:2.0"
    },
    {
      "product_name": "OpenShift Service Mesh 2.1",
      "fix_state": "Will not fix",
      "package_name": "servicemesh-proxy",
      "cpe": "cpe:/a:redhat:service_mesh:2.1"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2022-02-23T00:00:00Z",
  "bugzilla": {
    "description": "envoy: X.509 Extended Key Usage and Trust Purposes bypass",
    "id": "2057272",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2057272"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-295",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-21657",
  "document_distribution": "",
  "details": [
    "Envoy is an open source edge and service proxy, designed for cloud-native applications. In affected versions Envoy does not restrict the set of certificates it accepts from the peer, either as a TLS client or a TLS server, to only those certificates that contain the necessary extendedKeyUsage (id-kp-serverAuth and id-kp-clientAuth, respectively). This means that a peer may present an e-mail certificate (e.g. id-kp-emailProtection), either as a leaf certificate or as a CA in the chain, and it will be accepted for TLS. This is particularly bad when combined with the issue described in pull request #630, in that it allows a Web PKI CA that is intended only for use with S/MIME, and thus exempted from audit or supervision, to issue TLS certificates that will be accepted by Envoy. As a result Envoy will trust upstream certificates that should not be trusted. There are no known workarounds to this issue. Users are advised to upgrade.",
    "A flaw was found in envoy. This issue occurs when it does not restrict the set of certificates it accepts from the peer, either as a TLS client or a TLS server, and only to those certificates that contain the necessary extendedKeyUsage (id-kp-serverAuth and id-kp-clientAuth, respectively)."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-21657\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-21657\nhttps://github.com/envoyproxy/envoy/pull/630\nhttps://github.com/envoyproxy/envoy/security/advisories/GHSA-837m-wjrv-vm5g"
  ]
}