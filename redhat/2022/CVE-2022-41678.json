{
  "affected_release": [
    {
      "product_name": "Red Hat Fuse 7.13.0",
      "release_date": "2024-05-23T00:00:00Z",
      "advisory": "RHSA-2024:3354",
      "package": "activemq",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat JBoss A-MQ 7",
      "release_date": "2024-05-21T00:00:00Z",
      "advisory": "RHSA-2024:2945",
      "package": "",
      "cpe": "cpe:/a:redhat:amq_broker:7.12"
    },
    {
      "product_name": "RHEL-8 based Middleware Containers",
      "release_date": "2024-05-21T00:00:00Z",
      "advisory": "RHSA-2024:2944",
      "package": "amq7/amq-broker-init-rhel8:7.12.0-7",
      "cpe": "cpe:/a:redhat:rhosemc:1.0::el8"
    },
    {
      "product_name": "RHEL-8 based Middleware Containers",
      "release_date": "2024-05-21T00:00:00Z",
      "advisory": "RHSA-2024:2944",
      "package": "amq7/amq-broker-rhel8:7.12.0-7",
      "cpe": "cpe:/a:redhat:rhosemc:1.0::el8"
    },
    {
      "product_name": "RHEL-8 based Middleware Containers",
      "release_date": "2024-05-21T00:00:00Z",
      "advisory": "RHSA-2024:2944",
      "package": "amq7/amq-broker-rhel8-operator-bundle:7.12.0-10",
      "cpe": "cpe:/a:redhat:rhosemc:1.0::el8"
    }
  ],
  "package_state": [
    {
      "product_name": "A-MQ Clients 2",
      "fix_state": "Not affected",
      "package_name": "activemq",
      "cpe": "cpe:/a:redhat:a_mq_clients:2"
    },
    {
      "product_name": "Red Hat build of Apache Camel 4.0 for Spring Boot",
      "fix_state": "Affected",
      "package_name": "activemq",
      "cpe": "cpe:/a:redhat:camel_spring_boot:4"
    },
    {
      "product_name": "Red Hat build of OptaPlanner 8",
      "fix_state": "Not affected",
      "package_name": "activemq",
      "cpe": "cpe:/a:redhat:optaplanner:::el6"
    },
    {
      "product_name": "Red Hat Data Grid 8",
      "fix_state": "Not affected",
      "package_name": "activemq",
      "cpe": "cpe:/a:redhat:jboss_data_grid:8"
    },
    {
      "product_name": "Red Hat Integration Camel K",
      "fix_state": "Not affected",
      "package_name": "activemq",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat JBoss Data Grid 7",
      "fix_state": "Out of support scope",
      "package_name": "activemq",
      "cpe": "cpe:/a:redhat:jboss_data_grid:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 7",
      "fix_state": "Will not fix",
      "package_name": "activemq",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 8",
      "fix_state": "Will not fix",
      "package_name": "activemq",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:8"
    },
    {
      "product_name": "Red Hat JBoss Fuse 6",
      "fix_state": "Out of support scope",
      "package_name": "activemq",
      "cpe": "cpe:/a:redhat:jboss_fuse:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse Service Works 6",
      "fix_state": "Out of support scope",
      "package_name": "activemq",
      "cpe": "cpe:/a:redhat:jboss_fuse_service_works:6"
    },
    {
      "product_name": "Red Hat Process Automation 7",
      "fix_state": "Out of support scope",
      "package_name": "activemq",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7"
    },
    {
      "product_name": "Red Hat Single Sign-On 7",
      "fix_state": "Not affected",
      "package_name": "activemq",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2023-11-28T00:00:00Z",
  "bugzilla": {
    "description": "Apache ActiveMQ: Deserialization vulnerability on Jolokia that allows authenticated users to perform RCE",
    "id": "2252185",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2252185"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-502",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-41678",
  "document_distribution": "",
  "details": [
    "Once an user is authenticated on Jolokia, he can potentially trigger arbitrary code execution.Â \nIn details, in ActiveMQ configurations, jetty allows\norg.jolokia.http.AgentServlet to handler request to /api/jolokia\norg.jolokia.http.HttpRequestHandler#handlePostRequest is able to\ncreate JmxRequest through JSONObject. And calls to\norg.jolokia.http.HttpRequestHandler#executeRequest.\nInto deeper calling stacks,\norg.jolokia.handler.ExecHandler#doHandleRequest can be invoked\nthrough refection. This could lead to RCE through via\nvarious mbeans. One example is unrestricted deserialization in jdk.management.jfr.FlightRecorderMXBeanImpl which exists on Java version above 11.\n1 Call newRecording.\n2 Call setConfiguration. And a webshell data hides in it.\n3 Call startRecording.\n4 Call copyTo method. The webshell will be written to a .jsp file.\nThe mitigation is to restrict (by default) the actions authorized on Jolokia, or disable Jolokia.\nA more restrictive Jolokia configuration has been defined in default ActiveMQ distribution. We encourage users to upgrade to ActiveMQ distributions version including updated Jolokia configuration: 5.16.6, 5.17.4, 5.18.0, 6.0.0."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-41678\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-41678"
  ]
}