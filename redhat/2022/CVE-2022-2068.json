{
  "mitigation": "As mentioned in the upstream security advisory, use of the c_rehash script is considered obsolete and should be replaced by the OpenSSL rehash command-line tool.",
  "affected_release": [
    {
      "product_name": "JBoss Core Services for RHEL 8",
      "release_date": "2022-12-08T00:00:00Z",
      "advisory": "RHSA-2022:8840",
      "package": "jbcs-httpd24-openssl-1:1.1.1k-13.el8jbcs",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el8"
    },
    {
      "product_name": "JBoss Core Services on RHEL 7",
      "release_date": "2022-12-08T00:00:00Z",
      "advisory": "RHSA-2022:8840",
      "package": "jbcs-httpd24-openssl-1:1.1.1k-13.el7jbcs",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el7"
    },
    {
      "product_name": "JWS 5.7.1 release",
      "release_date": "2022-12-12T00:00:00Z",
      "advisory": "RHSA-2022:8913",
      "package": "openssl",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2022-08-03T00:00:00Z",
      "advisory": "RHSA-2022:5818",
      "package": "openssl-1:1.1.1k-7.el8_6",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2022-08-30T00:00:00Z",
      "advisory": "RHSA-2022:6224",
      "package": "openssl-1:3.0.1-41.el9_0",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2022-08-30T00:00:00Z",
      "advisory": "RHSA-2022:6224",
      "package": "openssl-1:3.0.1-41.el9_0",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat JBoss Core Services 1",
      "release_date": "2022-12-08T00:00:00Z",
      "advisory": "RHSA-2022:8841",
      "package": "openssl",
      "cpe": "cpe:/a:redhat:jboss_core_services:1"
    },
    {
      "product_name": "Red Hat JBoss Web Server 5.7 on RHEL 7",
      "release_date": "2022-12-12T00:00:00Z",
      "advisory": "RHSA-2022:8917",
      "package": "jws5-tomcat-native-0:1.2.31-11.redhat_11.el7jws",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5.7::el7"
    },
    {
      "product_name": "Red Hat JBoss Web Server 5.7 on RHEL 8",
      "release_date": "2022-12-12T00:00:00Z",
      "advisory": "RHSA-2022:8917",
      "package": "jws5-tomcat-native-0:1.2.31-11.redhat_11.el8jws",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5.7::el8"
    },
    {
      "product_name": "Red Hat JBoss Web Server 5.7 on RHEL 9",
      "release_date": "2022-12-12T00:00:00Z",
      "advisory": "RHSA-2022:8917",
      "package": "jws5-tomcat-native-0:1.2.31-11.redhat_11.el9jws",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5.7::el9"
    },
    {
      "product_name": "Red Hat Satellite 6.11 for RHEL 7",
      "release_date": "2023-10-20T00:00:00Z",
      "advisory": "RHSA-2023:5980",
      "package": "puppet-agent-0:7.26.0-3.el7sat",
      "cpe": "cpe:/a:redhat:satellite:6.11::el7"
    },
    {
      "product_name": "Red Hat Satellite 6.11 for RHEL 7",
      "release_date": "2023-10-20T00:00:00Z",
      "advisory": "RHSA-2023:5980",
      "package": "puppet-agent-0:7.26.0-3.el7sat",
      "cpe": "cpe:/a:redhat:satellite_capsule:6.11::el7"
    },
    {
      "product_name": "Red Hat Satellite 6.11 for RHEL 8",
      "release_date": "2023-10-20T00:00:00Z",
      "advisory": "RHSA-2023:5980",
      "package": "puppet-agent-0:7.26.0-3.el8sat",
      "cpe": "cpe:/a:redhat:satellite:6.11::el8"
    },
    {
      "product_name": "Red Hat Satellite 6.11 for RHEL 8",
      "release_date": "2023-10-20T00:00:00Z",
      "advisory": "RHSA-2023:5980",
      "package": "puppet-agent-0:7.26.0-3.el8sat",
      "cpe": "cpe:/a:redhat:satellite_capsule:6.11::el8"
    },
    {
      "product_name": "Red Hat Satellite 6.12 for RHEL 8",
      "release_date": "2023-10-20T00:00:00Z",
      "advisory": "RHSA-2023:5979",
      "package": "puppet-agent-0:7.26.0-3.el8sat",
      "cpe": "cpe:/a:redhat:satellite:6.12::el8"
    },
    {
      "product_name": "Red Hat Satellite 6.12 for RHEL 8",
      "release_date": "2023-10-20T00:00:00Z",
      "advisory": "RHSA-2023:5979",
      "package": "puppet-agent-0:7.26.0-3.el8sat",
      "cpe": "cpe:/a:redhat:satellite_capsule:6.12::el8"
    },
    {
      "product_name": "Red Hat Satellite 6.13 for RHEL 8",
      "release_date": "2023-10-19T00:00:00Z",
      "advisory": "RHSA-2023:5931",
      "package": "puppet-agent-0:7.26.0-3.el8sat",
      "cpe": "cpe:/a:redhat:satellite:6.13::el8"
    },
    {
      "product_name": "Red Hat Satellite 6.13 for RHEL 8",
      "release_date": "2023-10-19T00:00:00Z",
      "advisory": "RHSA-2023:5931",
      "package": "puppet-agent-0:7.26.0-3.el8sat",
      "cpe": "cpe:/a:redhat:satellite_capsule:6.13::el8"
    },
    {
      "product_name": "Red Hat Satellite 6.14 for RHEL 8",
      "release_date": "2023-11-08T00:00:00Z",
      "advisory": "RHSA-2023:6818",
      "package": "puppet-agent-0:7.26.0-3.el8sat",
      "cpe": "cpe:/a:redhat:satellite:6.14::el8"
    },
    {
      "product_name": "Red Hat Satellite 6.14 for RHEL 8",
      "release_date": "2023-11-08T00:00:00Z",
      "advisory": "RHSA-2023:6818",
      "package": "puppet-agent-0:7.26.0-3.el8sat",
      "cpe": "cpe:/a:redhat:satellite_capsule:6.14::el8"
    },
    {
      "product_name": "Satellite Client 6 for RHEL 6",
      "release_date": "2023-10-20T00:00:00Z",
      "advisory": "RHSA-2023:5982",
      "package": "puppet-agent-0:7.26.0-3.el6sat",
      "cpe": "cpe:/a:redhat:rhel_satellite_client:6::el6"
    },
    {
      "product_name": "Satellite Client 6 for RHEL 7",
      "release_date": "2023-10-20T00:00:00Z",
      "advisory": "RHSA-2023:5982",
      "package": "puppet-agent-0:7.26.0-3.el7sat",
      "cpe": "cpe:/a:redhat:rhel_satellite_client:6::el7"
    },
    {
      "product_name": "Satellite Client 6 for RHEL 8",
      "release_date": "2023-10-20T00:00:00Z",
      "advisory": "RHSA-2023:5982",
      "package": "puppet-agent-0:7.26.0-3.el8sat",
      "cpe": "cpe:/a:redhat:rhel_satellite_client:6::el8"
    },
    {
      "product_name": "Satellite Client 6 for RHEL 9",
      "release_date": "2023-10-20T00:00:00Z",
      "advisory": "RHSA-2023:5982",
      "package": "puppet-agent-0:7.26.0-3.el9sat",
      "cpe": "cpe:/a:redhat:rhel_satellite_client:6::el9"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Affected",
      "package_name": "rhacm2/management-ingress-rhel7",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "openssl",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "openssl098e",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "openssl",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "openssl098e",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "ovmf",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "compat-openssl10",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "edk2",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "shim",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Out of support scope",
      "package_name": "compat-openssl11",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "edk2",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "shim",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Out of support scope",
      "package_name": "openssl",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Web Server 3",
      "fix_state": "Out of support scope",
      "package_name": "openssl",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:3"
    },
    {
      "product_name": "Red Hat Virtualization 4",
      "fix_state": "Fix deferred",
      "package_name": "redhat-virtualization-host",
      "cpe": "cpe:/o:redhat:rhev_hypervisor:4"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2022-06-21T00:00:00Z",
  "bugzilla": {
    "description": "openssl: the c_rehash script allows command injection",
    "id": "2097310",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2097310"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.7",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-77",
  "statement": "Red Hat Enterprise Linux uses a system-wide store of trusted certificates bundled in a single file and updated via `update-ca-trust`. The `c_rehash` script is not included in the default installation on any supported RHEL version and is never executed automatically. For these reasons, this flaw has been rated as having a security impact of Moderate.\nRed Hat Enterprise Linux 7 provides a vulnerable version of the `c_rehash` script in the `openssl-perl` package, available only through the unsupported Optional repository.  As the Optional repository is not supported and Red Hat Enterprise Linux 7 is in Maintenance Support 2 Phase, this issue is not planned to be addressed there.\nRed Hat Satellite ships an affected version of the `c_rehash` script embedded in `puppet-agent` package, however, the product is not vulnerable since it does not execute scripts with untrusted data. Moreover, the scriplet is owned by root user and is supposed to be accessed only by administrators.\nRed Hat updates the OpenSSL compatibility packages (compat-openssl) to only address Important or Critical security issues with backported security patches.",
  "acknowledgement": "Upstream acknowledges Chancen (Qingteng 73lab) as the original reporter.",
  "name": "CVE-2022-2068",
  "document_distribution": "",
  "details": [
    "In addition to the c_rehash shell command injection identified in CVE-2022-1292, further circumstances where the c_rehash script does not properly sanitise shell metacharacters to prevent command injection were found by code review. When the CVE-2022-1292 was fixed it was not discovered that there are other places in the script where the file names of certificates being hashed were possibly passed to a command executed through the shell. This script is distributed by some operating systems in a manner where it is automatically executed. On such operating systems, an attacker could execute arbitrary commands with the privileges of the script. Use of the c_rehash script is considered obsolete and should be replaced by the OpenSSL rehash command line tool. Fixed in OpenSSL 3.0.4 (Affected 3.0.0,3.0.1,3.0.2,3.0.3). Fixed in OpenSSL 1.1.1p (Affected 1.1.1-1.1.1o). Fixed in OpenSSL 1.0.2zf (Affected 1.0.2-1.0.2ze).",
    "A flaw was found in OpenSSL. The issue in CVE-2022-1292 did not find other places in the `c_rehash` script where it possibly passed the file names of certificates being hashed to a command executed through the shell. Some operating systems distribute this script in a manner where it is automatically executed. On these operating systems, this flaw allows an attacker to execute arbitrary commands with the privileges of the script."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-2068\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-2068\nhttps://www.openssl.org/news/secadv/20220621.txt"
  ]
}