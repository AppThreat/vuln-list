{
  "mitigation": "For customers who cannot update immediately and doesn't have Secure Boot feature enabled, the issue can be mitigated by executing the following steps:\n1)    Install required systemtap packages and dependencies as per - pointed by https://access.redhat.com/solutions/5441\n2)    Install polkit debug info:\n~~~\ndebuginfo-install polkit\n~~~\n3)    Create the following systemtap script, and name it pkexec-block.stp:\n~~~\nprobe process(\"/usr/bin/pkexec\").function(\"main\")  {\nif (cmdline_arg(1) == \"\")\nraise(9);\n}\n~~~\n4) Load the systemtap module into the running kernel:\n~~~\nstap -g -F -m stap_pkexec_block pkexec_block.stp\n~~~\n5) Ensure the module is loaded:\n~~~\nlsmod | grep -i stap_pkexec_block\nstap_pkexec_block     434176  0\n~~~\n6) Once polkit package was updated to the version containing the fix, the systemtap generated kernel module can be removed by running:\n~~~\nrmmod stap_pkexec_block\n~~~\nThis mitigation doesn't work for Secure Boot enabled system as SystemTap would require an external compiling server to be able to sign the generated kernel module\nwith a key enrolled into the Kernel's keyring.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 6 Extended Lifecycle Support",
      "release_date": "2022-01-25T00:00:00Z",
      "advisory": "RHSA-2022:0269",
      "package": "polkit-0:0.96-11.el6_10.2",
      "cpe": "cpe:/o:redhat:rhel_els:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2022-01-25T00:00:00Z",
      "advisory": "RHSA-2022:0274",
      "package": "polkit-0:0.112-26.el7_9.1",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.3 Advanced Update Support",
      "release_date": "2022-01-25T00:00:00Z",
      "advisory": "RHSA-2022:0270",
      "package": "polkit-0:0.112-12.el7_3.1",
      "cpe": "cpe:/o:redhat:rhel_aus:7.3"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.4 Advanced Update Support",
      "release_date": "2022-01-25T00:00:00Z",
      "advisory": "RHSA-2022:0272",
      "package": "polkit-0:0.112-12.el7_4.2",
      "cpe": "cpe:/o:redhat:rhel_aus:7.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.6 Advanced Update Support",
      "release_date": "2022-01-25T00:00:00Z",
      "advisory": "RHSA-2022:0271",
      "package": "polkit-0:0.112-18.el7_6.3",
      "cpe": "cpe:/o:redhat:rhel_aus:7.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.6 Telco Extended Update Support",
      "release_date": "2022-01-25T00:00:00Z",
      "advisory": "RHSA-2022:0271",
      "package": "polkit-0:0.112-18.el7_6.3",
      "cpe": "cpe:/o:redhat:rhel_tus:7.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.6 Update Services for SAP Solutions",
      "release_date": "2022-01-25T00:00:00Z",
      "advisory": "RHSA-2022:0271",
      "package": "polkit-0:0.112-18.el7_6.3",
      "cpe": "cpe:/o:redhat:rhel_e4s:7.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.7 Advanced Update Support",
      "release_date": "2022-01-25T00:00:00Z",
      "advisory": "RHSA-2022:0273",
      "package": "polkit-0:0.112-22.el7_7.2",
      "cpe": "cpe:/o:redhat:rhel_aus:7.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.7 Telco Extended Update Support",
      "release_date": "2022-01-25T00:00:00Z",
      "advisory": "RHSA-2022:0273",
      "package": "polkit-0:0.112-22.el7_7.2",
      "cpe": "cpe:/o:redhat:rhel_tus:7.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.7 Update Services for SAP Solutions",
      "release_date": "2022-01-25T00:00:00Z",
      "advisory": "RHSA-2022:0273",
      "package": "polkit-0:0.112-22.el7_7.2",
      "cpe": "cpe:/o:redhat:rhel_e4s:7.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2022-01-25T00:00:00Z",
      "advisory": "RHSA-2022:0267",
      "package": "polkit-0:0.115-13.el8_5.1",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.1 Update Services for SAP Solutions",
      "release_date": "2022-01-25T00:00:00Z",
      "advisory": "RHSA-2022:0268",
      "package": "polkit-0:0.115-9.el8_1.2",
      "cpe": "cpe:/o:redhat:rhel_e4s:8.1"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
      "release_date": "2022-01-25T00:00:00Z",
      "advisory": "RHSA-2022:0265",
      "package": "polkit-0:0.115-11.el8_2.2",
      "cpe": "cpe:/o:redhat:rhel_eus:8.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Extended Update Support",
      "release_date": "2022-01-25T00:00:00Z",
      "advisory": "RHSA-2022:0266",
      "package": "polkit-0:0.115-11.el8_4.2",
      "cpe": "cpe:/o:redhat:rhel_eus:8.4"
    },
    {
      "product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 7",
      "release_date": "2022-02-07T00:00:00Z",
      "advisory": "RHSA-2022:0443",
      "package": "redhat-virtualization-host-0:4.3.21-20220126.0.el7_9",
      "cpe": "cpe:/o:redhat:enterprise_linux:7::hypervisor"
    },
    {
      "product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 8",
      "release_date": "2022-02-15T00:00:00Z",
      "advisory": "RHSA-2022:0540",
      "package": "redhat-virtualization-host-0:4.4.10-202202081536_8.5",
      "cpe": "cpe:/o:redhat:enterprise_linux:8::hypervisor"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "polkit",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2022-01-25T17:00:00Z",
  "bugzilla": {
    "description": "polkit: Local privilege escalation in pkexec due to incorrect handling of argument vector",
    "id": "2025869",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2025869"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "(CWE-125|CWE-787)-\u003eCWE-20",
  "statement": "",
  "acknowledgement": "Red Hat would like to thank Qualys Research Labs for reporting this issue.",
  "name": "CVE-2021-4034",
  "document_distribution": "",
  "details": [
    "A local privilege escalation vulnerability was found on polkit's pkexec utility. The pkexec application is a setuid tool designed to allow unprivileged users to run commands as privileged users according predefined policies. The current version of pkexec doesn't handle the calling parameters count correctly and ends trying to execute environment variables as commands. An attacker can leverage this by crafting environment variables in such a way it'll induce pkexec to execute arbitrary code. When successfully executed the attack can cause a local privilege escalation given unprivileged users administrative rights on the target machine."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-4034\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-4034\nhttps://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt"
  ]
}