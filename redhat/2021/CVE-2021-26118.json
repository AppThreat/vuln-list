{
  "mitigation": "If you are not using the openwire protocol, it can be disabled by removing it from the list of accepted protocols in the `broker.xml`\n```xml\n\u003cacceptor name=\"artemis\"\u003etcp://0.0.0.0:61616?tcpSendBufferSize=1048576;tcpReceiveBufferSize=1048576;amqpMinLargeMessageSize=102400;protocols=CORE,AMQP,STOMP,HORNETQ,MQTT;useEpoll=true;amqpCredits=1000;amqpLowCredits=300;amqpDuplicateDetection=true\u003c/acceptor\u003e\n```",
  "affected_release": [
    {
      "product_name": "Red Hat AMQ",
      "release_date": "2020-12-08T00:00:00Z",
      "advisory": "RHSA-2020:5365",
      "package": "",
      "cpe": "cpe:/a:redhat:amq_broker:7"
    },
    {
      "product_name": "Red Hat AMQ 7.8.1",
      "release_date": "2021-02-04T00:00:00Z",
      "advisory": "RHSA-2021:0417",
      "package": "",
      "cpe": "cpe:/a:redhat:amq_broker:7"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat JBoss A-MQ 7",
      "fix_state": "Affected",
      "package_name": "broker",
      "cpe": "cpe:/a:redhat:amq_broker:7"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2020-10-28T12:25:00Z",
  "bugzilla": {
    "description": "AMQ Broker 7: OpenWire can create destinations with an unpriviledged user",
    "id": "1892384",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1892384"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-285",
  "statement": "",
  "acknowledgement": "This issue was discovered by Francesco Marchioni (Red Hat).",
  "name": "CVE-2021-26118",
  "document_distribution": "",
  "details": [
    "While investigating ARTEMIS-2964 it was found that the creation of advisory messages in the OpenWire protocol head of Apache ActiveMQ Artemis 2.15.0 bypassed policy based access control for the entire session. Production of advisory messages was not subject to access control in error.",
    "A flaw was found in AMQ 7 broker, where it allows users using the OpenWire protocol to bypass the usual permissions checks. This flaw allows an unprivileged user to create queues without verifying the role. The highest threat from this vulnerability is to integrity."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-26118\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-26118"
  ]
}