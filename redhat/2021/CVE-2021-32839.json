{
  "mitigation": "As mitigation, don't use the sqlformat.format function with keyword strip_comments=True or the --strip-comments command line flag when using the sqlformat command line tool.",
  "affected_release": [
    {
      "product_name": "Red Hat Satellite 6.11 for RHEL 8",
      "release_date": "2022-07-05T00:00:00Z",
      "advisory": "RHSA-2022:5498",
      "package": "python-sqlparse-0:0.4.2-2.el8pc",
      "cpe": "cpe:/a:redhat:satellite:6.11::el8"
    },
    {
      "product_name": "Red Hat Satellite 6.11 for RHEL 8",
      "release_date": "2022-07-05T00:00:00Z",
      "advisory": "RHSA-2022:5498",
      "package": "python-sqlparse-0:0.4.2-2.el8pc",
      "cpe": "cpe:/a:redhat:satellite_capsule:6.11::el8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Ansible Automation Platform 1.2",
      "fix_state": "Affected",
      "package_name": "python-sqlparse",
      "cpe": "cpe:/a:redhat:ansible_automation_platform"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 1.2",
      "fix_state": "Affected",
      "package_name": "sqlparse",
      "cpe": "cpe:/a:redhat:ansible_automation_platform"
    },
    {
      "product_name": "Red Hat Ansible Tower 3",
      "fix_state": "Out of support scope",
      "package_name": "sqlparse",
      "cpe": "cpe:/a:redhat:ansible_tower:3"
    },
    {
      "product_name": "Red Hat OpenStack Platform 10 (Newton)",
      "fix_state": "Out of support scope",
      "package_name": "python-sqlparse",
      "cpe": "cpe:/a:redhat:openstack:10"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13 (Queens)",
      "fix_state": "Out of support scope",
      "package_name": "python-sqlparse",
      "cpe": "cpe:/a:redhat:openstack:13"
    },
    {
      "product_name": "Red Hat OpenStack Platform 16.1",
      "fix_state": "Not affected",
      "package_name": "python-sqlparse",
      "cpe": "cpe:/a:redhat:openstack:16.1"
    },
    {
      "product_name": "Red Hat OpenStack Platform 16.2",
      "fix_state": "Not affected",
      "package_name": "python-sqlparse",
      "cpe": "cpe:/a:redhat:openstack:16.2"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2021-09-10T00:00:00Z",
  "bugzilla": {
    "description": "python-sqlparse: ReDoS via regular expression in StripComments filter",
    "id": "2005072",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2005072"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-400",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2021-32839",
  "document_distribution": "",
  "details": [
    "sqlparse is a non-validating SQL parser module for Python. In sqlparse versions 0.4.0 and 0.4.1 there is a regular Expression Denial of Service in sqlparse vulnerability. The regular expression may cause exponential backtracking on strings containing many repetitions of '\\r\\n' in SQL comments. Only the formatting feature that removes comments from SQL statements is affected by this regular expression. As a workaround don't use the sqlformat.format function with keyword strip_comments=True or the --strip-comments command line flag when using the sqlformat command line tool. The issues has been fixed in sqlparse 0.4.2.",
    "A resource-consumption flaw was found in python-sqlparse. The formatter function that strips comments from SQL contains a regular expression that is vulnerable to Regular Expression Denial of Service (ReDoS). A network attacker could craft an SQL comment containing numerous repetitions of '\\r\\n' that could cause exponential backtracking and cause the system to hang."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-32839\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-32839"
  ]
}