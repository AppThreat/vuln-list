{
  "mitigation": "Do not enable SMB1 (please note SMB1 is disabled by default in Samba from version 4.11.0 and onwards). This prevents the creation or querying of symbolic links via SMB1. If SMB1 must be enabled for backwards compatibility then add the parameter:\n```\nunix extensions = no\n```\nto the [global] section of your smb.conf and restart smbd. This prevents SMB1 clients from creating or reading symlinks on the exported file system.\nHowever, if the same region of the file system is also exported allowing write access via NFS, NFS clients can create symlinks that allow SMB1 with unix extensions clients to discover the existance of the NFS created symlink targets.  For non-patched versions of Samba we recommend only exporting areas of the file system by either SMB2 or NFS, not both.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2022-05-10T00:00:00Z",
      "advisory": "RHSA-2022:2074",
      "package": "samba-0:4.15.5-5.el8",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2022-05-10T00:00:00Z",
      "advisory": "RHSA-2022:2074",
      "package": "samba-0:4.15.5-5.el8",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.5 for RHEL 8",
      "release_date": "2022-05-10T00:00:00Z",
      "advisory": "RHSA-2022:1756",
      "package": "samba-0:4.15.5-100.el8rhgs",
      "cpe": "cpe:/a:redhat:storage:3.5:samba:el8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "samba4",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2022-01-31T00:00:00Z",
  "bugzilla": {
    "description": "samba: Information leak via symlinks of existance of files or directories outside of the exported share",
    "id": "2046120",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2046120"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-59",
  "statement": "",
  "acknowledgement": "Red Hat would like to thank Stefan Behrens for reporting this issue. Upstream acknowledges the Samba project as the original reporter.",
  "name": "CVE-2021-44141",
  "document_distribution": "",
  "details": [
    "All versions of Samba prior to 4.15.5 are vulnerable to a malicious client using a server symlink to determine if a file or directory exists in an area of the server file system not exported under the share definition. SMB1 with unix extensions has to be enabled in order for this attack to succeed.",
    "A vulnerability was found in Samba due to an insecure link following. By querying a symlink inside the exported share using SMB1 with unix extensions turned on, an attacker can discover if a named or directory exists on the filesystem outside the exported share. This flaw allows a remote authenticated attacker to obtain sensitive information."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-44141\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-44141\nhttps://www.samba.org/samba/security/CVE-2021-44141.html"
  ]
}