{
  "affected_release": [
    {
      "product_name": "Advanced Virtualization for RHEL 8.4.0.EUS",
      "release_date": "2022-06-13T00:00:00Z",
      "advisory": "RHSA-2022:5002",
      "package": "virt:av-8040020220517095834.522a0ee4",
      "cpe": "cpe:/a:redhat:advanced_virtualization:8.4::el8"
    },
    {
      "product_name": "Advanced Virtualization for RHEL 8.4.0.EUS",
      "release_date": "2022-06-13T00:00:00Z",
      "advisory": "RHSA-2022:5002",
      "package": "virt-devel:av-8040020220517095834.522a0ee4",
      "cpe": "cpe:/a:redhat:advanced_virtualization:8.4::el8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2022-08-02T00:00:00Z",
      "advisory": "RHSA-2022:5821",
      "package": "virt-devel:rhel-8060020220616155742.ad008a3a",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2022-08-02T00:00:00Z",
      "advisory": "RHSA-2022:5821",
      "package": "virt:rhel-8060020220616155742.ad008a3a",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "qemu-kvm",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "qemu-kvm",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "qemu-kvm-ma",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8 Advanced Virtualization",
      "fix_state": "Will not fix",
      "package_name": "virt:8.2/qemu-kvm",
      "cpe": "cpe:/a:redhat:advanced_virtualization:8::el8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8 Advanced Virtualization",
      "fix_state": "Affected",
      "package_name": "virt:av/qemu-kvm",
      "cpe": "cpe:/a:redhat:advanced_virtualization:8::el8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "qemu-kvm",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat OpenStack Platform 10 (Newton)",
      "fix_state": "Out of support scope",
      "package_name": "qemu-kvm-rhev",
      "cpe": "cpe:/a:redhat:openstack:10"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13 (Queens)",
      "fix_state": "Out of support scope",
      "package_name": "qemu-kvm-rhev",
      "cpe": "cpe:/a:redhat:openstack:13"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2022-03-28T00:00:00Z",
  "bugzilla": {
    "description": "QEMU: QXL: double fetch in qxl_cursor() can lead to heap buffer overflow",
    "id": "2036966",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2036966"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-362-\u003eCWE-120",
  "statement": "Releases of Red Hat OpenStack Platform 15 and newer consume fixes directly from the Red Hat Enterprise Linux 8 Advanced Virtualization repository. A future update may address this issue in Red Hat Enterprise Linux 8 and RHEL 8 Advanced Virtualization. The versions of `qemu-kvm` as shipped with Red Hat Enterprise Linux 9 are not affected by this flaw as they do not include support for QXL display device emulation.",
  "acknowledgement": "Red Hat would like to thank Billy Jheng Bing Jhong (STAR Labs) for reporting this issue.",
  "name": "CVE-2021-4207",
  "document_distribution": "",
  "details": [
    "A flaw was found in the QXL display device emulation in QEMU. A double fetch of guest controlled values `cursor-\u003eheader.width` and `cursor-\u003eheader.height` can lead to the allocation of a small cursor object followed by a subsequent heap-based buffer overflow. A malicious privileged guest user could use this flaw to crash the QEMU process on the host or potentially execute arbitrary code within the context of the QEMU process.",
    "A flaw was found in the QXL display device emulation in QEMU. A double fetch of guest controlled values `cursor-\u003eheader.width` and `cursor-\u003eheader.height` can lead to the allocation of a small cursor object followed by a subsequent heap-based buffer overflow. A malicious privileged guest user could use this flaw to crash the QEMU process on the host or potentially execute arbitrary code within the context of the QEMU process."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-4207\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-4207\nhttps://starlabs.sg/advisories/21/21-4207/"
  ]
}