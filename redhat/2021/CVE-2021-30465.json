{
  "mitigation": "The impact of the vulnerability is reduced if SELinux is in enforcing mode using the container-selinux policy. The container-selinux policy is installed and enabled by default on RHEL 7 and 8, as well as OpenShift Container Platform 3.x and 4.x.\nCustomers running affected versions of RHEL are strongly recommended to apply RPM updates from the RHEL 8 channel and RHEL 7 Extras channel as soon as errata becomes available.  \nCustomers running affected versions of OpenShift Container Platform are strongly recommended to upgrade as soon as errata becomes available.\nCustomers of OpenShift Online or OpenShift Dedicated have SELinux enabled in enforcing mode in every host across all clusters. Therefore, It is expected that OSO/OSD both have a reduced impact from this issue, with security patches made available during upcoming maintenance windows.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 7 Extras",
      "release_date": "2021-05-31T00:00:00Z",
      "advisory": "RHSA-2021:2144",
      "package": "docker-2:1.13.1-206.git7d71120.el7_9",
      "cpe": "cpe:/a:redhat:rhel_extras_other:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7 Extras",
      "release_date": "2021-05-31T00:00:00Z",
      "advisory": "RHSA-2021:2145",
      "package": "runc-0:1.0.0-69.rc10.el7_9",
      "cpe": "cpe:/a:redhat:rhel_extras_other:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-06-08T00:00:00Z",
      "advisory": "RHSA-2021:2291",
      "package": "container-tools:2.0-8040020210519150700.c0c392d5",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-06-10T00:00:00Z",
      "advisory": "RHSA-2021:2370",
      "package": "container-tools:3.0-8040020210608070614.c0c392d5",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-06-10T00:00:00Z",
      "advisory": "RHSA-2021:2371",
      "package": "container-tools:rhel8-8040020210608072148.c0c392d5",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
      "release_date": "2021-06-08T00:00:00Z",
      "advisory": "RHSA-2021:2292",
      "package": "container-tools:2.0-8020020210525070123.28c38760",
      "cpe": "cpe:/a:redhat:rhel_eus:8.2"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "release_date": "2021-06-09T00:00:00Z",
      "advisory": "RHSA-2021:2150",
      "package": "runc-0:1.0.0-69.rc10.el7_9",
      "cpe": "cpe:/a:redhat:openshift:3.11::el7"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.5",
      "release_date": "2021-05-26T00:00:00Z",
      "advisory": "RHSA-2021:2057",
      "package": "openshift-0:4.5.0-202105121820.p0.git.d8ef5ad.el8",
      "cpe": "cpe:/a:redhat:openshift:4.5::el7"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.5",
      "release_date": "2021-05-26T00:00:00Z",
      "advisory": "RHSA-2021:2057",
      "package": "runc-0:1.0.0-74.rhaos4.5.gitd2c3b70.el7",
      "cpe": "cpe:/a:redhat:openshift:4.5::el7"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.6",
      "release_date": "2021-05-26T00:00:00Z",
      "advisory": "RHSA-2021:1566",
      "package": "openshift-0:4.6.0-202105150940.p0.git.9caf8fe.el8",
      "cpe": "cpe:/a:redhat:openshift:4.6::el7"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.6",
      "release_date": "2021-05-26T00:00:00Z",
      "advisory": "RHSA-2021:1566",
      "package": "runc-0:1.0.0-87.rhaos4.6.git23384e2.el8",
      "cpe": "cpe:/a:redhat:openshift:4.6::el7"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.7",
      "release_date": "2021-05-24T00:00:00Z",
      "advisory": "RHSA-2021:1562",
      "package": "runc-0:1.0.0-96.rhaos4.8.gitcd80260.el8",
      "cpe": "cpe:/a:redhat:openshift:4.7::el7"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "multicloud-operators-subscription",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "multicloud-operators-subscription-release",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "container-tools:1.0/runc",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "runc",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2021-05-19T10:00:00Z",
  "bugzilla": {
    "description": "runc: vulnerable to symlink exchange attack",
    "id": "1954736",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1954736"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-367-\u003eCWE-59",
  "statement": "OpenShift Container Platform OCP 3.11 be default uses Docker from RHEL-7 extras repository. If using OCP 3.11 upgrade docker on all nodes to a fixed version from the RHEL-7 extras channel. CRI-O could be used instead of Docker on OCP 3.11 and in that case upgrade the runc version from the OCP rpm repository when it becomes available.",
  "acknowledgement": "Red Hat would like to thank Etienne Champetier for reporting this issue.",
  "name": "CVE-2021-30465",
  "document_distribution": "",
  "details": [
    "runc before 1.0.0-rc95 allows a Container Filesystem Breakout via Directory Traversal. To exploit the vulnerability, an attacker must be able to create multiple containers with a fairly specific mount configuration. The problem occurs via a symlink-exchange attack that relies on a race condition.",
    "The runc package is vulnerable to a symlink exchange attack whereby an attacker can request a seemingly innocuous container configuration that results in the host filesystem being bind-mounted into the container. The highest threat from this vulnerability is to data confidentiality and integrity as well as to system availability."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-30465\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-30465\nhttps://github.com/opencontainers/runc/security/advisories/GHSA-c3xm-pvg7-gh7r"
  ]
}