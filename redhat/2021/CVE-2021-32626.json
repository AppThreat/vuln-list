{
  "mitigation": "Prevent users from executing Lua scripts. This can be done using ACL to restrict EVAL and EVALSHA commands. Please see https://redis.io/topics/acl for more information on how to do this.",
  "affected_release": [
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "release_date": "2021-10-20T00:00:00Z",
      "advisory": "RHSA-2021:3949",
      "package": "acm-must-gather-container",
      "cpe": "cpe:/a:redhat:acm:2.1::el8"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.2 for RHEL 8",
      "release_date": "2021-10-14T00:00:00Z",
      "advisory": "RHSA-2021:3873",
      "package": "rhacm2/redisgraph-tls-rhel8:v2.2.9-3",
      "cpe": "cpe:/a:redhat:acm:2.2::el8"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
      "release_date": "2021-10-20T00:00:00Z",
      "advisory": "RHSA-2021:3925",
      "package": "rhacm2/redisgraph-tls-rhel8:v2.3.3-3",
      "cpe": "cpe:/a:redhat:acm:2.3::el8"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.4 for RHEL 8",
      "release_date": "2021-11-11T00:00:00Z",
      "advisory": "RHSA-2021:4618",
      "package": "rhacm2/redisgraph-tls-rhel8:v2.4.0-9",
      "cpe": "cpe:/a:redhat:acm:2.4::el8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-10-19T00:00:00Z",
      "advisory": "RHSA-2021:3918",
      "package": "redis:5-8040020211011074037.522a0ee4",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-10-20T00:00:00Z",
      "advisory": "RHSA-2021:3945",
      "package": "redis:6-8040020211011082941.522a0ee4",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.1 Extended Update Support",
      "release_date": "2021-10-20T00:00:00Z",
      "advisory": "RHSA-2021:3946",
      "package": "redis:5-8010020211011065007.c27ad7f8",
      "cpe": "cpe:/a:redhat:rhel_eus:8.1"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
      "release_date": "2021-10-20T00:00:00Z",
      "advisory": "RHSA-2021:3944",
      "package": "redis:5-8020020211011071901.4cda2c84",
      "cpe": "cpe:/a:redhat:rhel_eus:8.2"
    },
    {
      "product_name": "Red Hat OpenStack Platform 10.0 (Newton)",
      "release_date": "2021-10-25T00:00:00Z",
      "advisory": "RHSA-2021:3971",
      "package": "redis-0:3.2.8-5.el7ost",
      "cpe": "cpe:/a:redhat:openstack:10::el7"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13.0 - ELS",
      "release_date": "2021-10-25T00:00:00Z",
      "advisory": "RHSA-2021:3980",
      "package": "redis-0:3.2.8-5.el7ost",
      "cpe": "cpe:/a:redhat:openstack:13::el7"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13.0 (Queens) for RHEL 7.6 EUS",
      "release_date": "2021-10-25T00:00:00Z",
      "advisory": "RHSA-2021:3980",
      "package": "redis-0:3.2.8-5.el7ost",
      "cpe": "cpe:/a:redhat:openstack:13::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2021-10-20T00:00:00Z",
      "advisory": "RHSA-2021:3947",
      "package": "rh-redis5-redis-0:5.0.5-3.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
      "release_date": "2021-10-20T00:00:00Z",
      "advisory": "RHSA-2021:3947",
      "package": "rh-redis5-redis-0:5.0.5-3.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat 3scale API Management Platform 2",
      "fix_state": "Not affected",
      "package_name": "redis",
      "cpe": "cpe:/a:redhat:red_hat_3scale_amp:2"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 1.2",
      "fix_state": "Not affected",
      "package_name": "redis",
      "cpe": "cpe:/a:redhat:ansible_automation_platform"
    },
    {
      "product_name": "Red Hat Ansible Tower 3",
      "fix_state": "Affected",
      "package_name": "redis",
      "cpe": "cpe:/a:redhat:ansible_tower:3"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "redis",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Software Collections",
      "fix_state": "Not affected",
      "package_name": "rh-redis6-redis",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2021-10-04T00:00:00Z",
  "bugzilla": {
    "description": "redis: Lua scripts can overflow the heap-based Lua stack",
    "id": "2011017",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2011017"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-787",
  "statement": "",
  "acknowledgement": "Upstream acknowledges Meir Shpilraien as the original reporter.",
  "name": "CVE-2021-32626",
  "document_distribution": "",
  "details": [
    "Redis is an open source, in-memory database that persists on disk. In affected versions specially crafted Lua scripts executing in Redis can cause the heap-based Lua stack to be overflowed, due to incomplete checks for this condition. This can result with heap corruption and potentially remote code execution. This problem exists in all versions of Redis with Lua scripting support, starting from 2.6. The problem is fixed in versions 6.2.6, 6.0.16 and 5.0.14. For users unable to update an additional workaround to mitigate the problem without patching the redis-server executable is to prevent users from executing Lua scripts. This can be done using ACL to restrict EVAL and EVALSHA commands.",
    "A heap buffer overflow was found in redis. Specially crafted Lua scripts executing in Redis cause the heap-based Lua stack to overflow due to incomplete checks for this condition. This flaw allows a remote attacker to corrupt the heap and potentially trigger remote code execution. The highest threat from this vulnerability is to confidentiality, integrity, as well as system availability."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-32626\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-32626\nhttps://github.com/redis/redis/security/advisories/GHSA-p486-xggp-782c"
  ]
}