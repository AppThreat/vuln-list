{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-06-19T00:00:00Z",
  "bugzilla": {
    "description": "kernel: net/sched: sch_ets: don't remove idle classes from the round-robin list",
    "id": "2293231",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2293231"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2021-47595",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnet/sched: sch_ets: don't remove idle classes from the round-robin list\nShuang reported that the following script:\n1) tc qdisc add dev ddd0 handle 10: parent 1: ets bands 8 strict 4 priomap 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7\n2) mausezahn ddd0  -A 10.10.10.1 -B 10.10.10.2 -c 0 -a own -b 00:c1:a0:c1:a0:00 -t udp \u0026\n3) tc qdisc change dev ddd0 handle 10: ets bands 4 strict 2 quanta 2500 2500 priomap 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\ncrashes systematically when line 2) is commented:\nlist_del corruption, ffff8e028404bd30-\u003enext is LIST_POISON1 (dead000000000100)\n------------[ cut here ]------------\nkernel BUG at lib/list_debug.c:47!\ninvalid opcode: 0000 [#1] PREEMPT SMP NOPTI\nCPU: 0 PID: 954 Comm: tc Not tainted 5.16.0-rc4+ #478\nHardware name: Red Hat KVM, BIOS 1.11.1-4.module+el8.1.0+4066+0f1aadab 04/01/2014\nRIP: 0010:__list_del_entry_valid.cold.1+0x12/0x47\nCode: fe ff 0f 0b 48 89 c1 4c 89 c6 48 c7 c7 08 42 1b 87 e8 1d c5 fe ff 0f 0b 48 89 fe 48 89 c2 48 c7 c7 98 42 1b 87 e8 09 c5 fe ff \u003c0f\u003e 0b 48 c7 c7 48 43 1b 87 e8 fb c4 fe ff 0f 0b 48 89 f2 48 89 fe\nRSP: 0018:ffffae46807a3888 EFLAGS: 00010246\nRAX: 000000000000004e RBX: 0000000000000007 RCX: 0000000000000202\nRDX: 0000000000000000 RSI: ffffffff871ac536 RDI: 00000000ffffffff\nRBP: ffffae46807a3a10 R08: 0000000000000000 R09: c0000000ffff7fff\nR10: 0000000000000001 R11: ffffae46807a36a8 R12: ffff8e028404b800\nR13: ffff8e028404bd30 R14: dead000000000100 R15: ffff8e02fafa2400\nFS:  00007efdc92e4480(0000) GS:ffff8e02fb600000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 0000000000682f48 CR3: 00000001058be000 CR4: 0000000000350ef0\nCall Trace:\n\u003cTASK\u003e\nets_qdisc_change+0x58b/0xa70 [sch_ets]\ntc_modify_qdisc+0x323/0x880\nrtnetlink_rcv_msg+0x169/0x4a0\nnetlink_rcv_skb+0x50/0x100\nnetlink_unicast+0x1a5/0x280\nnetlink_sendmsg+0x257/0x4d0\nsock_sendmsg+0x5b/0x60\n____sys_sendmsg+0x1f2/0x260\n___sys_sendmsg+0x7c/0xc0\n__sys_sendmsg+0x57/0xa0\ndo_syscall_64+0x3a/0x80\nentry_SYSCALL_64_after_hwframe+0x44/0xae\nRIP: 0033:0x7efdc8031338\nCode: 89 02 48 c7 c0 ff ff ff ff eb b5 0f 1f 80 00 00 00 00 f3 0f 1e fa 48 8d 05 25 43 2c 00 8b 00 85 c0 75 17 b8 2e 00 00 00 0f 05 \u003c48\u003e 3d 00 f0 ff ff 77 58 c3 0f 1f 80 00 00 00 00 41 54 41 89 d4 55\nRSP: 002b:00007ffdf1ce9828 EFLAGS: 00000246 ORIG_RAX: 000000000000002e\nRAX: ffffffffffffffda RBX: 0000000061b37a97 RCX: 00007efdc8031338\nRDX: 0000000000000000 RSI: 00007ffdf1ce9890 RDI: 0000000000000003\nRBP: 0000000000000000 R08: 0000000000000001 R09: 000000000078a940\nR10: 000000000000000c R11: 0000000000000246 R12: 0000000000000001\nR13: 0000000000688880 R14: 0000000000000000 R15: 0000000000000000\n\u003c/TASK\u003e\nModules linked in: sch_ets sch_tbf dummy rfkill iTCO_wdt iTCO_vendor_support intel_rapl_msr intel_rapl_common joydev pcspkr i2c_i801 virtio_balloon i2c_smbus lpc_ich ip_tables xfs libcrc32c crct10dif_pclmul crc32_pclmul crc32c_intel serio_raw ghash_clmulni_intel ahci libahci libata virtio_blk virtio_console virtio_net net_failover failover sunrpc dm_mirror dm_region_hash dm_log dm_mod [last unloaded: sch_ets]\n---[ end trace f35878d1912655c2 ]---\nRIP: 0010:__list_del_entry_valid.cold.1+0x12/0x47\nCode: fe ff 0f 0b 48 89 c1 4c 89 c6 48 c7 c7 08 42 1b 87 e8 1d c5 fe ff 0f 0b 48 89 fe 48 89 c2 48 c7 c7 98 42 1b 87 e8 09 c5 fe ff \u003c0f\u003e 0b 48 c7 c7 48 43 1b 87 e8 fb c4 fe ff 0f 0b 48 89 f2 48 89 fe\nRSP: 0018:ffffae46807a3888 EFLAGS: 00010246\nRAX: 000000000000004e RBX: 0000000000000007 RCX: 0000000000000202\nRDX: 0000000000000000 RSI: ffffffff871ac536 RDI: 00000000ffffffff\nRBP: ffffae46807a3a10 R08: 0000000000000000 R09: c0000000ffff7fff\nR10: 0000000000000001 R11: ffffae46807a36a8 R12: ffff8e028404b800\nR13: ffff8e028404bd30 R14: dead000000000100 R15: ffff8e02fafa2400\nFS:  00007efdc92e4480(0000) GS:ffff8e02fb600000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 000000000\n---truncated---"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-47595\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-47595\nhttps://lore.kernel.org/linux-cve-announce/2024061920-CVE-2021-47595-e9f3@gregkh/T"
  ]
}