{
  "affected_release": [
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.4 for RHEL 8",
      "release_date": "2021-11-11T00:00:00Z",
      "advisory": "RHSA-2021:4618",
      "package": "rhacm2/grc-ui-rhel8:v2.4.0-47",
      "cpe": "cpe:/a:redhat:acm:2.4::el8"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.4 for RHEL 8",
      "release_date": "2021-11-11T00:00:00Z",
      "advisory": "RHSA-2021:4618",
      "package": "rhacm2/search-ui-rhel8:v2.4.0-20",
      "cpe": "cpe:/a:redhat:acm:2.4::el8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-09-21T00:00:00Z",
      "advisory": "RHSA-2021:3623",
      "package": "nodejs:12-8040020210817133458.522a0ee4",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-09-27T00:00:00Z",
      "advisory": "RHSA-2021:3666",
      "package": "nodejs:14-8040020210817165654.522a0ee4",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.1 Extended Update Support",
      "release_date": "2021-09-22T00:00:00Z",
      "advisory": "RHSA-2021:3639",
      "package": "nodejs:12-8010020210817113128.c27ad7f8",
      "cpe": "cpe:/a:redhat:rhel_eus:8.1"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
      "release_date": "2021-09-22T00:00:00Z",
      "advisory": "RHSA-2021:3638",
      "package": "nodejs:12-8020020210817125332.4cda2c84",
      "cpe": "cpe:/a:redhat:rhel_eus:8.2"
    },
    {
      "product_name": "Red Hat OpenShift Data Foundation 4.9.0 on RHEL-8",
      "release_date": "2021-12-13T00:00:00Z",
      "advisory": "RHSA-2021:5086",
      "package": "odf4/cephcsi-rhel8:4.9-164.57484e3.release_4.9",
      "cpe": "cpe:/a:redhat:openshift_data_foundation:4.9::el8"
    },
    {
      "product_name": "Red Hat OpenShift Data Foundation 4.9.0 on RHEL-8",
      "release_date": "2021-12-13T00:00:00Z",
      "advisory": "RHSA-2021:5086",
      "package": "odf4/ocs-must-gather-rhel8:4.9-257.4181add.release_4.9",
      "cpe": "cpe:/a:redhat:openshift_data_foundation:4.9::el8"
    },
    {
      "product_name": "Red Hat OpenShift Data Foundation 4.9.0 on RHEL-8",
      "release_date": "2021-12-13T00:00:00Z",
      "advisory": "RHSA-2021:5086",
      "package": "odf4/ocs-operator-bundle:4.9.0-5",
      "cpe": "cpe:/a:redhat:openshift_data_foundation:4.9::el8"
    },
    {
      "product_name": "Red Hat OpenShift Data Foundation 4.9.0 on RHEL-8",
      "release_date": "2021-12-13T00:00:00Z",
      "advisory": "RHSA-2021:5086",
      "package": "odf4/ocs-rhel8-operator:4.9-257.4181add.release_4.9",
      "cpe": "cpe:/a:redhat:openshift_data_foundation:4.9::el8"
    },
    {
      "product_name": "Red Hat OpenShift Data Foundation 4.9.0 on RHEL-8",
      "release_date": "2021-12-13T00:00:00Z",
      "advisory": "RHSA-2021:5086",
      "package": "odf4/odf-console-rhel8:4.9-39.0f2fa23.release_4.9",
      "cpe": "cpe:/a:redhat:openshift_data_foundation:4.9::el8"
    },
    {
      "product_name": "Red Hat OpenShift Data Foundation 4.9.0 on RHEL-8",
      "release_date": "2021-12-13T00:00:00Z",
      "advisory": "RHSA-2021:5086",
      "package": "odf4/odf-multicluster-operator-bundle:4.9.0-5",
      "cpe": "cpe:/a:redhat:openshift_data_foundation:4.9::el8"
    },
    {
      "product_name": "Red Hat OpenShift Data Foundation 4.9.0 on RHEL-8",
      "release_date": "2021-12-13T00:00:00Z",
      "advisory": "RHSA-2021:5086",
      "package": "odf4/odf-multicluster-rhel8-operator:4.9-30.007b3d8.release_4.9",
      "cpe": "cpe:/a:redhat:openshift_data_foundation:4.9::el8"
    },
    {
      "product_name": "Red Hat OpenShift Data Foundation 4.9.0 on RHEL-8",
      "release_date": "2021-12-13T00:00:00Z",
      "advisory": "RHSA-2021:5086",
      "package": "odf4/odf-operator-bundle:4.9.0-5",
      "cpe": "cpe:/a:redhat:openshift_data_foundation:4.9::el8"
    },
    {
      "product_name": "Red Hat OpenShift Data Foundation 4.9.0 on RHEL-8",
      "release_date": "2021-12-13T00:00:00Z",
      "advisory": "RHSA-2021:5086",
      "package": "odf4/odf-rhel8-operator:4.9-59.c8bbc1f.release_4.9",
      "cpe": "cpe:/a:redhat:openshift_data_foundation:4.9::el8"
    },
    {
      "product_name": "Red Hat OpenShift Data Foundation 4.9.0 on RHEL-8",
      "release_date": "2021-12-13T00:00:00Z",
      "advisory": "RHSA-2021:5086",
      "package": "odf4/odr-cluster-operator-bundle:4.9.0-5",
      "cpe": "cpe:/a:redhat:openshift_data_foundation:4.9::el8"
    },
    {
      "product_name": "Red Hat OpenShift Data Foundation 4.9.0 on RHEL-8",
      "release_date": "2021-12-13T00:00:00Z",
      "advisory": "RHSA-2021:5086",
      "package": "odf4/odr-hub-operator-bundle:4.9.0-5",
      "cpe": "cpe:/a:redhat:openshift_data_foundation:4.9::el8"
    },
    {
      "product_name": "Red Hat OpenShift Data Foundation 4.9.0 on RHEL-8",
      "release_date": "2021-12-13T00:00:00Z",
      "advisory": "RHSA-2021:5086",
      "package": "odf4/odr-rhel8-operator:4.9-27.3d037cc.release_4.9",
      "cpe": "cpe:/a:redhat:openshift_data_foundation:4.9::el8"
    },
    {
      "product_name": "Red Hat OpenShift Data Foundation 4.9.0 on RHEL-8",
      "release_date": "2021-12-13T00:00:00Z",
      "advisory": "RHSA-2021:5086",
      "package": "odf4/rook-ceph-rhel8-operator:4.9-219.c3f67c6.release_4.9",
      "cpe": "cpe:/a:redhat:openshift_data_foundation:4.9::el8"
    },
    {
      "product_name": "Red Hat OpenShift Data Foundation 4.9.0 on RHEL-8",
      "release_date": "2021-12-13T00:00:00Z",
      "advisory": "RHSA-2021:5086",
      "package": "odf4/volume-replication-rhel8-operator:4.9-28.82f68db.release_4.9",
      "cpe": "cpe:/a:redhat:openshift_data_foundation:4.9::el8"
    },
    {
      "product_name": "Red Hat OpenShift Data Foundation 4.9.0 on RHEL-8",
      "release_date": "2021-12-13T00:00:00Z",
      "advisory": "RHSA-2021:5086",
      "package": "odf/odf-multicluster-rhel8-operator:4.9-30.007b3d8.release_4.9",
      "cpe": "cpe:/a:redhat:openshift_data_foundation:4.9::el8"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2021-08-26T00:00:00Z",
      "advisory": "RHSA-2021:3280",
      "package": "rh-nodejs14-nodejs-0:14.17.5-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2021-08-26T00:00:00Z",
      "advisory": "RHSA-2021:3281",
      "package": "rh-nodejs12-nodejs-0:12.22.5-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2021-08-26T00:00:00Z",
      "advisory": "RHSA-2021:3281",
      "package": "rh-nodejs12-nodejs-nodemon-0:2.0.3-5.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
      "release_date": "2021-08-26T00:00:00Z",
      "advisory": "RHSA-2021:3280",
      "package": "rh-nodejs14-nodejs-0:14.17.5-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
      "release_date": "2021-08-26T00:00:00Z",
      "advisory": "RHSA-2021:3281",
      "package": "rh-nodejs12-nodejs-0:12.22.5-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
      "release_date": "2021-08-26T00:00:00Z",
      "advisory": "RHSA-2021:3281",
      "package": "rh-nodejs12-nodejs-nodemon-0:2.0.3-5.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    }
  ],
  "package_state": [
    {
      "product_name": "OpenShift Service Mesh 2.0",
      "fix_state": "Will not fix",
      "package_name": "servicemesh-grafana",
      "cpe": "cpe:/a:redhat:service_mesh:2.0"
    },
    {
      "product_name": "OpenShift Service Mesh 2.0",
      "fix_state": "Will not fix",
      "package_name": "servicemesh-prometheus",
      "cpe": "cpe:/a:redhat:service_mesh:2.0"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "rhacm2/application-ui-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Will not fix",
      "package_name": "rhacm2/console-header-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Will not fix",
      "package_name": "rhacm2/console-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Will not fix",
      "package_name": "rhacm2/console-ui-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Will not fix",
      "package_name": "rhacm2/kui-web-terminal-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Will not fix",
      "package_name": "rhacm2/mcm-topology-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "nodejs:16/nodejs",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "nodejs",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Not affected",
      "package_name": "tar-pack",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Will not fix",
      "package_name": "openshift4/ose-grafana",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat Openshift Container Storage 4",
      "fix_state": "Affected",
      "package_name": "ocs4/mcg-core-rhel8",
      "cpe": "cpe:/a:redhat:openshift_container_storage:4"
    },
    {
      "product_name": "Red Hat OpenShift GitOps",
      "fix_state": "Affected",
      "package_name": "openshift-gitops-1/argocd-rhel8",
      "cpe": "cpe:/a:redhat:openshift_gitops:1"
    },
    {
      "product_name": "Red Hat Quay 3",
      "fix_state": "Not affected",
      "package_name": "quay",
      "cpe": "cpe:/a:redhat:quay:3"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2021-08-03T00:00:00Z",
  "bugzilla": {
    "description": "nodejs-tar: Insufficient absolute path sanitization allowing arbitrary file creation and overwrite",
    "id": "1990409",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1990409"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-22",
  "statement": "Red Hat Quay 3.3 uses an affected version of nodejs-tar. However Quay 3.3 is in extended life phase and a fix will not be delivered[1]. More recent versions of Red Hat Quay do not include nodejs-tar and are not affected.\n1. https://access.redhat.com/support/policy/updates/rhquay\nRed Hat Enterprise Linux version 8 and Red Hat Software Collection both embed node-tar in the npm command. A specially crafted node module could create and overwrite files outside of its dedicated directory.",
  "acknowledgement": "",
  "name": "CVE-2021-32804",
  "document_distribution": "",
  "details": [
    "The npm package \"tar\" (aka node-tar) before versions 6.1.1, 5.0.6, 4.4.14, and 3.3.2 has a arbitrary File Creation/Overwrite vulnerability due to insufficient absolute path sanitization. node-tar aims to prevent extraction of absolute file paths by turning absolute paths into relative paths when the `preservePaths` flag is not set to `true`. This is achieved by stripping the absolute path root from any absolute file paths contained in a tar file. For example `/home/user/.bashrc` would turn into `home/user/.bashrc`. This logic was insufficient when file paths contained repeated path roots such as `////home/user/.bashrc`. `node-tar` would only strip a single path root from such paths. When given an absolute file path with repeating path roots, the resulting path (e.g. `///home/user/.bashrc`) would still resolve to an absolute path, thus allowing arbitrary file creation and overwrite. This issue was addressed in releases 3.2.2, 4.4.14, 5.0.6 and 6.1.1. Users may work around this vulnerability without upgrading by creating a custom `onentry` method which sanitizes the `entry.path` or a `filter` method which removes entries with absolute paths. See referenced GitHub Advisory for details. Be aware of CVE-2021-32803 which fixes a similar bug in later versions of tar.",
    "The npm package \"tar\" (aka node-tar) has an arbitrary File Creation/Overwrite vulnerability due to insufficient absolute path sanitization. node-tar aims to prevent extraction of absolute file paths by turning absolute paths into relative paths when the `preservePaths` flag is not set to `true`. This is achieved by stripping the absolute path root from any absolute file paths contained in a tar file."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-32804\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-32804\nhttps://github.com/npm/node-tar/security/advisories/GHSA-3jfq-g458-7qm9"
  ]
}