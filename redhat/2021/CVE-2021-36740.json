{
  "mitigation": "This issue can be mitigated by:\n1) Disabling HTTP/2 request support by executing:\n~~~\nsudo varnishadm param.set feature -http2\n~~~\n2) Disabling backend connection reuse on varnish side, the following rule can be inserted into Varnish configuration:\n~~~\nsub vcl_backend_fetch {\nset bereq.http.Connection = \"close\";\n}\n~~~",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-08-02T00:00:00Z",
      "advisory": "RHSA-2021:2988",
      "package": "varnish:6-8040020210722190209.522a0ee4",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.1 Extended Update Support",
      "release_date": "2021-08-02T00:00:00Z",
      "advisory": "RHSA-2021:2988",
      "package": "varnish:6-8010020210726155835.c27ad7f8",
      "cpe": "cpe:/a:redhat:rhel_eus:8.1"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
      "release_date": "2021-08-02T00:00:00Z",
      "advisory": "RHSA-2021:2988",
      "package": "varnish:6-8020020210726155330.4cda2c84",
      "cpe": "cpe:/a:redhat:rhel_eus:8.2"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2021-08-03T00:00:00Z",
      "advisory": "RHSA-2021:2993",
      "package": "rh-varnish6-varnish-0:6.0.8-2.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2021-08-03T00:00:00Z",
      "advisory": "RHSA-2021:2993",
      "package": "rh-varnish6-varnish-modules-0:0.15.0-7.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
      "release_date": "2021-08-03T00:00:00Z",
      "advisory": "RHSA-2021:2993",
      "package": "rh-varnish6-varnish-0:6.0.8-2.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
      "release_date": "2021-08-03T00:00:00Z",
      "advisory": "RHSA-2021:2993",
      "package": "rh-varnish6-varnish-modules-0:0.15.0-7.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "varnish",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2021-07-13T00:00:00Z",
  "bugzilla": {
    "description": "varnish: HTTP/2 request smuggling attack via a large Content-Length header for a POST request",
    "id": "1982409",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1982409"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-444",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2021-36740",
  "document_distribution": "",
  "details": [
    "Varnish Cache, with HTTP/2 enabled, allows request smuggling and VCL authorization bypass via a large Content-Length header for a POST request. This affects Varnish Enterprise 6.0.x before 6.0.8r3, and Varnish Cache 5.x and 6.x before 6.5.2, 6.6.x before 6.6.1, and 6.0 LTS before 6.0.8.",
    "A flaw was found in Varnish. The Varnish Cache, with HTTP/2 enabled, allows request smuggling and VCL authorization bypass via a large Content-Length header for a POST request. As a result, this flaw allows the information on the Varnish cache to be poisoned. The highest threat from this vulnerability is to confidentiality, integrity, as well as system availability."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-36740\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-36740\nhttps://varnish-cache.org/security/VSV00007.html"
  ]
}