{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Ceph Storage 2",
      "fix_state": "Out of support scope",
      "package_name": "salt",
      "cpe": "cpe:/a:redhat:ceph_storage:2"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2021-04-23T00:00:00Z",
  "bugzilla": {
    "description": "salt: Command injection in the snapper module",
    "id": "1953065",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1953065"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-77",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2021-31607",
  "document_distribution": "",
  "details": [
    "In SaltStack Salt 2016.9 through 3002.6, a command injection vulnerability exists in the snapper module that allows for local privilege escalation on a minion. The attack requires that a file is created with a pathname that is backed up by snapper, and that the master calls the snapper.diff function (which executes popen unsafely).",
    "A flaw was found in Salt. A command injection vulnerability occurs in the snapper module that allows local privilege escalation on a minion. This attack requires the creation of a file with a pathname that is backed up by snapper, with the master calling the snapper.diff function. Snapper.diff executes the popen unsafely. The highest threat from this vulnerability is to confidentiality, integrity, as well as system availability."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-31607\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-31607"
  ]
}