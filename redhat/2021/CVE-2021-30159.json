{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Will not fix",
      "package_name": "mediawiki",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Out of support scope",
      "package_name": "mediawiki",
      "cpe": "cpe:/a:redhat:openshift:4"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2021-04-08T00:00:00Z",
  "bugzilla": {
    "description": "mediawiki: users can bypass intended restrictions on deleting pages in certain \"fast double move\" situations",
    "id": "1948638",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1948638"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-863",
  "statement": "The mediawiki package was removed from OpenShift Container Platform (OCP) in version 4.3, therefore for OCP 4 has been marked as out of support scope.",
  "acknowledgement": "",
  "name": "CVE-2021-30159",
  "document_distribution": "",
  "details": [
    "An issue was discovered in MediaWiki before 1.31.12 and 1.32.x through 1.35.x before 1.35.2. Users can bypass intended restrictions on deleting pages in certain \"fast double move\" situations. MovePage::isValidMoveTarget() uses FOR UPDATE, but it's only called if Title::getArticleID() returns non-zero with no special flags. Next, MovePage::moveToInternal() will delete the page if getArticleID(READ_LATEST) is non-zero. Therefore, if the page is missing in the replica DB, isValidMove() will return true, and then moveToInternal() will unconditionally delete the page if it can be found in the master.",
    "In the mediawiki package, users can bypass intended restrictions on deleting pages in certain \"fast double move\" situations."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-30159\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-30159"
  ]
}