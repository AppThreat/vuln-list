{
  "mitigation": "null",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-05-22T00:00:00Z",
  "bugzilla": {
    "description": "kernel: netfilter: nf_tables: skip netdev events generated on netns removal",
    "id": "2282906",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2282906"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2021-47452",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnetfilter: nf_tables: skip netdev events generated on netns removal\nsyzbot reported following (harmless) WARN:\nWARNING: CPU: 1 PID: 2648 at net/netfilter/core.c:468\nnft_netdev_unregister_hooks net/netfilter/nf_tables_api.c:230 [inline]\nnf_tables_unregister_hook include/net/netfilter/nf_tables.h:1090 [inline]\n__nft_release_basechain+0x138/0x640 net/netfilter/nf_tables_api.c:9524\nnft_netdev_event net/netfilter/nft_chain_filter.c:351 [inline]\nnf_tables_netdev_event+0x521/0x8a0 net/netfilter/nft_chain_filter.c:382\nreproducer:\nunshare -n bash -c 'ip link add br0 type bridge; nft add table netdev t ; \\\nnft add chain netdev t ingress \\{ type filter hook ingress device \"br0\" \\\npriority 0\\; policy drop\\; \\}'\nProblem is that when netns device exit hooks create the UNREGISTER\nevent, the .pre_exit hook for nf_tables core has already removed the\nbase hook.  Notifier attempts to do this again.\nThe need to do base hook unregister unconditionally was needed in the past,\nbecause notifier was last stage where reg-\u003edev dereference was safe.\nNow that nf_tables does the hook removal in .pre_exit, this isn't\nneeded anymore."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-47452\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-47452\nhttps://lore.kernel.org/linux-cve-announce/2024052243-CVE-2021-47452-40cb@gregkh/T"
  ]
}