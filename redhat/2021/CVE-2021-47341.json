{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Low",
  "public_date": "2024-05-21T00:00:00Z",
  "bugzilla": {
    "description": "kernel: KVM: mmio: Fix use-after-free Read in kvm_vm_ioctl_unregister_coalesced_mmio",
    "id": "2282418",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2282418"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2021-47341",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nKVM: mmio: Fix use-after-free Read in kvm_vm_ioctl_unregister_coalesced_mmio\nBUG: KASAN: use-after-free in kvm_vm_ioctl_unregister_coalesced_mmio+0x7c/0x1ec arch/arm64/kvm/../../../virt/kvm/coalesced_mmio.c:183\nRead of size 8 at addr ffff0000c03a2500 by task syz-executor083/4269\nCPU: 5 PID: 4269 Comm: syz-executor083 Not tainted 5.10.0 #7\nHardware name: linux,dummy-virt (DT)\nCall trace:\ndump_backtrace+0x0/0x2d0 arch/arm64/kernel/stacktrace.c:132\nshow_stack+0x28/0x34 arch/arm64/kernel/stacktrace.c:196\n__dump_stack lib/dump_stack.c:77 [inline]\ndump_stack+0x110/0x164 lib/dump_stack.c:118\nprint_address_description+0x78/0x5c8 mm/kasan/report.c:385\n__kasan_report mm/kasan/report.c:545 [inline]\nkasan_report+0x148/0x1e4 mm/kasan/report.c:562\ncheck_memory_region_inline mm/kasan/generic.c:183 [inline]\n__asan_load8+0xb4/0xbc mm/kasan/generic.c:252\nkvm_vm_ioctl_unregister_coalesced_mmio+0x7c/0x1ec arch/arm64/kvm/../../../virt/kvm/coalesced_mmio.c:183\nkvm_vm_ioctl+0xe30/0x14c4 arch/arm64/kvm/../../../virt/kvm/kvm_main.c:3755\nvfs_ioctl fs/ioctl.c:48 [inline]\n__do_sys_ioctl fs/ioctl.c:753 [inline]\n__se_sys_ioctl fs/ioctl.c:739 [inline]\n__arm64_sys_ioctl+0xf88/0x131c fs/ioctl.c:739\n__invoke_syscall arch/arm64/kernel/syscall.c:36 [inline]\ninvoke_syscall arch/arm64/kernel/syscall.c:48 [inline]\nel0_svc_common arch/arm64/kernel/syscall.c:158 [inline]\ndo_el0_svc+0x120/0x290 arch/arm64/kernel/syscall.c:220\nel0_svc+0x1c/0x28 arch/arm64/kernel/entry-common.c:367\nel0_sync_handler+0x98/0x170 arch/arm64/kernel/entry-common.c:383\nel0_sync+0x140/0x180 arch/arm64/kernel/entry.S:670\nAllocated by task 4269:\nstack_trace_save+0x80/0xb8 kernel/stacktrace.c:121\nkasan_save_stack mm/kasan/common.c:48 [inline]\nkasan_set_track mm/kasan/common.c:56 [inline]\n__kasan_kmalloc+0xdc/0x120 mm/kasan/common.c:461\nkasan_kmalloc+0xc/0x14 mm/kasan/common.c:475\nkmem_cache_alloc_trace include/linux/slab.h:450 [inline]\nkmalloc include/linux/slab.h:552 [inline]\nkzalloc include/linux/slab.h:664 [inline]\nkvm_vm_ioctl_register_coalesced_mmio+0x78/0x1cc arch/arm64/kvm/../../../virt/kvm/coalesced_mmio.c:146\nkvm_vm_ioctl+0x7e8/0x14c4 arch/arm64/kvm/../../../virt/kvm/kvm_main.c:3746\nvfs_ioctl fs/ioctl.c:48 [inline]\n__do_sys_ioctl fs/ioctl.c:753 [inline]\n__se_sys_ioctl fs/ioctl.c:739 [inline]\n__arm64_sys_ioctl+0xf88/0x131c fs/ioctl.c:739\n__invoke_syscall arch/arm64/kernel/syscall.c:36 [inline]\ninvoke_syscall arch/arm64/kernel/syscall.c:48 [inline]\nel0_svc_common arch/arm64/kernel/syscall.c:158 [inline]\ndo_el0_svc+0x120/0x290 arch/arm64/kernel/syscall.c:220\nel0_svc+0x1c/0x28 arch/arm64/kernel/entry-common.c:367\nel0_sync_handler+0x98/0x170 arch/arm64/kernel/entry-common.c:383\nel0_sync+0x140/0x180 arch/arm64/kernel/entry.S:670\nFreed by task 4269:\nstack_trace_save+0x80/0xb8 kernel/stacktrace.c:121\nkasan_save_stack mm/kasan/common.c:48 [inline]\nkasan_set_track+0x38/0x6c mm/kasan/common.c:56\nkasan_set_free_info+0x20/0x40 mm/kasan/generic.c:355\n__kasan_slab_free+0x124/0x150 mm/kasan/common.c:422\nkasan_slab_free+0x10/0x1c mm/kasan/common.c:431\nslab_free_hook mm/slub.c:1544 [inline]\nslab_free_freelist_hook mm/slub.c:1577 [inline]\nslab_free mm/slub.c:3142 [inline]\nkfree+0x104/0x38c mm/slub.c:4124\ncoalesced_mmio_destructor+0x94/0xa4 arch/arm64/kvm/../../../virt/kvm/coalesced_mmio.c:102\nkvm_iodevice_destructor include/kvm/iodev.h:61 [inline]\nkvm_io_bus_unregister_dev+0x248/0x280 arch/arm64/kvm/../../../virt/kvm/kvm_main.c:4374\nkvm_vm_ioctl_unregister_coalesced_mmio+0x158/0x1ec arch/arm64/kvm/../../../virt/kvm/coalesced_mmio.c:186\nkvm_vm_ioctl+0xe30/0x14c4 arch/arm64/kvm/../../../virt/kvm/kvm_main.c:3755\nvfs_ioctl fs/ioctl.c:48 [inline]\n__do_sys_ioctl fs/ioctl.c:753 [inline]\n__se_sys_ioctl fs/ioctl.c:739 [inline]\n__arm64_sys_ioctl+0xf88/0x131c fs/ioctl.c:739\n__invoke_syscall arch/arm64/kernel/syscall.c:36 [inline]\ninvoke_syscall arch/arm64/kernel/sys\n---truncated---"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-47341\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-47341\nhttps://lore.kernel.org/linux-cve-announce/2024052137-CVE-2021-47341-f4e9@gregkh/T"
  ]
}