{
  "mitigation": "The flaw can be prevented by removing `--server=\u003caddress\u003e@\u003cinterface\u003e` option or by removing the directive `server=\u003caddress\u003e@\u003cinterface\u003e`. If dnsmasq is being run through NetworkManager, please be aware that NetworkManager automatically configures dnsmasq to use the `server=\u003caddress\u003e@\u003cinterface\u003e` directive, thus in this case the only way to prevent the flaw is to remove `dns=dnsmasq` from /etc/NetworkManager/NetworkManager.conf file.\nIf the `server=\u003caddress\u003e@\u003cinterface\u003e` must be kept active, the impact of this flaw can be reduced by disabling the dnsmasq cache by adding `--cache-size=0` when calling dnsmasq or by adding a line with `cache-size=0` to the dnsmasq configuration file (/etc/dnsmasq.conf by default). If dnsmasq is being run through NetworkManager, create a new file in /etc/NetworkManager/dnsmasq.d/ and add `cache-size=0` to it.\nBy disabling the cache, you may experience a performance loss in your environment due to all DNS queries being forwarded to the upstream servers. Please evaluate if the mitigation is appropriate for the systemâ€™s environment before applying.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-11-09T00:00:00Z",
      "advisory": "RHSA-2021:4153",
      "package": "dnsmasq-0:2.79-19.el8",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "dnsmasq",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "dnsmasq",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "dnsmasq",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat OpenStack Platform 10 (Newton)",
      "fix_state": "Not affected",
      "package_name": "dnsmasq",
      "cpe": "cpe:/a:redhat:openstack:10"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13 (Queens)",
      "fix_state": "Not affected",
      "package_name": "dnsmasq",
      "cpe": "cpe:/a:redhat:openstack:13"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2021-03-12T00:00:00Z",
  "bugzilla": {
    "description": "dnsmasq: fixed outgoing port used when --server is used with an interface name",
    "id": "1939368",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1939368"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "4.0",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-358",
  "statement": "",
  "acknowledgement": "This issue was discovered by Petr Mensik (Red Hat).",
  "name": "CVE-2021-3448",
  "document_distribution": "",
  "details": [
    "A flaw was found in dnsmasq in versions before 2.85. When configured to use a specific server for a given network interface, dnsmasq uses a fixed port while forwarding queries. An attacker on the network, able to find the outgoing port used by dnsmasq, only needs to guess the random transmission ID to forge a reply and get it accepted by dnsmasq. This flaw makes a DNS Cache Poisoning attack much easier. The highest threat from this vulnerability is to data integrity.",
    "A flaw was found in dnsmasq. When configured to use a specific server for a given network interface, dnsmasq uses a fixed port while forwarding queries. An attacker on the network, able to find the outgoing port used by dnsmasq, only needs to guess the random transmission ID to forge a reply and get it accepted by dnsmasq. This flaw makes a DNS Cache Poisoning attack much easier. The highest threat from this vulnerability is to data integrity."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-3448\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-3448"
  ]
}