{
  "affected_release": [
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 7.1.0",
      "release_date": "2022-06-06T00:00:00Z",
      "advisory": "RHSA-2022:4922",
      "package": "h2",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 7.4 for RHEL 8",
      "release_date": "2022-06-06T00:00:00Z",
      "advisory": "RHSA-2022:4919",
      "package": "eap7-h2database-0:1.4.197-2.redhat_00004.1.el8eap",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4::el8"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 7.4 on RHEL 7",
      "release_date": "2022-06-06T00:00:00Z",
      "advisory": "RHSA-2022:4918",
      "package": "eap7-h2database-0:1.4.197-2.redhat_00004.1.el7eap",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4::el7"
    },
    {
      "product_name": "Red Hat Single Sign-On 7",
      "release_date": "2022-10-04T00:00:00Z",
      "advisory": "RHSA-2022:6787",
      "package": "h2",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.5 for RHEL 7",
      "release_date": "2022-10-04T00:00:00Z",
      "advisory": "RHSA-2022:6782",
      "package": "rh-sso7-keycloak-0:15.0.8-1.redhat_00001.1.el7sso",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.5::el7"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.5 for RHEL 8",
      "release_date": "2022-10-04T00:00:00Z",
      "advisory": "RHSA-2022:6783",
      "package": "rh-sso7-keycloak-0:15.0.8-1.redhat_00001.1.el8sso",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.5::el8"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.6.1",
      "release_date": "2022-11-03T00:00:00Z",
      "advisory": "RHSA-2022:7417",
      "package": "h2",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6.1"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.6 for RHEL 7",
      "release_date": "2022-11-03T00:00:00Z",
      "advisory": "RHSA-2022:7409",
      "package": "rh-sso7-keycloak-0:18.0.3-1.redhat_00001.1.el7sso",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el7"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.6 for RHEL 8",
      "release_date": "2022-11-03T00:00:00Z",
      "advisory": "RHSA-2022:7410",
      "package": "rh-sso7-keycloak-0:18.0.3-1.redhat_00001.1.el8sso",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el8"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.6 for RHEL 9",
      "release_date": "2022-11-03T00:00:00Z",
      "advisory": "RHSA-2022:7411",
      "package": "rh-sso7-0:1-5.el9sso",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el9"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.6 for RHEL 9",
      "release_date": "2022-11-03T00:00:00Z",
      "advisory": "RHSA-2022:7411",
      "package": "rh-sso7-javapackages-tools-0:6.0.0-7.el9sso",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el9"
    },
    {
      "product_name": "Red Hat Single Sign-On 7.6 for RHEL 9",
      "release_date": "2022-11-03T00:00:00Z",
      "advisory": "RHSA-2022:7411",
      "package": "rh-sso7-keycloak-0:18.0.3-1.redhat_00001.1.el9sso",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el9"
    },
    {
      "product_name": "RHINT Camel-Q 2.2.1",
      "release_date": "2022-03-22T00:00:00Z",
      "advisory": "RHSA-2022:1013",
      "package": "h2",
      "cpe": "cpe:/a:redhat:camel_quarkus:2.2.1"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat BPM Suite 6",
      "fix_state": "Out of support scope",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:6"
    },
    {
      "product_name": "Red Hat Decision Manager 7",
      "fix_state": "Not affected",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7"
    },
    {
      "product_name": "Red Hat Integration Camel K",
      "fix_state": "Not affected",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat Integration Service Registry",
      "fix_state": "Affected",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:service_registry:2"
    },
    {
      "product_name": "Red Hat JBoss BRMS 5",
      "fix_state": "Out of support scope",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:5"
    },
    {
      "product_name": "Red Hat JBoss BRMS 6",
      "fix_state": "Out of support scope",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Data Grid 7",
      "fix_state": "Out of support scope",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:jboss_data_grid:7"
    },
    {
      "product_name": "Red Hat JBoss Data Virtualization 6",
      "fix_state": "Out of support scope",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:jboss_data_virtualization:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Out of support scope",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack",
      "fix_state": "Not affected",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:jbosseapxp"
    },
    {
      "product_name": "Red Hat JBoss Fuse 6",
      "fix_state": "Out of support scope",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:jboss_fuse:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Not affected",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat JBoss Fuse Service Works 6",
      "fix_state": "Out of support scope",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:jboss_fuse_service_works:6"
    },
    {
      "product_name": "Red Hat JBoss Operations Network 3",
      "fix_state": "Out of support scope",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:jboss_operations_network:3"
    },
    {
      "product_name": "Red Hat JBoss SOA Platform 5",
      "fix_state": "Out of support scope",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:jboss_enterprise_soa_platform:5"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Will not fix",
      "package_name": "openshift4/ose-metering-presto",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat Process Automation 7",
      "fix_state": "Not affected",
      "package_name": "h2",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2022-01-04T00:00:00Z",
  "bugzilla": {
    "description": "CVE-2021-42392 h2: Remote Code Execution in Console",
    "id": "2039403",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2039403"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "9.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-502",
  "statement": "In OpenShift Container Platform (OCP) the openshift4/ose-metering-presto container image ships the vulnerable version of h2, but as it uses default configuration the impact by this vulnerability is LOW. Additionally, the Presto component is part of the OCP Metering stack and since the release of OCP 4.6, the Metering product has been deprecated [1], hence the affected component is marked as wontfix.\n[1] https://docs.openshift.com/container-platform/4.6/release_notes/ocp-4-6-release-notes.html#ocp-4-6-metering-operator-deprecated",
  "acknowledgement": "",
  "name": "CVE-2021-42392",
  "document_distribution": "",
  "details": [
    "The org.h2.util.JdbcUtils.getConnection method of the H2 database takes as parameters the class name of the driver and URL of the database. An attacker may pass a JNDI driver name and a URL leading to a LDAP or RMI servers, causing remote code execution. This can be exploited through various attack vectors, most notably through the H2 Console which leads to unauthenticated remote code execution.",
    "A flaw was found in h2. The org.h2.util.JdbcUtils.getConnection method of the H2 database takes as parameters the class name of the driver and URL of the database. This flaw allows an attacker to use this URL to send another serverâ€™s code, causing remote code execution. This issue is exploited through various attack vectors, most notably through the H2 Console, which leads to unauthenticated remote code execution."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-42392\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-42392\nhttps://github.com/h2database/h2database/security/advisories/GHSA-h376-j262-vhq6"
  ]
}