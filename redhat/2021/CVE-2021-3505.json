{
  "mitigation": "There is no mitigation for this issue. Upgrading to a fixed release (0.8.0+) is necessary but not sufficient. The only way to fix it is to unseal all data, delete the old TPM state file, generate a new one with the fixed key generation algorithm, then reseal the data.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 8 Advanced Virtualization",
      "fix_state": "Will not fix",
      "package_name": "virt:8.2/libtpms",
      "cpe": "cpe:/a:redhat:advanced_virtualization:8::el8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8 Advanced Virtualization",
      "fix_state": "Will not fix",
      "package_name": "virt:8.3/libtpms",
      "cpe": "cpe:/a:redhat:advanced_virtualization:8::el8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8 Advanced Virtualization",
      "fix_state": "Will not fix",
      "package_name": "virt:av/libtpms",
      "cpe": "cpe:/a:redhat:advanced_virtualization:8::el8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "libtpms",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Low",
  "public_date": "2020-04-14T00:00:00Z",
  "bugzilla": {
    "description": "libtpms: RSA keys weaker than expected",
    "id": "1950046",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1950046"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "4.0",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-331",
  "statement": "Versions of `libtpms` prior to 0.8.0 generate weaker than expected TPM 2 RSA keys due to the flawed key creation algorithm. Red Hat Enterprise Linux 8 Advanced Virtualization is therefore affected by this flaw, as it ships an older version of the package (0.7.x).",
  "acknowledgement": "",
  "name": "CVE-2021-3505",
  "document_distribution": "",
  "details": [
    "A flaw was found in libtpms in versions before 0.8.0. The TPM 2 implementation returns 2048 bit keys with ~1984 bit strength due to a bug in the TCG specification. The bug is in the key creation algorithm in RsaAdjustPrimeCandidate(), which is called before the prime number check. The highest threat from this vulnerability is to data confidentiality.",
    "A flaw was found in libtpms. The TPM 2 implementation returns 2048 bit keys with ~1984 bit strength due to a bug in the TCG specification. The bug is in the key creation algorithm in RsaAdjustPrimeCandidate(), which is called before the prime number check. The highest threat from this vulnerability is to data confidentiality."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-3505\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-3505"
  ]
}