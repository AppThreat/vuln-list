{
  "mitigation": "This vulnerability can be mitigated by preventing the flatpak-portal service from starting. Please note that this mitigation may prevent other Flatpak apps from working correctly.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2021-02-04T00:00:00Z",
      "advisory": "RHSA-2021:0411",
      "package": "flatpak-0:1.0.9-10.el7_9",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-02-01T00:00:00Z",
      "advisory": "RHSA-2021:0304",
      "package": "flatpak-0:1.6.2-5.el8_3",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.1 Extended Update Support",
      "release_date": "2021-02-01T00:00:00Z",
      "advisory": "RHSA-2021:0306",
      "package": "flatpak-0:1.0.9-3.el8_1",
      "cpe": "cpe:/a:redhat:rhel_eus:8.1"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
      "release_date": "2021-02-01T00:00:00Z",
      "advisory": "RHSA-2021:0307",
      "package": "flatpak-0:1.6.2-4.el8_2",
      "cpe": "cpe:/a:redhat:rhel_eus:8.2"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "flatpak",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2021-01-14T00:00:00Z",
  "bugzilla": {
    "description": "flatpak: sandbox escape via spawn portal",
    "id": "1917430",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1917430"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-77",
  "statement": "",
  "acknowledgement": "Red Hat would like to thank Simon McVittie (Collabora Ltd.) for reporting this issue.",
  "name": "CVE-2021-21261",
  "document_distribution": "",
  "details": [
    "Flatpak is a system for building, distributing, and running sandboxed desktop applications on Linux. A bug was discovered in the `flatpak-portal` service that can allow sandboxed applications to execute arbitrary code on the host system (a sandbox escape). This sandbox-escape bug is present in versions from 0.11.4 and before fixed versions 1.8.5 and 1.10.0. The Flatpak portal D-Bus service (`flatpak-portal`, also known by its D-Bus service name `org.freedesktop.portal.Flatpak`) allows apps in a Flatpak sandbox to launch their own subprocesses in a new sandbox instance, either with the same security settings as the caller or with more restrictive security settings. For example, this is used in Flatpak-packaged web browsers such as Chromium to launch subprocesses that will process untrusted web content, and give those subprocesses a more restrictive sandbox than the browser itself. In vulnerable versions, the Flatpak portal service passes caller-specified environment variables to non-sandboxed processes on the host system, and in particular to the `flatpak run` command that is used to launch the new sandbox instance. A malicious or compromised Flatpak app could set environment variables that are trusted by the `flatpak run` command, and use them to execute arbitrary code that is not in a sandbox. As a workaround, this vulnerability can be mitigated by preventing the `flatpak-portal` service from starting, but that mitigation will prevent many Flatpak apps from working correctly. This is fixed in versions 1.8.5 and 1.10.0.",
    "A flaw was found in Flatpak. The Flatpak portal D-Bus service passes caller-specified environment variables to non-sandboxed processes on the host system, and in particular to the `flatpak run` command that is used to launch the new sandbox instance. A malicious or compromised Flatpak app could set environment variables that are trusted by the `flatpak run` command, and use them to execute arbitrary code that is outside the sandbox. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-21261\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-21261\nhttps://github.com/flatpak/flatpak/security/advisories/GHSA-4ppf-fxf6-vxg2"
  ]
}