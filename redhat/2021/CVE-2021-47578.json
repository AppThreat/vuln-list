{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-06-19T00:00:00Z",
  "bugzilla": {
    "description": "kernel: scsi: scsi_debug: Don\u0026#39;t call kcalloc() if size arg is zero",
    "id": "2293251",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2293251"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2021-47578",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nscsi: scsi_debug: Don't call kcalloc() if size arg is zero\nIf the size arg to kcalloc() is zero, it returns ZERO_SIZE_PTR.  Because of\nthat, for a following NULL pointer check to work on the returned pointer,\nkcalloc() must not be called with the size arg equal to zero. Return early\nwithout error before the kcalloc() call if size arg is zero.\nBUG: KASAN: null-ptr-deref in memcpy include/linux/fortify-string.h:191 [inline]\nBUG: KASAN: null-ptr-deref in sg_copy_buffer+0x138/0x240 lib/scatterlist.c:974\nWrite of size 4 at addr 0000000000000010 by task syz-executor.1/22789\nCPU: 1 PID: 22789 Comm: syz-executor.1 Not tainted 5.15.0-syzk #1\nHardware name: Red Hat KVM, BIOS 1.13.0-2\nCall Trace:\n__dump_stack lib/dump_stack.c:88 [inline]\ndump_stack_lvl+0x89/0xb5 lib/dump_stack.c:106\n__kasan_report mm/kasan/report.c:446 [inline]\nkasan_report.cold.14+0x112/0x117 mm/kasan/report.c:459\ncheck_region_inline mm/kasan/generic.c:183 [inline]\nkasan_check_range+0x1a3/0x210 mm/kasan/generic.c:189\nmemcpy+0x3b/0x60 mm/kasan/shadow.c:66\nmemcpy include/linux/fortify-string.h:191 [inline]\nsg_copy_buffer+0x138/0x240 lib/scatterlist.c:974\ndo_dout_fetch drivers/scsi/scsi_debug.c:2954 [inline]\ndo_dout_fetch drivers/scsi/scsi_debug.c:2946 [inline]\nresp_verify+0x49e/0x930 drivers/scsi/scsi_debug.c:4276\nschedule_resp+0x4d8/0x1a70 drivers/scsi/scsi_debug.c:5478\nscsi_debug_queuecommand+0x8c9/0x1ec0 drivers/scsi/scsi_debug.c:7533\nscsi_dispatch_cmd drivers/scsi/scsi_lib.c:1520 [inline]\nscsi_queue_rq+0x16b0/0x2d40 drivers/scsi/scsi_lib.c:1699\nblk_mq_dispatch_rq_list+0xb9b/0x2700 block/blk-mq.c:1639\n__blk_mq_sched_dispatch_requests+0x28f/0x590 block/blk-mq-sched.c:325\nblk_mq_sched_dispatch_requests+0x105/0x190 block/blk-mq-sched.c:358\n__blk_mq_run_hw_queue+0xe5/0x150 block/blk-mq.c:1761\n__blk_mq_delay_run_hw_queue+0x4f8/0x5c0 block/blk-mq.c:1838\nblk_mq_run_hw_queue+0x18d/0x350 block/blk-mq.c:1891\nblk_mq_sched_insert_request+0x3db/0x4e0 block/blk-mq-sched.c:474\nblk_execute_rq_nowait+0x16b/0x1c0 block/blk-exec.c:62\nblk_execute_rq+0xdb/0x360 block/blk-exec.c:102\nsg_scsi_ioctl drivers/scsi/scsi_ioctl.c:621 [inline]\nscsi_ioctl+0x8bb/0x15c0 drivers/scsi/scsi_ioctl.c:930\nsg_ioctl_common+0x172d/0x2710 drivers/scsi/sg.c:1112\nsg_ioctl+0xa2/0x180 drivers/scsi/sg.c:1165\nvfs_ioctl fs/ioctl.c:51 [inline]\n__do_sys_ioctl fs/ioctl.c:874 [inline]\n__se_sys_ioctl fs/ioctl.c:860 [inline]\n__x64_sys_ioctl+0x19d/0x220 fs/ioctl.c:860\ndo_syscall_x64 arch/x86/entry/common.c:50 [inline]\ndo_syscall_64+0x3a/0x80 arch/x86/entry/common.c:80\nentry_SYSCALL_64_after_hwframe+0x44/0xae"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-47578\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-47578\nhttps://lore.kernel.org/linux-cve-announce/2024061915-CVE-2021-47578-e81a@gregkh/T"
  ]
}