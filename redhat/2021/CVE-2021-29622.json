{
  "affected_release": [
    {
      "product_name": "Red Hat OpenShift Container Platform 4.8",
      "release_date": "2021-07-27T00:00:00Z",
      "advisory": "RHSA-2021:2438",
      "package": "openshift4/ose-prometheus:v4.8.0-202106291913.p0.git.f3beb88.assembly.stream",
      "cpe": "cpe:/a:redhat:openshift:4.8::el8"
    }
  ],
  "package_state": [
    {
      "product_name": "OpenShift Service Mesh 2.0",
      "fix_state": "Not affected",
      "package_name": "servicemesh-prometheus",
      "cpe": "cpe:/a:redhat:service_mesh:2.0"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Not affected",
      "package_name": "golang-github-prometheus-prometheus",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2021-05-18T00:00:00Z",
  "bugzilla": {
    "description": "prometheus: open redirect under the /new endpoint",
    "id": "1962718",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1962718"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-601",
  "statement": "OpenShift Container Platform 3.11 and OpenShift Service Mesh uses Prometheus before 2.23.0 (when `/new` endpoint was introduced), hence are not affected by this flaw.",
  "acknowledgement": "",
  "name": "CVE-2021-29622",
  "document_distribution": "",
  "details": [
    "Prometheus is an open-source monitoring system and time series database. In 2.23.0, Prometheus changed its default UI to the New ui. To ensure a seamless transition, the URL's prefixed by /new redirect to /. Due to a bug in the code, it is possible for an attacker to craft an URL that can redirect to any other URL, in the /new endpoint. If a user visits a prometheus server with a specially crafted address, they can be redirected to an arbitrary URL. The issue was patched in the 2.26.1 and 2.27.1 releases. In 2.28.0, the /new endpoint will be removed completely. The workaround is to disable access to /new via a reverse proxy in front of Prometheus.",
    "An open redirect vulnerability was found in Prometheus. By specially crafted URL and a /new endpoint, an attacker can redirect user to any other URL."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-29622\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-29622"
  ]
}