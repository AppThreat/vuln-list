{
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-07-02T00:00:00Z",
      "advisory": "RHSA-2024:4211",
      "package": "kernel-0:4.18.0-553.8.1.el8_10",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Low",
  "public_date": "2024-02-27T00:00:00Z",
  "bugzilla": {
    "description": "kernel: ovl: fix leaked dentry",
    "id": "2266831",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2266831"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-402",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2021-46972",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\novl: fix leaked dentry\nSince commit 6815f479ca90 (\"ovl: use only uppermetacopy state in\novl_lookup()\"), overlayfs doesn't put temporary dentry when there is a\nmetacopy error, which leads to dentry leaks when shutting down the related\nsuperblock:\noverlayfs: refusing to follow metacopy origin for (/file0)\n...\nBUG: Dentry (____ptrval____){i=3f33,n=file3}  still in use (1) [unmount of overlay overlay]\n...\nWARNING: CPU: 1 PID: 432 at umount_check.cold+0x107/0x14d\nCPU: 1 PID: 432 Comm: unmount-overlay Not tainted 5.12.0-rc5 #1\n...\nRIP: 0010:umount_check.cold+0x107/0x14d\n...\nCall Trace:\nd_walk+0x28c/0x950\n? dentry_lru_isolate+0x2b0/0x2b0\n? __kasan_slab_free+0x12/0x20\ndo_one_tree+0x33/0x60\nshrink_dcache_for_umount+0x78/0x1d0\ngeneric_shutdown_super+0x70/0x440\nkill_anon_super+0x3e/0x70\ndeactivate_locked_super+0xc4/0x160\ndeactivate_super+0xfa/0x140\ncleanup_mnt+0x22e/0x370\n__cleanup_mnt+0x1a/0x30\ntask_work_run+0x139/0x210\ndo_exit+0xb0c/0x2820\n? __kasan_check_read+0x1d/0x30\n? find_held_lock+0x35/0x160\n? lock_release+0x1b6/0x660\n? mm_update_next_owner+0xa20/0xa20\n? reacquire_held_locks+0x3f0/0x3f0\n? __sanitizer_cov_trace_const_cmp4+0x22/0x30\ndo_group_exit+0x135/0x380\n__do_sys_exit_group.isra.0+0x20/0x20\n__x64_sys_exit_group+0x3c/0x50\ndo_syscall_64+0x45/0x70\nentry_SYSCALL_64_after_hwframe+0x44/0xae\n...\nVFS: Busy inodes after unmount of overlay. Self-destruct in 5 seconds.  Have a nice day...\nThis fix has been tested with a syzkaller reproducer."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-46972\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-46972\nhttps://lore.kernel.org/linux-cve-announce/2024022721-CVE-2021-46972-2ec2@gregkh/T/#u"
  ]
}