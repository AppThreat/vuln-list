{
  "mitigation": "This vulnerability can be mitigated by disabling the nested virtualization feature:\n```\n# modprobe -r kvm_amd\n# modprobe kvm_amd nested=0\n```\nDisabling VLS (Virtual VMLOAD/VMSAVE) is an alternative mitigation:\n```\n# modprobe kvm_amd vls=0\n```",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2021-10-12T00:00:00Z",
      "advisory": "RHSA-2021:3802",
      "package": "kernel-rt-0:3.10.0-1160.45.1.rt56.1185.el7",
      "cpe": "cpe:/a:redhat:rhel_extras_rt:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2021-10-12T00:00:00Z",
      "advisory": "RHSA-2021:3801",
      "package": "kernel-0:3.10.0-1160.45.1.el7",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.6 Advanced Update Support",
      "release_date": "2021-10-12T00:00:00Z",
      "advisory": "RHSA-2021:3812",
      "package": "kernel-0:3.10.0-957.84.1.el7",
      "cpe": "cpe:/o:redhat:rhel_aus:7.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.6 Telco Extended Update Support",
      "release_date": "2021-10-12T00:00:00Z",
      "advisory": "RHSA-2021:3812",
      "package": "kernel-0:3.10.0-957.84.1.el7",
      "cpe": "cpe:/o:redhat:rhel_tus:7.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.6 Update Services for SAP Solutions",
      "release_date": "2021-10-12T00:00:00Z",
      "advisory": "RHSA-2021:3812",
      "package": "kernel-0:3.10.0-957.84.1.el7",
      "cpe": "cpe:/o:redhat:rhel_e4s:7.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.7 Advanced Update Support",
      "release_date": "2021-10-26T00:00:00Z",
      "advisory": "RHSA-2021:3987",
      "package": "kernel-0:3.10.0-1062.59.1.el7",
      "cpe": "cpe:/o:redhat:rhel_aus:7.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.7 Telco Extended Update Support",
      "release_date": "2021-10-26T00:00:00Z",
      "advisory": "RHSA-2021:3987",
      "package": "kernel-0:3.10.0-1062.59.1.el7",
      "cpe": "cpe:/o:redhat:rhel_tus:7.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.7 Update Services for SAP Solutions",
      "release_date": "2021-10-26T00:00:00Z",
      "advisory": "RHSA-2021:3987",
      "package": "kernel-0:3.10.0-1062.59.1.el7",
      "cpe": "cpe:/o:redhat:rhel_e4s:7.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-11-02T00:00:00Z",
      "advisory": "RHSA-2021:4088",
      "package": "kernel-rt-0:4.18.0-305.25.1.rt7.97.el8_4",
      "cpe": "cpe:/a:redhat:enterprise_linux:8::nfv"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-11-02T00:00:00Z",
      "advisory": "RHSA-2021:4056",
      "package": "kernel-0:4.18.0-305.25.1.el8_4",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.1 Extended Update Support",
      "release_date": "2021-09-28T00:00:00Z",
      "advisory": "RHSA-2021:3676",
      "package": "kernel-0:4.18.0-147.56.1.el8_1",
      "cpe": "cpe:/o:redhat:rhel_eus:8.1"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
      "release_date": "2021-10-19T00:00:00Z",
      "advisory": "RHSA-2021:3909",
      "package": "kernel-rt-0:4.18.0-193.68.1.rt13.118.el8_2",
      "cpe": "cpe:/a:redhat:rhel_eus:8.2::nfv"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
      "release_date": "2021-10-19T00:00:00Z",
      "advisory": "RHSA-2021:3904",
      "package": "kernel-0:4.18.0-193.68.1.el8_2",
      "cpe": "cpe:/o:redhat:rhel_eus:8.2"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-alt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2021-08-16T12:00:00Z",
  "bugzilla": {
    "description": "kernel: SVM nested virtualization issue in KVM (VMLOAD/VMSAVE)",
    "id": "1983988",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1983988"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-862",
  "statement": "The nested virtualization feature is not enabled by default up to Red Hat Enterprise Linux 8.4. Most importantly, Red Hat currently provides nested virtualization only as a Technology Preview, and is therefore unsupported for production use. For additional details please see https://access.redhat.com/solutions/21101 and https://access.redhat.com/support/offerings/techpreview.",
  "acknowledgement": "This issue was discovered by Maxim Levitsky (Red Hat) and Paolo Bonzini (Red Hat).",
  "name": "CVE-2021-3656",
  "document_distribution": "",
  "details": [
    "A flaw was found in the KVM's AMD code for supporting SVM nested virtualization. The flaw occurs when processing the VMCB (virtual machine control block) provided by the L1 guest to spawn/handle a nested guest (L2). Due to improper validation of the \"virt_ext\" field, this issue could allow a malicious L1 to disable both VMLOAD/VMSAVE intercepts and VLS (Virtual VMLOAD/VMSAVE) for the L2 guest. As a result, the L2 guest would be allowed to read/write physical pages of the host, resulting in a crash of the entire system, leak of sensitive data or potential guest-to-host escape.",
    "A flaw was found in the KVM's AMD code for supporting SVM nested virtualization. The flaw occurs when processing the VMCB (virtual machine control block) provided by the L1 guest to spawn/handle a nested guest (L2). Due to improper validation of the \"virt_ext\" field, this issue could allow a malicious L1 to disable both VMLOAD/VMSAVE intercepts and VLS (Virtual VMLOAD/VMSAVE) for the L2 guest. As a result, the L2 guest would be allowed to read/write physical pages of the host, resulting in a crash of the entire system, leak of sensitive data or potential guest-to-host escape."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-3656\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-3656\nhttps://www.openwall.com/lists/oss-security/2021/08/16/1"
  ]
}