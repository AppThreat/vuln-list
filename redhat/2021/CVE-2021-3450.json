{
  "mitigation": "The following conditions have to be met for an application compiled with OpenSSL to be vulnerable:\n- the CA trusted by the system must issue or have issued certificates that don't include basic Key Usage extension.\n- the CA certificates must not have path length constraint set to a value that would limit the certificate chain to just the subscriber certificates (i.e. CA certificate just above the subscriber cert must not have 0 as the path length constraint, and any CA above it must not have it increase by more than 1 for every level in the hierarchy)\n- the attacker needs to have access to such subscriber certificate (without basic Key Usage and linking up to CAs without path length constraints or not effectively constraining certs issued by this certificate)\n- the application under attack must use the X509_V_FLAG_X509_STRICT flag and must not set purpose for the certificate verification\nif any of the above conditions are not met then the application compiled with OpenSSL is not vulnerable to the CVE.",
  "affected_release": [
    {
      "product_name": "JBCS 2.4.37 SP7",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1200",
      "package": "openssl",
      "cpe": "cpe:/a:redhat:jboss_core_services:1"
    },
    {
      "product_name": "JBoss Core Services on RHEL 7",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1199",
      "package": "jbcs-httpd24-httpd-0:2.4.37-70.jbcs.el7",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el7"
    },
    {
      "product_name": "JBoss Core Services on RHEL 7",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1199",
      "package": "jbcs-httpd24-mod_cluster-native-0:1.3.14-20.Final_redhat_2.jbcs.el7",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el7"
    },
    {
      "product_name": "JBoss Core Services on RHEL 7",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1199",
      "package": "jbcs-httpd24-mod_http2-0:1.15.7-14.jbcs.el7",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el7"
    },
    {
      "product_name": "JBoss Core Services on RHEL 7",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1199",
      "package": "jbcs-httpd24-mod_jk-0:1.2.48-13.redhat_1.jbcs.el7",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el7"
    },
    {
      "product_name": "JBoss Core Services on RHEL 7",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1199",
      "package": "jbcs-httpd24-mod_md-1:2.0.8-33.jbcs.el7",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el7"
    },
    {
      "product_name": "JBoss Core Services on RHEL 7",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1199",
      "package": "jbcs-httpd24-mod_security-0:2.9.2-60.GA.jbcs.el7",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el7"
    },
    {
      "product_name": "JBoss Core Services on RHEL 7",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1199",
      "package": "jbcs-httpd24-nghttp2-0:1.39.2-37.jbcs.el7",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el7"
    },
    {
      "product_name": "JBoss Core Services on RHEL 7",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1199",
      "package": "jbcs-httpd24-openssl-1:1.1.1g-6.jbcs.el7",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el7"
    },
    {
      "product_name": "JBoss Core Services on RHEL 7",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1199",
      "package": "jbcs-httpd24-openssl-chil-0:1.0.0-5.jbcs.el7",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el7"
    },
    {
      "product_name": "JBoss Core Services on RHEL 7",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1199",
      "package": "jbcs-httpd24-openssl-pkcs11-0:0.4.10-20.jbcs.el7",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-03-30T00:00:00Z",
      "advisory": "RHSA-2021:1024",
      "package": "openssl-1:1.1.1g-15.el8_3",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat JBoss Web Server 3.1",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1203",
      "package": "openssl",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:3.1"
    },
    {
      "product_name": "Red Hat JBoss Web Server 3 for RHEL 7",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1202",
      "package": "tomcat-native-0:1.2.23-24.redhat_24.ep7.el7",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:3.1::el7"
    },
    {
      "product_name": "Red Hat JBoss Web Server 5",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1196",
      "package": "openssl",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5.4"
    },
    {
      "product_name": "Red Hat JBoss Web Server 5.4 on RHEL 7",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1195",
      "package": "jws5-tomcat-native-0:1.2.25-4.redhat_4.el7jws",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5.4::el7"
    },
    {
      "product_name": "Red Hat JBoss Web Server 5.4 on RHEL 8",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1195",
      "package": "jws5-tomcat-native-0:1.2.25-4.redhat_4.el8jws",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5.4::el8"
    },
    {
      "product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 8",
      "release_date": "2021-04-14T00:00:00Z",
      "advisory": "RHSA-2021:1189",
      "package": "redhat-virtualization-host-0:4.4.5-20210330.0.el8_3",
      "cpe": "cpe:/o:redhat:enterprise_linux:8::hypervisor"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "openssl",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "openssl098e",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "openssl",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "openssl098e",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "compat-openssl10",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "openssl",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2021-03-25T00:00:00Z",
  "bugzilla": {
    "description": "openssl: CA certificate check bypass with X509_V_FLAG_X509_STRICT",
    "id": "1941547",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1941547"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.4",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-295",
  "statement": "This flaw affects openssl  1.1.1h  and above only, older versions are not affected by this flaw.",
  "acknowledgement": "Red Hat would like to thank the OpenSSL Project for reporting this issue. Upstream acknowledges Benjamin Kaduk and Xiang Ding and others (Akamai) as the original reporters.",
  "name": "CVE-2021-3450",
  "document_distribution": "",
  "details": [
    "The X509_V_FLAG_X509_STRICT flag enables additional security checks of the certificates present in a certificate chain. It is not set by default. Starting from OpenSSL version 1.1.1h a check to disallow certificates in the chain that have explicitly encoded elliptic curve parameters was added as an additional strict check. An error in the implementation of this check meant that the result of a previous check to confirm that certificates in the chain are valid CA certificates was overwritten. This effectively bypasses the check that non-CA certificates must not be able to issue other certificates. If a \"purpose\" has been configured then there is a subsequent opportunity for checks that the certificate is a valid CA. All of the named \"purpose\" values implemented in libcrypto perform this check. Therefore, where a purpose is set the certificate chain will still be rejected even when the strict flag has been used. A purpose is set by default in libssl client and server certificate verification routines, but it can be overridden or removed by an application. In order to be affected, an application must explicitly set the X509_V_FLAG_X509_STRICT verification flag and either not set a purpose for the certificate verification or, in the case of TLS client or server applications, override the default purpose. OpenSSL versions 1.1.1h and newer are affected by this issue. Users of these versions should upgrade to OpenSSL 1.1.1k. OpenSSL 1.0.2 is not impacted by this issue. Fixed in OpenSSL 1.1.1k (Affected 1.1.1h-1.1.1j).",
    "A flaw was found in openssl. The flag that enables additional security checks of certificates present in a certificate chain was not enabled allowing a confirmation step to verify that certificates in the chain are valid CA certificates is bypassed. The highest threat from this vulnerability is to data confidentiality and integrity."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-3450\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-3450\nhttps://www.openssl.org/news/secadv/20210325.txt"
  ]
}