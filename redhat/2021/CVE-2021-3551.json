{
  "mitigation": "Manually delete or restrict permission to `other` in the installation log file : \n$ rm /var/log/pki/pki-ca-spawn*\n- OR, if you need to keep the installation logs :\n$ chmod o-rwx /var/log/pki/pki-ca-spawn*",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-06-03T00:00:00Z",
      "advisory": "RHSA-2021:2235",
      "package": "pki-core:10.6-8040020210519185901.17df0a3f",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Certificate System 10",
      "fix_state": "Affected",
      "package_name": "pki-core",
      "cpe": "cpe:/a:redhat:certificate_system:10"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "pki-core",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "pki-core",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "pki-core",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2021-06-03T06:00:00Z",
  "bugzilla": {
    "description": "pki-server: Dogtag installer \"pkispawn\" logs admin credentials into a world-readable log file",
    "id": "1959971",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1959971"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-312",
  "statement": "In Red Hat Identity Management, this flaw affects only new installation made using Red Hat Enterprise Linux 8.4. This issue is considered important in IdM, as its installation is done in Debug mode. The leaked credentials would allow any user with Low privileges to have full control of the managed domain(s).\nIn Red Hat Certificate System, this flaw affects only new installation of RHCS 10.2, when `pkispawn` is started in Debug mode. This issue is considered with Low severity as this is not the default, and Certificate System should be isolated from regular users.\nExisting installation are not affected.",
  "acknowledgement": "Red Hat would like to thank Christian Heimes for reporting this issue.",
  "name": "CVE-2021-3551",
  "document_distribution": "",
  "details": [
    "A flaw was found in the PKI-server, where the spkispawn command, when run in debug mode, stores admin credentials in the installation log file. This flaw allows a local attacker to retrieve the file to obtain the admin password and gain admin privileges to the Dogtag CA manager. The highest threat from this vulnerability is to confidentiality.",
    "A flaw was found in the PKI-server, where the spkispawn command, when run in debug mode, stores admin credentials in the installation log file. This flaw allows a local attacker to retrieve the file to obtain the admin password and gain admin privileges to the Dogtag CA manager. The highest threat from this vulnerability is to confidentiality."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-3551\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-3551"
  ]
}