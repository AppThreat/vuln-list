{
  "mitigation": "Depending on the version of XStream used there are various usage patterns that mitigate this flaw, though we would strongly recommend using the allow list approach if at all possible as there are likely more class combinations the deny list approach may not address.\nAllow list approach\n```java\nXStream xstream = new XStream();\nXStream.setupDefaultSecurity(xstream);\nxstream.allowTypesByWildcard(new String[] {\"com.misc.classname\"})\n```\nDeny list for XStream 1.4.16 (this should also address some previous flaws found in 1.4.7 - \u003e 1.4.15) \n```java\nxstream.denyTypesByRegExp(new String[]{ \".*\\\\.Lazy(?:Search)?Enumeration.*\", \"(?:java|sun)\\\\.rmi\\\\..*\" });\n```\nDeny list for XStream 1.4.15\n```java\nxstream.denyTypes(new String[]{ \"sun.awt.datatransfer.DataTransferer$IndexOrderComparator\", \"sun.swing.SwingLazyValue\", \"com.sun.corba.se.impl.activation.ServerTableEntry\", \"com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator\" });\nxstream.denyTypesByRegExp(new String[]{ \".*\\\\$ServiceNameIterator\", \"javafx\\\\.collections\\\\.ObservableList\\\\$.*\", \".*\\\\.bcel\\\\..*\\\\.util\\\\.ClassLoader\" });\nxstream.denyTypeHierarchy(java.io.InputStream.class );\nxstream.denyTypeHierarchy(java.nio.channels.Channel.class );\nxstream.denyTypeHierarchy(javax.activation.DataSource.class );\nxstream.denyTypeHierarchy(javax.sql.rowset.BaseRowSet.class );\n```\nDeny list for XStream 1.4.13\n```java\nxstream.denyTypes(new String[]{ \"javax.imageio.ImageIO$ContainsFilter\" });\nxstream.denyTypes(new Class[]{ java.lang.ProcessBuilder.class });\n```\nDeny list for XStream 1.4.7 -\u003e 1.4.12\n```java\nxstream.denyTypes(new String[]{ \"javax.imageio.ImageIO$ContainsFilter\" });\nxstream.denyTypes(new Class[]{ java.lang.ProcessBuilder.class, java.beans.EventHandler.class, java.lang.ProcessBuilder.class, java.lang.Void.class, void.class });\n```\nDeny list for versions prior to XStream 1.4.7\n```java\nxstream.registerConverter(new Converter() {\npublic boolean canConvert(Class type) {\nreturn type != null \u0026\u0026 (type == java.beans.EventHandler.class || type == java.lang.ProcessBuilder.class || type == java.lang.Void.class || void.class || type.getName().equals(\"javax.imageio.ImageIO$ContainsFilter\") || Proxy.isProxy(type));\n}\npublic Object unmarshal(HierarchicalStreamReader reader, UnmarshallingContext context) {\nthrow new ConversionException(\"Unsupported type due to security reasons.\");\n}\npublic void marshal(Object source, HierarchicalStreamWriter writer, MarshallingContext context) {\nthrow new ConversionException(\"Unsupported type due to security reasons.\");\n}\n}, XStream.PRIORITY_LOW);\n```",
  "affected_release": [
    {
      "product_name": "Red Hat Data Grid 8.3.0",
      "release_date": "2022-02-14T00:00:00Z",
      "advisory": "RHSA-2022:0520",
      "package": "xstream",
      "cpe": "cpe:/a:redhat:jboss_data_grid:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2021-07-12T00:00:00Z",
      "advisory": "RHSA-2021:2683",
      "package": "xstream-0:1.3.1-14.el7_9",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Fuse 7.11",
      "release_date": "2022-07-07T00:00:00Z",
      "advisory": "RHSA-2022:5532",
      "package": "xstream",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat Integration",
      "release_date": "2021-12-02T00:00:00Z",
      "advisory": "RHSA-2021:4918",
      "package": "xstream",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat Integration Camel Quarkus",
      "release_date": "2021-11-23T00:00:00Z",
      "advisory": "RHSA-2021:4767",
      "package": "xstream",
      "cpe": "cpe:/a:redhat:camel_quarkus:2.2"
    },
    {
      "product_name": "RHDM 7.12.0",
      "release_date": "2022-01-26T00:00:00Z",
      "advisory": "RHSA-2022:0297",
      "package": "xstream",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7.12"
    },
    {
      "product_name": "RHPAM 7.12.0",
      "release_date": "2022-01-26T00:00:00Z",
      "advisory": "RHSA-2022:0296",
      "package": "xstream",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7.12"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat BPM Suite 6",
      "fix_state": "Will not fix",
      "package_name": "xstream",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:6"
    },
    {
      "product_name": "Red Hat CodeReady Studio 12",
      "fix_state": "Affected",
      "package_name": "xstream",
      "cpe": "cpe:/a:redhat:jboss_developer_studio:12."
    },
    {
      "product_name": "Red Hat JBoss A-MQ 6",
      "fix_state": "Out of support scope",
      "package_name": "xstream",
      "cpe": "cpe:/a:redhat:jboss_amq:6"
    },
    {
      "product_name": "Red Hat JBoss BRMS 5",
      "fix_state": "Will not fix",
      "package_name": "xstream",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:5"
    },
    {
      "product_name": "Red Hat JBoss BRMS 6",
      "fix_state": "Will not fix",
      "package_name": "xstream",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Data Grid 7",
      "fix_state": "Out of support scope",
      "package_name": "xstream",
      "cpe": "cpe:/a:redhat:jboss_data_grid:7"
    },
    {
      "product_name": "Red Hat JBoss Data Virtualization 6",
      "fix_state": "Will not fix",
      "package_name": "xstream",
      "cpe": "cpe:/a:redhat:jboss_data_virtualization:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse 6",
      "fix_state": "Out of support scope",
      "package_name": "xstream",
      "cpe": "cpe:/a:redhat:jboss_fuse:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse Service Works 6",
      "fix_state": "Out of support scope",
      "package_name": "xstream",
      "cpe": "cpe:/a:redhat:jboss_fuse_service_works:6"
    },
    {
      "product_name": "Red Hat JBoss SOA Platform 5",
      "fix_state": "Will not fix",
      "package_name": "xstream",
      "cpe": "cpe:/a:redhat:jboss_enterprise_soa_platform:5"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Not affected",
      "package_name": "jenkins",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Not affected",
      "package_name": "jenkins",
      "cpe": "cpe:/a:redhat:openshift:4"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2021-05-14T00:00:00Z",
  "bugzilla": {
    "description": "XStream: remote command execution attack by manipulating the processed input stream",
    "id": "1966735",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1966735"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-94-\u003eCWE-502",
  "statement": "OpenShift Container Platform (OCP) delivers Jenkins LTS package with bundled XStream library. Due to JEP-200 [1] and JEP-228 [2] Jenkins projects, OCP Jenkins package is not affected by this flaw.\nCodeReady Studio 12 ships a version of xstream that is affected by this flaw as a transitive dependency for the Wise framework plugin. However, the vulnerable code is not called, so this flaw has been marked as Low severity for CodeReady Studio 12.\n[1] https://github.com/jenkinsci/jep/blob/master/jep/200/README.adoc\n[2] https://github.com/jenkinsci/jep/blob/master/jep/228/README.adoc#security",
  "acknowledgement": "",
  "name": "CVE-2021-29505",
  "document_distribution": "",
  "details": [
    "XStream is software for serializing Java objects to XML and back again. A vulnerability in XStream versions prior to 1.4.17 may allow a remote attacker has sufficient rights to execute commands of the host only by manipulating the processed input stream. No user who followed the recommendation to setup XStream's security framework with a whitelist limited to the minimal required types is affected. The vulnerability is patched in version 1.4.17.",
    "A flaw was found in XStream. By manipulating the processed input stream, a remote attacker may be able to obtain sufficient rights to execute commands. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-29505\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-29505\nhttps://github.com/x-stream/xstream/security/advisories/GHSA-7chv-rrw6-w6fc\nhttps://x-stream.github.io/CVE-2021-29505.html"
  ]
}