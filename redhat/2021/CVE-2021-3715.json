{
  "mitigation": "In order to mitigate this issue, it is possible to prevent the affected code from being loaded by blacklisting the kernel module cls_route.ko. For instructions relating to how to blacklist a kernel module refer to: https://access.redhat.com/solutions/41278.\nAlternatively, if cls_route is being used, on Red Hat Enterprise Linux 8, you can disable unprivileged user namespaces by setting user.max_user_namespaces to 0:\n# echo \"user.max_user_namespaces=0\" \u003e /etc/sysctl.d/userns.conf\n# sysctl -p /etc/sysctl.d/userns.conf",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2021-09-07T00:00:00Z",
      "advisory": "RHSA-2021:3439",
      "package": "kernel-rt-0:3.10.0-1160.42.2.rt56.1182.el7",
      "cpe": "cpe:/a:redhat:rhel_extras_rt:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2021-09-07T00:00:00Z",
      "advisory": "RHSA-2021:3438",
      "package": "kernel-0:3.10.0-1160.42.2.el7",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2021-09-07T00:00:00Z",
      "advisory": "RHSA-2021:3441",
      "package": "kpatch-patch",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.6 Update Services for SAP Solutions",
      "release_date": "2022-10-25T00:00:00Z",
      "advisory": "RHSA-2022:7173",
      "package": "kpatch-patch",
      "cpe": "cpe:/o:redhat:rhel_e4s:7.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2020-11-04T00:00:00Z",
      "advisory": "RHSA-2020:4609",
      "package": "kernel-rt-0:4.18.0-240.rt7.54.el8",
      "cpe": "cpe:/a:redhat:enterprise_linux:8::nfv"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2020-11-04T00:00:00Z",
      "advisory": "RHSA-2020:4431",
      "package": "kernel-0:4.18.0-240.el8",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.1 Extended Update Support",
      "release_date": "2021-09-07T00:00:00Z",
      "advisory": "RHSA-2021:3442",
      "package": "kpatch-patch",
      "cpe": "cpe:/o:redhat:rhel_eus:8.1"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.1 Extended Update Support",
      "release_date": "2021-09-07T00:00:00Z",
      "advisory": "RHSA-2021:3444",
      "package": "kernel-0:4.18.0-147.54.2.el8_1",
      "cpe": "cpe:/o:redhat:rhel_eus:8.1"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
      "release_date": "2021-09-07T00:00:00Z",
      "advisory": "RHSA-2021:3445",
      "package": "kernel-rt-0:4.18.0-193.65.2.rt13.117.el8_2",
      "cpe": "cpe:/a:redhat:rhel_eus:8.2::nfv"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
      "release_date": "2021-09-07T00:00:00Z",
      "advisory": "RHSA-2021:3443",
      "package": "kpatch-patch",
      "cpe": "cpe:/o:redhat:rhel_eus:8.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
      "release_date": "2021-09-07T00:00:00Z",
      "advisory": "RHSA-2021:3446",
      "package": "kernel-0:4.18.0-193.65.2.el8_2",
      "cpe": "cpe:/o:redhat:rhel_eus:8.2"
    },
    {
      "product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 7",
      "release_date": "2021-09-09T00:00:00Z",
      "advisory": "RHSA-2021:3477",
      "package": "redhat-virtualization-host-0:4.3.18-20210903.0.el7_9",
      "cpe": "cpe:/o:redhat:enterprise_linux:7::hypervisor"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-alt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2021-09-07T08:25:00Z",
  "bugzilla": {
    "description": "kernel: use-after-free in route4_change() in net/sched/cls_route.c",
    "id": "1993988",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1993988"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-416",
  "statement": "This flaw is rated as having Moderate impact (Red Hat Enterprise Linux 7 and lower) because of the need to have CAP_NET_ADMIN privileges and that Red Hat Enterprise Linux 7 disabled unprivileged user/network namespaces by default.\nThis flaw is rated as having Important impact (Red Hat Enterprise Linux 8) because Red Hat Enterprise Linux 8 enabled unprivileged user/network namespaces by default which can be used to gain CAP_NET_ADMIN privileges in corresponding user namespace even for otherwise unprivileged local user and thus exercise this vulnerability.",
  "acknowledgement": "Red Hat would like to thank Zhenpeng Lin for reporting this issue.",
  "name": "CVE-2021-3715",
  "document_distribution": "",
  "details": [
    "A flaw was found in the \"Routing decision\" classifier in the Linux kernel's Traffic Control networking subsystem in the way it handled changing of classification filters, leading to a use-after-free condition. This flaw allows unprivileged local users to escalate their privileges on the system. The highest threat from this vulnerability is to confidentiality, integrity, as well as system availability.",
    "A flaw was found in the \"Routing decision\" classifier in the Linux kernel's Traffic Control networking subsystem in the way it handled changing of classification filters, leading to a use-after-free condition. This flaw allows unprivileged local users to escalate their privileges on the system. The highest threat from this vulnerability is to confidentiality, integrity, as well as system availability."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-3715\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-3715\nhttps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=ef299cc3fa1a9e1288665a9fdc8bff55629fd359"
  ]
}