{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Under investigation",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Under investigation",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Under investigation",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Under investigation",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-03-01T00:00:00Z",
  "bugzilla": {
    "description": "kernel: RDMA/rxe: Clear all QP fields if creation failed",
    "id": "2267529",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2267529"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2021-47078",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nRDMA/rxe: Clear all QP fields if creation failed\nrxe_qp_do_cleanup() relies on valid pointer values in QP for the properly\ncreated ones, but in case rxe_qp_from_init() failed it was filled with\ngarbage and caused tot the following error.\nrefcount_t: underflow; use-after-free.\nWARNING: CPU: 1 PID: 12560 at lib/refcount.c:28 refcount_warn_saturate+0x1d1/0x1e0 lib/refcount.c:28\nModules linked in:\nCPU: 1 PID: 12560 Comm: syz-executor.4 Not tainted 5.12.0-syzkaller #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011\nRIP: 0010:refcount_warn_saturate+0x1d1/0x1e0 lib/refcount.c:28\nCode: e9 db fe ff ff 48 89 df e8 2c c2 ea fd e9 8a fe ff ff e8 72 6a a7 fd 48 c7 c7 e0 b2 c1 89 c6 05 dc 3a e6 09 01 e8 ee 74 fb 04 \u003c0f\u003e 0b e9 af fe ff ff 0f 1f 84 00 00 00 00 00 41 56 41 55 41 54 55\nRSP: 0018:ffffc900097ceba8 EFLAGS: 00010286\nRAX: 0000000000000000 RBX: 0000000000000000 RCX: 0000000000000000\nRDX: 0000000000040000 RSI: ffffffff815bb075 RDI: fffff520012f9d67\nRBP: 0000000000000003 R08: 0000000000000000 R09: 0000000000000000\nR10: ffffffff815b4eae R11: 0000000000000000 R12: ffff8880322a4800\nR13: ffff8880322a4940 R14: ffff888033044e00 R15: 0000000000000000\nFS:  00007f6eb2be3700(0000) GS:ffff8880b9d00000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007fdbe5d41000 CR3: 000000001d181000 CR4: 00000000001506e0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n__refcount_sub_and_test include/linux/refcount.h:283 [inline]\n__refcount_dec_and_test include/linux/refcount.h:315 [inline]\nrefcount_dec_and_test include/linux/refcount.h:333 [inline]\nkref_put include/linux/kref.h:64 [inline]\nrxe_qp_do_cleanup+0x96f/0xaf0 drivers/infiniband/sw/rxe/rxe_qp.c:805\nexecute_in_process_context+0x37/0x150 kernel/workqueue.c:3327\nrxe_elem_release+0x9f/0x180 drivers/infiniband/sw/rxe/rxe_pool.c:391\nkref_put include/linux/kref.h:65 [inline]\nrxe_create_qp+0x2cd/0x310 drivers/infiniband/sw/rxe/rxe_verbs.c:425\n_ib_create_qp drivers/infiniband/core/core_priv.h:331 [inline]\nib_create_named_qp+0x2ad/0x1370 drivers/infiniband/core/verbs.c:1231\nib_create_qp include/rdma/ib_verbs.h:3644 [inline]\ncreate_mad_qp+0x177/0x2d0 drivers/infiniband/core/mad.c:2920\nib_mad_port_open drivers/infiniband/core/mad.c:3001 [inline]\nib_mad_init_device+0xd6f/0x1400 drivers/infiniband/core/mad.c:3092\nadd_client_context+0x405/0x5e0 drivers/infiniband/core/device.c:717\nenable_device_and_get+0x1cd/0x3b0 drivers/infiniband/core/device.c:1331\nib_register_device drivers/infiniband/core/device.c:1413 [inline]\nib_register_device+0x7c7/0xa50 drivers/infiniband/core/device.c:1365\nrxe_register_device+0x3d5/0x4a0 drivers/infiniband/sw/rxe/rxe_verbs.c:1147\nrxe_add+0x12fe/0x16d0 drivers/infiniband/sw/rxe/rxe.c:247\nrxe_net_add+0x8c/0xe0 drivers/infiniband/sw/rxe/rxe_net.c:503\nrxe_newlink drivers/infiniband/sw/rxe/rxe.c:269 [inline]\nrxe_newlink+0xb7/0xe0 drivers/infiniband/sw/rxe/rxe.c:250\nnldev_newlink+0x30e/0x550 drivers/infiniband/core/nldev.c:1555\nrdma_nl_rcv_msg+0x36d/0x690 drivers/infiniband/core/netlink.c:195\nrdma_nl_rcv_skb drivers/infiniband/core/netlink.c:239 [inline]\nrdma_nl_rcv+0x2ee/0x430 drivers/infiniband/core/netlink.c:259\nnetlink_unicast_kernel net/netlink/af_netlink.c:1312 [inline]\nnetlink_unicast+0x533/0x7d0 net/netlink/af_netlink.c:1338\nnetlink_sendmsg+0x856/0xd90 net/netlink/af_netlink.c:1927\nsock_sendmsg_nosec net/socket.c:654 [inline]\nsock_sendmsg+0xcf/0x120 net/socket.c:674\n____sys_sendmsg+0x6e8/0x810 net/socket.c:2350\n___sys_sendmsg+0xf3/0x170 net/socket.c:2404\n__sys_sendmsg+0xe5/0x1b0 net/socket.c:2433\ndo_syscall_64+0x3a/0xb0 arch/x86/entry/common.c:47\nentry_SYSCALL_64_after_hwframe+0\n---truncated---"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-47078\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-47078\nhttps://lore.kernel.org/linux-cve-announce/2024030142-CVE-2021-47078-71f9@gregkh/T/#u"
  ]
}