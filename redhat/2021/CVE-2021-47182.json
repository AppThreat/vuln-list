{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-04-10T00:00:00Z",
  "bugzilla": {
    "description": "kernel: scsi: core: Fix scsi_mode_sense() buffer length handling",
    "id": "2274627",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2274627"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2021-47182",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nscsi: core: Fix scsi_mode_sense() buffer length handling\nSeveral problems exist with scsi_mode_sense() buffer length handling:\n1) The allocation length field of the MODE SENSE(10) command is 16-bits,\noccupying bytes 7 and 8 of the CDB. With this command, access to mode\npages larger than 255 bytes is thus possible. However, the CDB\nallocation length field is set by assigning len to byte 8 only, thus\ntruncating buffer length larger than 255.\n2) If scsi_mode_sense() is called with len smaller than 8 with\nsdev-\u003euse_10_for_ms set, or smaller than 4 otherwise, the buffer length\nis increased to 8 and 4 respectively, and the buffer is zero filled\nwith these increased values, thus corrupting the memory following the\nbuffer.\nFix these 2 problems by using put_unaligned_be16() to set the allocation\nlength field of MODE SENSE(10) CDB and by returning an error when len is\ntoo small.\nFurthermore, if len is larger than 255B, always try MODE SENSE(10) first,\neven if the device driver did not set sdev-\u003euse_10_for_ms. In case of\ninvalid opcode error for MODE SENSE(10), access to mode pages larger than\n255 bytes are not retried using MODE SENSE(6). To avoid buffer length\noverflows for the MODE_SENSE(10) case, check that len is smaller than 65535\nbytes.\nWhile at it, also fix the folowing:\n* Use get_unaligned_be16() to retrieve the mode data length and block\ndescriptor length fields of the mode sense reply header instead of using\nan open coded calculation.\n* Fix the kdoc dbd argument explanation: the DBD bit stands for Disable\nBlock Descriptor, which is the opposite of what the dbd argument\ndescription was."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-47182\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-47182\nhttps://lore.kernel.org/linux-cve-announce/2024041032-CVE-2021-47182-377e@gregkh/T"
  ]
}