{
  "mitigation": "The following mitigation is suggested by upstream.\nThe samba-tool command and the AD DC mode honours the undocumented \"gensec_gssapi:delegation=no\" option in the [global] section of the smb.conf file.\nControlling Kerberos forwarding\n===============================\nIn the Active Directory world it's possible for administrators to\nlimit the delegation. User and computer objects can both act as\nKerberos users and also as Kerberos services. Both types of objects have an\nattribute called 'userAccountControl' which is a bitmask that controls the\nbehavior of the account. The following three values have impact on possible\ndelegation:\n0x00100000: UF_NOT_DELEGATED:\nThe UF_NOT_DELEGATED can be used to disable the ability to get forwardable TGT\nfor the account. It means the KDC will respond with an error if the client asks\nfor the forwardable ticket.  The client typically gives up and removes the\nGSS_C_DELEG_FLAG flag and continues without passing delegated credentials.\nAdministrators can use this to disable possible delegation for the most\nprivileged accounts (e.g. administrator accounts).\n0x00080000: UF_TRUSTED_FOR_DELEGATION\nIf the UF_TRUSTED_FOR_DELEGATION is set on an account a KDC will include the\nOK_AS_DELEGATE flag in a granted service ticket. If the client application\nuses just GSS_C_DELEG_POLICY_FLAG (instead of GSS_C_DELEG_FLAG) gssapi/Kerberos\nlibraries typically only include delegated credentials when the service ticket\nincludes the OK_AS_DELEGATE flag.  Administrators can use this to control which\nservices will get delegated credentials, for example if the service runs in a\ntrusted environment and actually requires the presence of delegated\ncredentials.\n0x01000000: UF_TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION\nThe UF_TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION is not really relevant for this\nCVE and just listed here for completeness. This flag is relevant for the\nS4U2Proxy feature, where a service can ask the KDC for a proxied service\nticket which can impersonate users to other services.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "release_date": "2017-03-21T00:00:00Z",
      "advisory": "RHSA-2017:0662",
      "package": "samba-0:3.6.23-41.el6",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "release_date": "2017-03-21T00:00:00Z",
      "advisory": "RHSA-2017:0744",
      "package": "samba4-0:4.2.10-9.el6",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2017-05-22T00:00:00Z",
      "advisory": "RHSA-2017:1265",
      "package": "samba-0:4.4.4-13.el7_3",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.2 for RHEL 6",
      "release_date": "2017-03-23T00:00:00Z",
      "advisory": "RHSA-2017:0494",
      "package": "samba-0:4.4.6-4.el6rhs",
      "cpe": "cpe:/a:redhat:storage:3.2:samba:el6"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.2 for RHEL 7",
      "release_date": "2017-03-23T00:00:00Z",
      "advisory": "RHSA-2017:0495",
      "package": "samba-0:4.4.6-4.el7rhgs",
      "cpe": "cpe:/a:redhat:storage:3.2:samba:el7"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Will not fix",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Will not fix",
      "package_name": "samba3x",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.1",
      "fix_state": "Affected",
      "package_name": "samba",
      "cpe": "cpe:/a:redhat:storage:3.1"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2016-12-19T00:00:00Z",
  "bugzilla": {
    "description": "samba: Unconditional privilege delegation to Kerberos servers in trusted realms",
    "id": "1403114",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1403114"
  },
  "cvss": {
    "cvss_base_score": "4.3",
    "cvss_scoring_vector": "AV:A/AC:M/Au:N/C:P/I:P/A:N",
    "status": "verified"
  },
  "cvss3": {
    "cvss3_base_score": "6.4",
    "cvss3_scoring_vector": "CVSS:3.0/AV:A/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-287",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2016-2125",
  "document_distribution": "",
  "details": [
    "It was found that Samba before versions 4.5.3, 4.4.8, 4.3.13 always requested forwardable tickets when using Kerberos authentication. A service to which Samba authenticated using Kerberos could subsequently use the ticket to impersonate Samba to other services or domain users.",
    "It was found that Samba always requested forwardable tickets when using Kerberos authentication. A service to which Samba authenticated using Kerberos could subsequently use the ticket to impersonate Samba to other services or domain users."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2016-2125\nhttps://nvd.nist.gov/vuln/detail/CVE-2016-2125\nhttps://www.samba.org/samba/security/CVE-2016-2125.html"
  ]
}