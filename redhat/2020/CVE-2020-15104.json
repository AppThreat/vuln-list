{
  "affected_release": [
    {
      "product_name": "OpenShift Service Mesh 1.1",
      "release_date": "2020-07-22T00:00:00Z",
      "advisory": "RHSA-2020:3090",
      "package": "servicemesh-proxy-0:1.1.5-1.el8",
      "cpe": "cpe:/a:redhat:service_mesh:1.1::el8"
    }
  ],
  "package_state": null,
  "threat_severity": "Moderate",
  "public_date": "2020-07-08T00:00:00Z",
  "bugzilla": {
    "description": "envoyproxy/envoy: incorrectly validates TLS certificates when using wildcards for DNS SAN's",
    "id": "1856232",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1856232"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.6",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:L/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-297",
  "statement": "For OpenShift ServiceMesh to be affected by this vulnerability, it must be configured to validate externally issued certificates. By default, ServiceMesh does not issue certificates that use DNS wildcard SANs.",
  "acknowledgement": "Red Hat would like to thank the Envoy Security Team for reporting this issue.",
  "name": "CVE-2020-15104",
  "document_distribution": "",
  "details": [
    "In Envoy before versions 1.12.6, 1.13.4, 1.14.4, and 1.15.0 when validating TLS certificates, Envoy would incorrectly allow a wildcard DNS Subject Alternative Name apply to multiple subdomains. For example, with a SAN of *.example.com, Envoy would incorrectly allow nested.subdomain.example.com, when it should only allow subdomain.example.com. This defect applies to both validating a client TLS certificate in mTLS, and validating a server TLS certificate for upstream connections. This vulnerability is only applicable to situations where an untrusted entity can obtain a signed wildcard TLS certificate for a domain of which you only intend to trust a subdomain of. For example, if you intend to trust api.mysubdomain.example.com, and an untrusted actor can obtain a signed TLS certificate for *.example.com or *.com. Configurations are vulnerable if they use verify_subject_alt_name in any Envoy version, or if they use match_subject_alt_names in version 1.14 or later. This issue has been fixed in Envoy versions 1.12.6, 1.13.4, 1.14.4, 1.15.0.",
    "An improper certificate validation vulnerability was found in envoyproxy/envoy, when externally created certificates with wildcards in the DNS Subject Alternative Name are used. This flaw allows an attacker to subvert the envoy filter or destination rules to access restricted resources. The highest threat from this vulnerability is to confidentiality."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2020-15104\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-15104\nhttps://istio.io/latest/news/security/istio-security-2020-008/"
  ]
}