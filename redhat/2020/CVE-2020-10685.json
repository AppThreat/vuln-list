{
  "mitigation": "Currently, there is no mitigation for this issue except by removing manually the temporary created file after every run.",
  "affected_release": [
    {
      "product_name": "Red Hat Ansible Engine 2.7 for RHEL 7",
      "release_date": "2020-04-22T00:00:00Z",
      "advisory": "RHSA-2020:1544",
      "package": "ansible-0:2.7.17-1.el7ae",
      "cpe": "cpe:/a:redhat:ansible_engine:2.7::el7"
    },
    {
      "product_name": "Red Hat Ansible Engine 2.8 for RHEL 7",
      "release_date": "2020-04-22T00:00:00Z",
      "advisory": "RHSA-2020:1543",
      "package": "ansible-0:2.8.11-1.el7ae",
      "cpe": "cpe:/a:redhat:ansible_engine:2.8::el7"
    },
    {
      "product_name": "Red Hat Ansible Engine 2.8 for RHEL 8",
      "release_date": "2020-04-22T00:00:00Z",
      "advisory": "RHSA-2020:1543",
      "package": "ansible-0:2.8.11-1.el8ae",
      "cpe": "cpe:/a:redhat:ansible_engine:2.8::el8"
    },
    {
      "product_name": "Red Hat Ansible Engine 2.9 for RHEL 7",
      "release_date": "2020-04-22T00:00:00Z",
      "advisory": "RHSA-2020:1541",
      "package": "ansible-0:2.9.7-1.el7ae",
      "cpe": "cpe:/a:redhat:ansible_engine:2.9::el7"
    },
    {
      "product_name": "Red Hat Ansible Engine 2.9 for RHEL 8",
      "release_date": "2020-04-22T00:00:00Z",
      "advisory": "RHSA-2020:1541",
      "package": "ansible-0:2.9.7-1.el8ae",
      "cpe": "cpe:/a:redhat:ansible_engine:2.9::el8"
    },
    {
      "product_name": "Red Hat Ansible Engine 2 for RHEL 7",
      "release_date": "2020-04-22T00:00:00Z",
      "advisory": "RHSA-2020:1542",
      "package": "ansible-0:2.9.7-1.el7ae",
      "cpe": "cpe:/a:redhat:ansible_engine:2::el7"
    },
    {
      "product_name": "Red Hat Ansible Engine 2 for RHEL 8",
      "release_date": "2020-04-22T00:00:00Z",
      "advisory": "RHSA-2020:1542",
      "package": "ansible-0:2.9.7-1.el8ae",
      "cpe": "cpe:/a:redhat:ansible_engine:2::el8"
    },
    {
      "product_name": "Red Hat Ansible Tower 3.4 for RHEL 7",
      "release_date": "2020-02-18T00:00:00Z",
      "advisory": "RHBA-2020:0547",
      "package": "ansible-tower-34/ansible-tower-memcached:1.4.15-28",
      "cpe": "cpe:/a:redhat:ansible_tower:3.4::el7"
    },
    {
      "product_name": "Red Hat Ansible Tower 3.4 for RHEL 7",
      "release_date": "2020-02-18T00:00:00Z",
      "advisory": "RHBA-2020:0547",
      "package": "ansible-tower-35/ansible-tower-memcached:1.4.15-28",
      "cpe": "cpe:/a:redhat:ansible_tower:3.4::el7"
    },
    {
      "product_name": "Red Hat Ansible Tower 3.4 for RHEL 7",
      "release_date": "2020-02-18T00:00:00Z",
      "advisory": "RHBA-2020:0547",
      "package": "ansible-tower-37/ansible-tower-memcached-rhel7:1.4.15-28",
      "cpe": "cpe:/a:redhat:ansible_tower:3.4::el7"
    },
    {
      "product_name": "Red Hat Ansible Tower 3.5 for RHEL 7",
      "release_date": "2020-04-22T00:00:00Z",
      "advisory": "RHBA-2020:1539",
      "package": "ansible-tower-35/ansible-tower:3.5.6-1",
      "cpe": "cpe:/a:redhat:ansible_tower:3.5::el7"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Ceph Storage 2",
      "fix_state": "Out of support scope",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:ceph_storage:2"
    },
    {
      "product_name": "Red Hat Ceph Storage 3",
      "fix_state": "Affected",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:ceph_storage:3"
    },
    {
      "product_name": "Red Hat OpenStack Platform 10 (Newton)",
      "fix_state": "Out of support scope",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:openstack:10"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13 (Queens)",
      "fix_state": "Will not fix",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:openstack:13"
    },
    {
      "product_name": "Red Hat Storage 3",
      "fix_state": "Will not fix",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:storage:3"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2020-03-18T00:00:00Z",
  "bugzilla": {
    "description": "Ansible: modules which use files encrypted with vault are not properly cleaned up",
    "id": "1814627",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1814627"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.0",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-459",
  "statement": "* Ansible Engine 2.7.16, 2.8.10, and 2.9.6 as well as previous versions are affected.\n* Ansible Tower 3.4.5, 3.5.5 and 3.6.3 as well as previous versions are affected.\n* In Red Hat OpenStack Platform, because the flaw has a lower impact, ansible is not directly customer exposed, and the fix would require a substantial amount of development, no update will be provided at this time for the RHOSP ansible package.",
  "acknowledgement": "Red Hat would like to thank Damien Aumaitre (Quarkslab) and Nicolas Surbayrole (Quarkslab) for reporting this issue.",
  "name": "CVE-2020-10685",
  "document_distribution": "",
  "details": [
    "A flaw was found in Ansible Engine affecting Ansible Engine versions 2.7.x before 2.7.17 and 2.8.x before 2.8.11 and 2.9.x before 2.9.7 as well as Ansible Tower before and including versions 3.4.5 and 3.5.5 and 3.6.3 when using modules which decrypts vault files such as assemble, script, unarchive, win_copy, aws_s3 or copy modules. The temporary directory is created in /tmp leaves the s ts unencrypted. On Operating Systems which /tmp is not a tmpfs but part of the root partition, the directory is only cleared on boot and the decryp emains when the host is switched off. The system will be vulnerable when the system is not running. So decrypted data must be cleared as soon as possible and the data which normally is encrypted ble.",
    "A flaw was found on Ansible Engine when using modules which decrypts vault files such as assemble, script, unarchive, win_copy, aws_s3 or copy modules.  The temporary directory is created in /tmp leaves the secrets unencrypted.\nOn Operating Systems which /tmp is not a tmpfs but part of the root partition, the directory is only cleared on boot and the decrypted data remains when the host is switched off. The system will be vulnerable when the system is not running. So decrypted data must be cleared as soon as possible and the data which normally is encrypted is sensible."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2020-10685\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-10685"
  ]
}