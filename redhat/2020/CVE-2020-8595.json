{
  "mitigation": "Depending on the paths used in the exact match clause, it is possible to update the path to a regex. \nAs provided by the Istio Product Committee, the following mitigation can be employed.\nThe original policy specifying a JWT protected path is as follows:\n---\napiVersion: \"authentication.istio.io/v1alpha1\"\nkind: \"Policy\"\nmetadata:\nname: \"jwt-example\"\nnamespace: istio-system\nspec:\ntargets:\n- name: istio-ingressgateway\norigins:\n- jwt:\nissuer: \"testing@secure.istio.io\"\njwksUri: \"https://raw.githubusercontent.com/istio/istio/release-1.4/security/tools/jwt/samples/jwks.json\"\ntrigger_rules:\n- included_paths:\n- exact: /productpage\nThe exact path definition can then be updated to a regular expression:\n---\n- jwt:\nissuer: \"testing@secure.istio.io\"\njwksUri: \"https://raw.githubusercontent.com/istio/istio/release-1.4/security/tools/jwt/samples/jwks.json\"\ntrigger_rules:\n- included_paths:\n- regex: '/productpage(\\?.*)?'\n- regex: '/productpage(#.*)?'",
  "affected_release": [
    {
      "product_name": "OpenShift Service Mesh 1.0",
      "release_date": "2020-02-12T00:00:00Z",
      "advisory": "RHSA-2020:0477",
      "package": "servicemesh-proxy-0:1.0.7-1.el8",
      "cpe": "cpe:/a:redhat:service_mesh:1.0::el8"
    }
  ],
  "package_state": null,
  "threat_severity": "Important",
  "public_date": "2020-02-11T18:00:00Z",
  "bugzilla": {
    "description": "istio: unauthorised access to JWT protected HTTP path",
    "id": "1798247",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1798247"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.3",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-285",
  "statement": "",
  "acknowledgement": "Red Hat would like to thank The Istio Product Security Committee for reporting this issue.",
  "name": "CVE-2020-8595",
  "document_distribution": "",
  "details": [
    "Istio versions 1.2.10 (End of Life) and prior, 1.3 through 1.3.7, and 1.4 through 1.4.3 allows authentication bypass. The Authentication Policy exact-path matching logic can allow unauthorized access to HTTP paths even if they are configured to be only accessed after presenting a valid JWT token. For example, an attacker can add a ? or # character to a URI that would otherwise satisfy an exact-path match.",
    "An unauthorized access vulnerability was found in Istio in the servicemesh-proxy. An attacker can use this flaw to specify an HTTP path and gain unauthorized access, even if the path is configured to only be accessed with a valid JSON Web Token (JWT)."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2020-8595\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-8595\nhttps://istio.io/news/security/istio-security-2020-001/"
  ]
}