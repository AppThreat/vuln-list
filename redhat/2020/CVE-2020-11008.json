{
  "mitigation": "The most complete workaround is to disable credential helpers altogether:\n~~~\ngit config --unset credential.helper\ngit config --global --unset credential.helper\ngit config --system --unset credential.helper\n~~~\nAn alternative is to avoid malicious URLs:\n1. Examine the hostname and username portion of URLs fed to git clone or git fetch for the presence of encoded newlines (%0A) or syntactic oddities (e.g., http:///host with three slashes).\n2. Avoid using submodules with untrusted repositories (don't use git clone --recurse-submodules; use git submodule update only after examining the URLs found in .gitmodules).\n3. Avoid tools which may run git clone on untrusted URLs under the hood.\n4. Avoid using the credential helper by only cloning publicly available repositories.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2020-05-28T00:00:00Z",
      "advisory": "RHSA-2020:2337",
      "package": "git-0:1.8.3.1-23.el7_8",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.7 Extended Update Support",
      "release_date": "2020-08-31T00:00:00Z",
      "advisory": "RHSA-2020:3581",
      "package": "git-0:1.8.3.1-23.el7_7",
      "cpe": "cpe:/o:redhat:rhel_eus:7.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2020-04-30T00:00:00Z",
      "advisory": "RHSA-2020:1980",
      "package": "git-0:2.18.4-2.el8_2",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.0 Update Services for SAP Solutions",
      "release_date": "2020-04-30T00:00:00Z",
      "advisory": "RHSA-2020:1978",
      "package": "git-0:2.18.4-1.el8_0",
      "cpe": "cpe:/a:redhat:rhel_e4s:8.0"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.1 Extended Update Support",
      "release_date": "2020-04-30T00:00:00Z",
      "advisory": "RHSA-2020:1979",
      "package": "git-0:2.18.4-1.el8_1",
      "cpe": "cpe:/a:redhat:rhel_eus:8.1"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2020-04-29T00:00:00Z",
      "advisory": "RHSA-2020:1975",
      "package": "rh-git218-git-0:2.18.4-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
      "release_date": "2020-04-29T00:00:00Z",
      "advisory": "RHSA-2020:1975",
      "package": "rh-git218-git-0:2.18.4-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
      "release_date": "2020-04-29T00:00:00Z",
      "advisory": "RHSA-2020:1975",
      "package": "rh-git218-git-0:2.18.4-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "git",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2020-04-20T18:00:00Z",
  "bugzilla": {
    "description": "git: Crafted URL containing new lines, empty host or lacks a scheme can cause credential leak",
    "id": "1826001",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1826001"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-20",
  "statement": "Red Hat Enterprise Linux 6 is not affected by this flaw as the vulnerable version of git, version 1.7.9-rc0 and later, was never made available for this product.",
  "acknowledgement": "Red Hat would like to thank the Git project for reporting this issue. Upstream acknowledges Carlo Arenas as the original reporter.",
  "name": "CVE-2020-11008",
  "document_distribution": "",
  "details": [
    "Affected versions of Git have a vulnerability whereby Git can be tricked into sending private credentials to a host controlled by an attacker. This bug is similar to CVE-2020-5260(GHSA-qm7j-c969-7j4q). The fix for that bug still left the door open for an exploit where _some_ credential is leaked (but the attacker cannot control which one). Git uses external \"credential helper\" programs to store and retrieve passwords or other credentials from secure storage provided by the operating system. Specially-crafted URLs that are considered illegal as of the recently published Git versions can cause Git to send a \"blank\" pattern to helpers, missing hostname and protocol fields. Many helpers will interpret this as matching _any_ URL, and will return some unspecified stored password, leaking the password to an attacker's server. The vulnerability can be triggered by feeding a malicious URL to `git clone`. However, the affected URLs look rather suspicious; the likely vector would be through systems which automatically clone URLs not visible to the user, such as Git submodules, or package systems built around Git. The root of the problem is in Git itself, which should not be feeding blank input to helpers. However, the ability to exploit the vulnerability in practice depends on which helpers are in use. Credential helpers which are known to trigger the vulnerability: - Git's \"store\" helper - Git's \"cache\" helper - the \"osxkeychain\" helper that ships in Git's \"contrib\" directory Credential helpers which are known to be safe even with vulnerable versions of Git: - Git Credential Manager for Windows Any helper not in this list should be assumed to trigger the vulnerability.",
    "A flaw was found in git where credentials can be leaked through the use of a crafted URL. The crafted URL must contain a newline, empty host, or lack a scheme so that the credential helper is fulled into giving the information of a different host to the client. The highest threat from this vulnerability is to data confidentiality."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2020-11008\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-11008\nhttps://github.com/git/git/security/advisories/GHSA-hjc9-x69f-jqj7\nhttps://lore.kernel.org/git/xmqq4kterq5s.fsf@gitster.c.googlers.com/"
  ]
}