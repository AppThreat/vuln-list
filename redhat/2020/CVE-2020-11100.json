{
  "mitigation": "This issue can be mitigated by not enabling support for HTTP/2 protocol. Upstream suggests that HTTP/2 can be enabled per front-end server by using the following documentation: https://www.haproxy.com/documentation/hapee/1-8r1/traffic-management/enable-http2-protocol/.\nYou can check if http2 is enabled by searching your haproxy configuration files for a line containing 'h2'.\nTo mitigate this vulnerability in OpenShift Container Platform 3.11, keep HTTP/2 disabled as it is by default. You can verify if HTTP/2 support is enabled or not by following the instructions in following article: https://access.redhat.com/security/vulnerabilities/haproxy\nOn Red Hat Enterprise Linux 8, haproxy is confined by SELinux, which should mitigate remote arbitrary code execution.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2020-04-02T00:00:00Z",
      "advisory": "RHSA-2020:1288",
      "package": "haproxy-0:1.8.15-6.el8_1.1",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.0 Update Services for SAP Solutions",
      "release_date": "2020-04-02T00:00:00Z",
      "advisory": "RHSA-2020:1289",
      "package": "haproxy-0:1.8.15-5.el8_0.1",
      "cpe": "cpe:/a:redhat:rhel_e4s:8.0"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "release_date": "2020-04-07T00:00:00Z",
      "advisory": "RHSA-2020:1287",
      "package": "haproxy-0:1.8.23-3.el7",
      "cpe": "cpe:/a:redhat:openshift:3.11::el7"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.4",
      "release_date": "2020-05-04T00:00:00Z",
      "advisory": "RHSA-2020:1936",
      "package": "haproxy-0:2.0.13-3.el7",
      "cpe": "cpe:/a:redhat:openshift:4.4::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2020-04-02T00:00:00Z",
      "advisory": "RHSA-2020:1290",
      "package": "rh-haproxy18-haproxy-0:1.8.17-1.el7.1",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
      "release_date": "2020-04-02T00:00:00Z",
      "advisory": "RHSA-2020:1290",
      "package": "rh-haproxy18-haproxy-0:1.8.17-1.el7.1",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
      "release_date": "2020-04-02T00:00:00Z",
      "advisory": "RHSA-2020:1290",
      "package": "rh-haproxy18-haproxy-0:1.8.17-1.el7.1",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
      "release_date": "2020-04-02T00:00:00Z",
      "advisory": "RHSA-2020:1290",
      "package": "rh-haproxy18-haproxy-0:1.8.17-1.el7.1",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "haproxy",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "haproxy",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    }
  ],
  "threat_severity": "Critical",
  "public_date": "2020-04-02T13:00:00Z",
  "bugzilla": {
    "description": "CVE-2020-11100 haproxy: malformed HTTP/2 requests can lead to out-of-bounds writes",
    "id": "1819111",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1819111"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-20-\u003eCWE-787",
  "statement": "HAProxy packages shipped with Red Hat Enterprise Linux 6 and 7 do not contain support for HTTP/2; therefore, they are not affected by this flaw.\nOpenShift Container Platform versions through 4.3 contain the vulnerable code; exploitation requires setting ROUTER_USE_HTTP2 in the OpenShift Ingress Operator, which is not currently possible. The impact of this vulnerability is therefore reduced in OCP 4.x, prior to version 4.4, to low.\nOpenShift Container Platform 3.11 added a configuration option to ose-haproxy-router that made enabling HTTP/2 support easy. However, it is not enabled by default on that version.",
  "acknowledgement": "Red Hat would like to thank the HAProxy project for reporting this issue. Upstream acknowledges Felix Wilhelm (Google Project Zero) as the original reporter.",
  "name": "CVE-2020-11100",
  "document_distribution": "",
  "details": [
    "In hpack_dht_insert in hpack-tbl.c in the HPACK decoder in HAProxy 1.8 through 2.x before 2.1.4, a remote attacker can write arbitrary bytes around a certain location on the heap via a crafted HTTP/2 request, possibly causing remote code execution.",
    "A flaw was found in the way HAProxy processed certain HTTP/2 request packets. This flaw allows an attacker to send crafted HTTP/2 request packets, which cause memory corruption, leading to a crash or potential remote arbitrary code execution with the permissions of the user running HAProxy."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2020-11100\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-11100\nhttps://bugs.chromium.org/p/project-zero/issues/detail?id=2023\nhttps://www.haproxy.com/blog/haproxy-1-8-http-2-hpack-decoder-vulnerability-fixed/\nhttps://www.mail-archive.com/haproxy@formilux.org/msg36876.html"
  ]
}