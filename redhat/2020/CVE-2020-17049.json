{
  "mitigation": "In Red Hat Identity Management (IdM), the list of existing rules for service principals  delegation can be obtained with the following commands :\n$ ipa servicedelegationrule-find\n$ ipa servicedelegationtarget-find\nThe services allowed to delegate must all be trusted.\nBy default, only HTTP/\u003cIPA host\u003e@\u003cREALM\u003e, corresponding to IdM's Web UI, is allowed to delegate.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-01-10T00:00:00Z",
      "advisory": "RHSA-2024:0143",
      "package": "idm:DL1-8090020231201152514.3387e3d0",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.6 Extended Update Support",
      "release_date": "2024-01-10T00:00:00Z",
      "advisory": "RHSA-2024:0139",
      "package": "idm:DL1-8060020231208020207.ada582f1",
      "cpe": "cpe:/a:redhat:rhel_eus:8.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.6 Extended Update Support",
      "release_date": "2024-01-15T00:00:00Z",
      "advisory": "RHSA-2024:0252",
      "package": "krb5-0:1.18.2-16.el8_6",
      "cpe": "cpe:/o:redhat:rhel_eus:8.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
      "release_date": "2024-01-10T00:00:00Z",
      "advisory": "RHSA-2024:0137",
      "package": "idm:DL1-8080020231201153604.b0a6ceea",
      "cpe": "cpe:/a:redhat:rhel_eus:8.8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-05-09T00:00:00Z",
      "advisory": "RHSA-2023:2570",
      "package": "krb5-0:1.20.1-8.el9",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-05-09T00:00:00Z",
      "advisory": "RHSA-2023:2570",
      "package": "krb5-0:1.20.1-8.el9",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Will not fix",
      "package_name": "krb5",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat JBoss Core Services",
      "fix_state": "Not affected",
      "package_name": "krb5",
      "cpe": "cpe:/a:redhat:jboss_core_services:1"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Not affected",
      "package_name": "krb5",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat Storage 3",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/a:redhat:storage:3"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2020-11-10T00:00:00Z",
  "bugzilla": {
    "description": "Kerberos: delegation constrain bypass in S4U2Proxy",
    "id": "2025721",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2025721"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.2",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-345",
  "statement": "As a prerequisite to be vulnerable, a Key Distribution Center (KDC) must be able to accept delegation via the `Service for User` (S4U) extensions.\nVersion of MIT Kerberos KDC in Red Hat Enterprise Linux (provided by the krb5-server package) only allows use of the S4U extensions when configured with an LDAP backend. Furthermore, delegations are denied by default and delegation rules must be explicitly created by an administrator, between a given service principal and its targets. Such a rule would entitle that service to use delegation to the targets.  This means that, in order to exploit the flaw, an attacker would require either to trick an administrator into adding a rule for a malicious service principal, or have the knowledge of an entitled principal's secret key. The victim principals would be limited to the ones allowed by the rules for that service.\nIn Red Hat Enterprise Linux version 8 and older and Red Hat Gluster Storage, Samba as an Active Directory Domain Controller is not supported, and thus is not affected by this flaw.\nRHEL Identity Management (RHEL IdM) implements constrained delegation feature using Active Directory's Kerberos extensions called Service for User (S4U). The constrained delegation implementation may potentially be vulnerable if an attacker is capable to create constrained delegation rules. In RHEL IdM only administrators allowed to add constrained delegation rules and only one such rule exists by default for HTTP/..  principal on IdM server. Security of IdM server is the key to safety of the whole RHEL IdM deployment. If an attacker is able to impersonate the HTTP/.. service principal on IdM server, they would be able to overtake the whole deployment even without a Kerberos protocol vulnerability described by CVE-2020-17049. However, if an attacker cannot control any service with pre-existing constrained delegation rules and cannot force creation of the constrained delegation rules for other Kerberos services, they cannot utilize CVE-2020-17049 vulnerability against RHEL IdM.",
  "acknowledgement": "",
  "name": "CVE-2020-17049",
  "document_distribution": "",
  "details": [
    "\u003cp\u003eA security feature bypass vulnerability exists in the way Key Distribution Center (KDC) determines if a service ticket can be used for delegation via Kerberos Constrained Delegation (KCD).\u003c/p\u003e\n\u003cp\u003eTo exploit the vulnerability, a compromised service that is configured to use KCD could tamper with a service ticket that is not valid for delegation to force the KDC to accept it.\u003c/p\u003e\n\u003cp\u003eThe update addresses this vulnerability by changing how the KDC validates service tickets used with KCD.\u003c/p\u003e",
    "It was found that the Kerberos Key Distribution Center (KDC) delegation feature, Service for User (S4U), did not sufficiently protect the tickets it's providing from tempering. A malicious, authenticated service principal allowed to delegate could use this flaw to impersonate a non-forwardable user."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2020-17049\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-17049\nhttps://msrc.microsoft.com/update-guide/vulnerability/CVE-2020-17049"
  ]
}