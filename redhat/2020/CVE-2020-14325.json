{
  "mitigation": "Red Hat recommends upgrading to secured released versions, however, this flaw can be mitigated by unseting RequestHeader in http configuration. Mitigation steps would be:\n1. Stop httpd service\n$ systemctl stop httpd\n2. Add following additional unset at `/etc/httpd/conf.d/manageiq-remote-user-openidc.conf` and `/etc/httpd/conf.d/manageiq-remote-user.conf`, right before `X_REMOTE_USER` unset. \n~~~\nRequestHeader unset X-REMOTE-USER\nRequestHeader unset X-REMOTE_USER\nRequestHeader unset X_REMOTE-USER\n~~~\n3. Validate configuration files to make sure all syntax is valid\n$ apachectl configtest\n4. Restart httpd service\n$ systemctl start httpd",
  "affected_release": [
    {
      "product_name": "CloudForms Management Engine 5.10",
      "release_date": "2020-08-27T00:00:00Z",
      "advisory": "RHSA-2020:3574",
      "package": "cfme-appliance-0:5.10.16.0-1.el7cf",
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5.10::el7"
    },
    {
      "product_name": "CloudForms Management Engine 5.11",
      "release_date": "2020-08-06T00:00:00Z",
      "advisory": "RHSA-2020:3358",
      "package": "cfme-0:5.11.7.3-1.el8cf",
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5.11::el8"
    }
  ],
  "package_state": null,
  "threat_severity": "Critical",
  "public_date": "2020-08-03T13:30:00Z",
  "bugzilla": {
    "description": "CloudForms: User Impersonation in the API for OIDC and SAML",
    "id": "1855739",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1855739"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "9.9",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:L",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-285",
  "statement": "The vulnerability and related criticality depends on the product releases and protocols. \nIn CloudForms 5.11, attacker need to be authenticated through OIDC but SAML do not need any authentication for exploitation. However, for CloudForms 5.10, both SAML and OIDC protocols does not need authentication and attacker can impersonate users previously logged in.\nRed Hat does not support CloudForms 5.9 and earlier releases, however, confirms vulnerability affects SAML protocol but not OIDC.\nReference metrics: https://bugzilla.redhat.com/show_bug.cgi?id=1855739#c3",
  "acknowledgement": "This issue was discovered by Alberto Bellotti (Red Hat).",
  "name": "CVE-2020-14325",
  "document_distribution": "",
  "details": [
    "Red Hat CloudForms before 5.11.7.0 was vulnerable to the User Impersonation authorization flaw which allows malicious attacker to create existent and non-existent role-based access control user, with groups and roles. With a selected group of EvmGroup-super_administrator, an attacker can perform any API request as a super administrator.",
    "A vulnerability was found in Red Hat CloudForms which allows a malicious attacker to impersonate any user or create a non-existent user with any entitlement in the appliance and perform an API request."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2020-14325\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-14325\nhttps://github.com/ManageIQ/manageiq/security/advisories/GHSA-84f5-5g5v-g8vr"
  ]
}