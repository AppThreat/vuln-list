{
  "mitigation": "This issue can be avoided by escaping variables which are used in the lookup.",
  "affected_release": [
    {
      "product_name": "Red Hat Ansible Tower 3.4 for RHEL 7",
      "release_date": "2020-02-18T00:00:00Z",
      "advisory": "RHBA-2020:0547",
      "package": "ansible-tower-34/ansible-tower-memcached:1.4.15-28",
      "cpe": "cpe:/a:redhat:ansible_tower:3.4::el7"
    },
    {
      "product_name": "Red Hat Ansible Tower 3.4 for RHEL 7",
      "release_date": "2020-02-18T00:00:00Z",
      "advisory": "RHBA-2020:0547",
      "package": "ansible-tower-35/ansible-tower-memcached:1.4.15-28",
      "cpe": "cpe:/a:redhat:ansible_tower:3.4::el7"
    },
    {
      "product_name": "Red Hat Ansible Tower 3.4 for RHEL 7",
      "release_date": "2020-02-18T00:00:00Z",
      "advisory": "RHBA-2020:0547",
      "package": "ansible-tower-37/ansible-tower-memcached-rhel7:1.4.15-28",
      "cpe": "cpe:/a:redhat:ansible_tower:3.4::el7"
    },
    {
      "product_name": "Red Hat Ansible Tower 3.5 for RHEL 7",
      "release_date": "2020-04-22T00:00:00Z",
      "advisory": "RHBA-2020:1539",
      "package": "ansible-tower-35/ansible-tower:3.5.6-1",
      "cpe": "cpe:/a:redhat:ansible_tower:3.5::el7"
    }
  ],
  "package_state": [
    {
      "product_name": "CloudForms Management Engine 5",
      "fix_state": "Not affected",
      "package_name": "ansible-tower",
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5"
    },
    {
      "product_name": "Red Hat Ansible Engine 2",
      "fix_state": "Will not fix",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:ansible_engine:2"
    },
    {
      "product_name": "Red Hat Ansible Tower 3",
      "fix_state": "Will not fix",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:ansible_tower:3"
    },
    {
      "product_name": "Red Hat Ceph Storage 2",
      "fix_state": "Out of support scope",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:ceph_storage:2"
    },
    {
      "product_name": "Red Hat Ceph Storage 3",
      "fix_state": "Affected",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:ceph_storage:3"
    },
    {
      "product_name": "Red Hat OpenStack Platform 10 (Newton)",
      "fix_state": "Out of support scope",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:openstack:10"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13 (Queens)",
      "fix_state": "Will not fix",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:openstack:13"
    },
    {
      "product_name": "Red Hat Storage 3",
      "fix_state": "Will not fix",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:storage:3"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2020-02-18T00:00:00Z",
  "bugzilla": {
    "description": "ansible: shell enabled by default in a pipe lookup plugin subprocess",
    "id": "1801804",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1801804"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.4",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:L",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-78",
  "statement": "Ansible Engine 2.7.16, 2.8.10, and 2.9.6 as well as previous versions are affected.\nAnsible Tower 3.4.5, 3.5.5 and 3.6.3 as well as previous versions are affected.\nIn Red Hat OpenStack Platform, because the flaw has a lower impact,  ansible is not directly customer exposed, and the fix would require a substantial amount of development, no update will be provided at this time for the RHOSP ansible package.",
  "acknowledgement": "Red Hat would like to thank Damien Aumaitre (Quarkslab) and Nicolas Surbayrole (Quarkslab) for reporting this issue.",
  "name": "CVE-2020-1734",
  "document_distribution": "",
  "details": [
    "A flaw was found in the pipe lookup plugin of ansible. Arbitrary commands can be run, when the pipe lookup plugin uses subprocess.Popen() with shell=True, by overwriting ansible facts and the variable is not escaped by quote plugin. An attacker could take advantage and run arbitrary commands by overwriting the ansible facts.",
    "A flaw was found in the pipe lookup plugin of ansible. Arbitrary commands can be run, when the pipe lookup plugin uses subprocess.Popen() with shell=True, by overwriting ansible facts and the variable is not escaped by quote plugin. An attacker could take advantage and run arbitrary commands by overwriting the ansible facts."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2020-1734\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-1734"
  ]
}