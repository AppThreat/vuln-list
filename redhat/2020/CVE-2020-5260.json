{
  "mitigation": "The most complete workaround is to disable credential helpers altogether:\n~~~\ngit config --unset credential.helper\ngit config --global --unset credential.helper\ngit config --system --unset credential.helper\n~~~\nAn alternative is to avoid malicious URLs:\n1. Examine the hostname and username portion of URLs fed to git clone for the presence of encoded newlines (%0a) or evidence of credential-protocol injections (e.g., host=github.com)\n2. Avoid using submodules with untrusted repositories (don't use clone --recurse-submodules; use git submodule update only after examining the URLs found in .gitmodules)\n3. Avoid tools which may run git clone on untrusted URLs under the hood",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2020-04-21T00:00:00Z",
      "advisory": "RHSA-2020:1511",
      "package": "git-0:1.8.3.1-22.el7_8",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.7 Extended Update Support",
      "release_date": "2020-08-31T00:00:00Z",
      "advisory": "RHSA-2020:3581",
      "package": "git-0:1.8.3.1-23.el7_7",
      "cpe": "cpe:/o:redhat:rhel_eus:7.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2020-04-21T00:00:00Z",
      "advisory": "RHSA-2020:1513",
      "package": "git-0:2.18.2-2.el8_1",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.0 Update Services for SAP Solutions",
      "release_date": "2020-04-21T00:00:00Z",
      "advisory": "RHSA-2020:1518",
      "package": "git-0:2.18.2-2.el8_0",
      "cpe": "cpe:/a:redhat:rhel_e4s:8.0"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2020-04-21T00:00:00Z",
      "advisory": "RHSA-2020:1503",
      "package": "rh-git218-git-0:2.18.2-3.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
      "release_date": "2020-04-21T00:00:00Z",
      "advisory": "RHSA-2020:1503",
      "package": "rh-git218-git-0:2.18.2-3.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
      "release_date": "2020-04-21T00:00:00Z",
      "advisory": "RHSA-2020:1503",
      "package": "rh-git218-git-0:2.18.2-3.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
      "release_date": "2020-04-21T00:00:00Z",
      "advisory": "RHSA-2020:1503",
      "package": "rh-git218-git-0:2.18.2-3.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "git",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2020-04-14T18:00:00Z",
  "bugzilla": {
    "description": "git: Crafted URL containing new lines can cause credential leak",
    "id": "1822020",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1822020"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-20",
  "statement": "Red Hat Enterprise Linux 6 is not affected by this flaw as the vulnerable version of git, version 1.7.9-rc0 and later, was never packaged for this instance of RHEL.",
  "acknowledgement": "Red Hat would like to thank the Git project for reporting this issue. Upstream acknowledges Felix Wilhelm (Google project zero) as the original reporter.",
  "name": "CVE-2020-5260",
  "document_distribution": "",
  "details": [
    "Affected versions of Git have a vulnerability whereby Git can be tricked into sending private credentials to a host controlled by an attacker. Git uses external \"credential helper\" programs to store and retrieve passwords or other credentials from secure storage provided by the operating system. Specially-crafted URLs that contain an encoded newline can inject unintended values into the credential helper protocol stream, causing the credential helper to retrieve the password for one server (e.g., good.example.com) for an HTTP request being made to another server (e.g., evil.example.com), resulting in credentials for the former being sent to the latter. There are no restrictions on the relationship between the two, meaning that an attacker can craft a URL that will present stored credentials for any host to a host of their choosing. The vulnerability can be triggered by feeding a malicious URL to git clone. However, the affected URLs look rather suspicious; the likely vector would be through systems which automatically clone URLs not visible to the user, such as Git submodules, or package systems built around Git. The problem has been patched in the versions published on April 14th, 2020, going back to v2.17.x. Anyone wishing to backport the change further can do so by applying commit 9a6bbee (the full release includes extra checks for git fsck, but that commit is sufficient to protect clients against the vulnerability). The patched versions are: 2.17.4, 2.18.3, 2.19.4, 2.20.3, 2.21.2, 2.22.3, 2.23.2, 2.24.2, 2.25.3, 2.26.1.",
    "A flaw was found in git. Credentials can be leaked through the use of a crafted URL that contains a newline, fooling the credential helper to give information for a different host. Highest threat from the vulnerability is to data confidentiality."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2020-5260\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-5260\nhttps://github.com/git/git/security/advisories/GHSA-qm7j-c969-7j4q\nhttps://lore.kernel.org/git/xmqqy2qy7xn8.fsf@gitster.c.googlers.com/"
  ]
}