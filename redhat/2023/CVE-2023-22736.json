{
  "affected_release": [
    {
      "product_name": "Red Hat OpenShift GitOps 1.7",
      "release_date": "2023-01-25T00:00:00Z",
      "advisory": "RHSA-2023:0467",
      "package": "openshift-gitops-1/argocd-rhel8:v1.7.1-2",
      "cpe": "cpe:/a:redhat:openshift_gitops:1.7::el8"
    }
  ],
  "package_state": null,
  "threat_severity": "Important",
  "public_date": "2023-01-25T00:00:00Z",
  "bugzilla": {
    "description": "argocd: Controller reconciles apps outside configured namespaces when sharding is enabled",
    "id": "2162517",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2162517"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "",
  "statement": "This issue only affects Red Hat GitOps version 1.7, as the vulnerability was introduced in ArgoCD-2.5.\nThis vulnerability affects only deployments with \"apps-in-any-namespace\" feature by setting application.namespaces in the argocd-cmd-params-cm ConfigMap or otherwise setting the --application-namespaces flags on the Application controller and API server components.",
  "acknowledgement": "",
  "name": "CVE-2023-22736",
  "document_distribution": "",
  "details": [
    "Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. Versions starting with 2.5.0-rc1 and above, prior to 2.5.8, and version 2.6.0-rc4, are vulnerable to an authorization bypass bug which allows a malicious Argo CD user to deploy Applications outside the configured allowed namespaces. Reconciled Application namespaces are specified as a comma-delimited list of glob patterns. When sharding is enabled on the Application controller, it does not enforce that list of patterns when reconciling Applications. For example, if Application namespaces are configured to be argocd-*, the Application controller may reconcile an Application installed in a namespace called other, even though it does not start with argocd-. Reconciliation of the out-of-bounds Application is only triggered when the Application is updated, so the attacker must be able to cause an update operation on the Application resource. This bug only applies to users who have explicitly enabled the \"apps-in-any-namespace\" feature by setting `application.namespaces` in the argocd-cmd-params-cm ConfigMap or otherwise setting the `--application-namespaces` flags on the Application controller and API server components. The apps-in-any-namespace feature is in beta as of this Security Advisory's publish date. The bug is also limited to Argo CD instances where sharding is enabled by increasing the `replicas` count for the Application controller. Finally, the AppProjects' `sourceNamespaces` field acts as a secondary check against this exploit. To cause reconciliation of an Application in an out-of-bounds namespace, an AppProject must be available which permits Applications in the out-of-bounds namespace. A patch for this vulnerability has been released in versions 2.5.8 and 2.6.0-rc5. As a workaround, running only one replica of the Application controller will prevent exploitation of this bug. Making sure all AppProjects' sourceNamespaces are restricted within the confines of the configured Application namespaces will also prevent exploitation of this bug.",
    "A flaw was found in Red Hat GitOps, which is vulnerable to an authorization bypass in ArgoCD. This flaw allows users to deploy applications outside the allowed namespaces. The issue happens due to a logic error when interpreting the comma-separated namespaces list. To complete the attack, the attacker must have enough privileges to update deployed applications."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-22736\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-22736\nhttps://github.com/argoproj/argo-cd/security/advisories/GHSA-6p4m-hw2h-6gmw"
  ]
}