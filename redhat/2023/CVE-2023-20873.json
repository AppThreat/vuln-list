{
  "mitigation": "Disable Cloud Foundry actuator endpoints by setting 'management.cloudfoundry.enabled' to false.",
  "affected_release": [
    {
      "product_name": "Red Hat AMQ Streams 2.6.0",
      "release_date": "2023-12-06T00:00:00Z",
      "advisory": "RHSA-2023:7678",
      "package": "spring-boot",
      "cpe": "cpe:/a:redhat:amq_streams:2"
    },
    {
      "product_name": "RHINT Camel-Springboot 3.18.3.2",
      "release_date": "2023-09-13T00:00:00Z",
      "advisory": "RHSA-2023:5147",
      "package": "spring-boot",
      "cpe": "cpe:/a:redhat:camel_spring_boot:3.18"
    },
    {
      "product_name": "RHINT Camel-Springboot 3.20.2",
      "release_date": "2023-09-13T00:00:00Z",
      "advisory": "RHSA-2023:5148",
      "package": "",
      "cpe": "cpe:/a:redhat:camel_spring_boot:3.20"
    }
  ],
  "package_state": [
    {
      "product_name": "A-MQ Clients 2",
      "fix_state": "Not affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:a_mq_clients:2"
    },
    {
      "product_name": "Migration Toolkit for Runtimes",
      "fix_state": "Not affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:migration_toolkit_runtimes:1"
    },
    {
      "product_name": "Red Hat build of OptaPlanner 8",
      "fix_state": "Not affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:optaplanner:::el6"
    },
    {
      "product_name": "Red Hat Data Grid 8",
      "fix_state": "Not affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:jboss_data_grid:8"
    },
    {
      "product_name": "Red Hat Decision Manager 7",
      "fix_state": "Affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "log4j:2/log4j",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "log4j",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Integration Camel K",
      "fix_state": "Not affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat JBoss A-MQ 7",
      "fix_state": "Not affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:amq_broker:7"
    },
    {
      "product_name": "Red Hat JBoss Data Grid 7",
      "fix_state": "Not affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:jboss_data_grid:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Not affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 7",
      "fix_state": "Not affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 8",
      "fix_state": "Not affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:8"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack",
      "fix_state": "Not affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:jbosseapxp"
    },
    {
      "product_name": "Red Hat JBoss Fuse 6",
      "fix_state": "Not affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:jboss_fuse:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Not affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat JBoss Fuse Service Works 6",
      "fix_state": "Out of support scope",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:jboss_fuse_service_works:6"
    },
    {
      "product_name": "Red Hat OpenShift Application Runtimes",
      "fix_state": "Not affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:openshift_application_runtimes:1.0"
    },
    {
      "product_name": "Red Hat Process Automation 7",
      "fix_state": "Will not fix",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7"
    },
    {
      "product_name": "Red Hat Single Sign-On 7",
      "fix_state": "Will not fix",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7"
    },
    {
      "product_name": "Red Hat support for Spring Boot",
      "fix_state": "Affected",
      "package_name": "spring-boot",
      "cpe": "cpe:/a:redhat:openshift_application_runtimes:1.0"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2023-05-18T00:00:00Z",
  "bugzilla": {
    "description": "spring-boot: Security Bypass With Wildcard Pattern Matching on Cloud Foundry",
    "id": "2231491",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2231491"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "9.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-284",
  "statement": "The following Red Hat products do not ship the affected software component and so are not affected:\n* Red Hat Enterprise Linux 8, 9\n* Enterprise Application Platform 6, 7, 8, XP\n* Data Grid 7, 8\n* Migration Toolkit for Runtimes\n* Red Hat Build of OptaPlanner\n* Red Hat Integration Camel-K\n* Red Hat AMQ Broker 7\n* Red Hat AMQ Clients 2\n* Red Hat AMQ Streams 2\n* Red Hat Fuse 6\n* Red Hat Fuse 7\n* Red Hat VertX 4\nThe following Red Hat products ship the affected software but do not enable or do not ship the vulnerable classes, and so are affected but at Low security impact.\n* Red Hat Decision Manager 7\n* Red Hat Process Automation Manager 7\n* Red Hat Single Sign-On 7",
  "acknowledgement": "",
  "name": "CVE-2023-20873",
  "document_distribution": "",
  "details": [
    "In Spring Boot versions 3.0.0 - 3.0.5, 2.7.0 - 2.7.10, and older unsupported versions, an application that is deployed to Cloud Foundry could be susceptible to a security bypass. Users of affected versions should apply the following mitigation: 3.0.x users should upgrade to 3.0.6+. 2.7.x users should upgrade to 2.7.11+. Users of older, unsupported versions should upgrade to 3.0.6+ or 2.7.11+.",
    "A flaw was found in Spring Boot. This targets specifically 'spring-boot-actuator-autoconfigure' package. This issue occurs when an application is deployed to Cloud Foundry, which could be susceptible to a security bypass.\nSpecifically, an application is vulnerable when all of the following are true:\n* You have code that can handle requests that match /cloudfoundryapplication/**. Typically, this will be if there is a catch-all request mapping which matches /**.\n* The application is deployed to Cloud Foundry.\nAn application is not vulnerable if any of the following is true:\n* The application is not deployed to Cloud Foundry\n* You have disabled Cloud Foundry actuator endpoints with management.cloudfoundry.enabled set to false.\n* Your application does not have handler mappings that can handle requests to /cloudfoundryapplication/**."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-20873\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-20873\nhttps://github.com/advisories/GHSA-g5h3-w546-pj7f\nhttps://spring.io/security/cve-2023-20873/"
  ]
}