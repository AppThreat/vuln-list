{
  "affected_release": [
    {
      "product_name": "Ironic content for Red Hat OpenShift Container Platform 4.11",
      "release_date": "2023-06-14T00:00:00Z",
      "advisory": "RHSA-2023:3541",
      "package": "python-flask-1:1.1.2-6.el8",
      "cpe": "cpe:/a:redhat:openshift_ironic:4.11::el8"
    },
    {
      "product_name": "Ironic content for Red Hat OpenShift Container Platform 4.12",
      "release_date": "2023-06-14T00:00:00Z",
      "advisory": "RHSA-2023:3545",
      "package": "python-flask-1:2.0.1-3.el9",
      "cpe": "cpe:/a:redhat:openshift_ironic:4.12::el9"
    },
    {
      "product_name": "Ironic content for Red Hat OpenShift Container Platform 4.13",
      "release_date": "2023-06-13T00:00:00Z",
      "advisory": "RHSA-2023:3536",
      "package": "python-flask-2:2.0.1-4.el9.2",
      "cpe": "cpe:/a:redhat:openshift_ironic:4.13::el9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7 Extras",
      "release_date": "2023-06-07T00:00:00Z",
      "advisory": "RHSA-2023:3525",
      "package": "python-flask-1:0.10.1-7.el7_9",
      "cpe": "cpe:/a:redhat:rhel_extras_other:7"
    },
    {
      "product_name": "Red Hat OpenStack Platform 16.1",
      "release_date": "2023-06-05T00:00:00Z",
      "advisory": "RHSA-2023:3446",
      "package": "python-flask-1:1.0.2-8.el8ost",
      "cpe": "cpe:/a:redhat:openstack:16.1::el8"
    },
    {
      "product_name": "Red Hat OpenStack Platform 16.2",
      "release_date": "2023-06-05T00:00:00Z",
      "advisory": "RHSA-2023:3444",
      "package": "python-flask-1:1.0.2-8.el8ost",
      "cpe": "cpe:/a:redhat:openstack:16.2::el8"
    },
    {
      "product_name": "Red Hat OpenStack Platform 17.0",
      "release_date": "2023-06-05T00:00:00Z",
      "advisory": "RHSA-2023:3440",
      "package": "python-flask-1:1.1.2-6.el9ost",
      "cpe": "cpe:/a:redhat:openstack:17.0::el9"
    },
    {
      "product_name": "Red Hat Quay 3",
      "release_date": "2023-11-30T00:00:00Z",
      "advisory": "RHSA-2023:7341",
      "package": "quay/quay-rhel8:v3.10.0-150",
      "cpe": "cpe:/a:redhat:quay:3::el8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Ceph Storage 3",
      "fix_state": "Out of support scope",
      "package_name": "python-flask",
      "cpe": "cpe:/a:redhat:ceph_storage:3"
    },
    {
      "product_name": "Red Hat Ceph Storage 7",
      "fix_state": "Affected",
      "package_name": "python-flask",
      "cpe": "cpe:/a:redhat:ceph_storage:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "python-flask",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Storage 3",
      "fix_state": "Affected",
      "package_name": "python-flask",
      "cpe": "cpe:/a:redhat:storage:3"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2023-05-05T00:00:00Z",
  "bugzilla": {
    "description": "flask: Possible disclosure of permanent session cookie due to missing Vary: Cookie header",
    "id": "2196643",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2196643"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-488",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2023-30861",
  "document_distribution": "",
  "details": [
    "Flask is a lightweight WSGI web application framework. When all of the following conditions are met, a response containing data intended for one client may be cached and subsequently sent by the proxy to other clients. If the proxy also caches `Set-Cookie` headers, it may send one client's `session` cookie to other clients. The severity depends on the application's use of the session and the proxy's behavior regarding cookies. The risk depends on all these conditions being met.\n1. The application must be hosted behind a caching proxy that does not strip cookies or ignore responses with cookies.\n2. The application sets `session.permanent = True`\n3. The application does not access or modify the session at any point during a request.\n4. `SESSION_REFRESH_EACH_REQUEST` enabled (the default).\n5. The application does not set a `Cache-Control` header to indicate that a page is private or should not be cached.\nThis happens because vulnerable versions of Flask only set the `Vary: Cookie` header when the session is accessed or modified, not when it is refreshed (re-sent to update the expiration) without being accessed or modified. This issue has been fixed in versions 2.3.2 and 2.2.5.",
    "A flaw was found in the Python Flask package. A cached response may contain data for one client sent by a proxy to other clients, including session cookies, resulting in the compromise of data confidentiality contained in the leak requests or cookies. This happens when the following conditions are met by the proxy's behavior regarding cookies and the application's behavior session usage:\n1. The caching proxy does not strip or ignore response with cookies\n2. The application sets a permanent session\n3. The application does not access or modify the session during requests\n4. SESSION_REFRESH_EACH_REQUEST is enabled, which is the default Flask behavior\n5. The application does not set the Cache-Control header to avoid being cached"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-30861\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-30861\nhttps://github.com/pallets/flask/commit/70f906c51ce49c485f1d355703e9cc3386b1cc2b\nhttps://github.com/pallets/flask/security/advisories/GHSA-m2qf-hxjv-5gpq"
  ]
}