{
  "mitigation": "Users can setup a reverse proxy in front of the Alertmanager web server to forbid access to the /api/v1/alerts endpoint.",
  "affected_release": [
    {
      "product_name": "Red Hat OpenShift Container Platform 4.15",
      "release_date": "2024-02-27T00:00:00Z",
      "advisory": "RHSA-2023:7198",
      "package": "openshift4/ose-prometheus-alertmanager:v4.15.0-202401290854.p0.g870ade5.assembly.stream",
      "cpe": "cpe:/a:redhat:openshift:4.15::el8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "rhacm2/prometheus-alertmanager-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Not affected",
      "package_name": "golang-github-prometheus-alertmanager",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Not affected",
      "package_name": "openshift3/prometheus-alertmanager",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2023-08-24T00:00:00Z",
  "bugzilla": {
    "description": "prometheus-alertmanager: UI is vulnerable to stored XSS via the /api/v1/alerts endpoint",
    "id": "2235479",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2235479"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-79",
  "statement": "This vulnerability affects Prometheus Alertmanager v0.25.0, which is not shipped in Red Hat OpenShift container platform, therefore, this is marked as Not affected.",
  "acknowledgement": "",
  "name": "CVE-2023-40577",
  "document_distribution": "",
  "details": [
    "Alertmanager handles alerts sent by client applications such as the Prometheus server. An attacker with the permission to perform POST requests on the /api/v1/alerts endpoint could be able to execute arbitrary JavaScript code on the users of Prometheus Alertmanager. This issue has been fixed in Alertmanager version 0.2.51.",
    "Prometheus Alertmanager is vulnerable to cross-site scripting due to improper validation of user-supplied input by the /api/v1/alerts endpoint. This issue could allow a remote attacker to inject malicious script into a web page, which would be executed in a victim's web browser within the hosting website once the page is viewed, allow the attacker to steal the victim's cookie-based authentication credentials."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-40577\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-40577\nhttps://github.com/prometheus/alertmanager/security/advisories/GHSA-v86x-5fm3-5p7j"
  ]
}