{
  "mitigation": "For customers who cannot update immediately and do not have Secure Boot feature enabled, the issue can be mitigated using the provided SystemTap script with the following steps.  When enabled, any setuid program invoked with GLIBC_TUNABLES in the environment will be terminated immediately.  To invoke the setuid program, users will then have to unset or clear the GLIBC_TUNABLES envvar, e.g. `GLIBC_TUNABLES= sudo` . \nNote that these mitigation steps will need to be repeated if the system is rebooted.\n1)    Install required systemtap packages and dependencies as per - https://access.redhat.com/solutions/5441\n2)    Create the following systemtap script, and name it stap_block_suid_tunables.stp:\n~~~\nfunction has_tunable_string:long()\n{\nname = \"GLIBC_TUNABLES\"\nmm = @task(task_current())-\u003emm;\nif (mm)\n{\nenv_start = @mm(mm)-\u003eenv_start;\nenv_end = @mm(mm)-\u003eenv_end;\nif (env_start != 0 \u0026\u0026 env_end != 0)\nwhile (env_end \u003e env_start)\n{\ncur = user_string(env_start, \"\");\nenv_name = tokenize(cur, \"=\");\nif (env_name == name \u0026\u0026 tokenize(\"\", \"\") != \"\")\nreturn 1;\nenv_start += strlen (cur) + 1\n}\n}\nreturn 0;\n}\nprobe process(\"/lib*/ld*.so*\").function(\"__tunables_init\")\n{\natsecure = 0;\n/* Skip processing if we can't read __libc_enable_secure, e.g. core dump\nhandler (systemd-cgroups-agent and systemd-coredump).  */\ntry { atsecure = @var(\"__libc_enable_secure\"); }\ncatch { printk (4, sprintf (\"CVE-2023-4911: Skipped check: %s (%d)\", execname(), pid())); }\nif (atsecure \u0026\u0026 has_tunable_string ())\nraise (9);\n}\n~~~\n3) Load the systemtap module into the running kernel:\n~~~\nstap -g -F -m stap_block_suid_tunables stap_block_suid_tunables.stp\n~~~\n4) Ensure the module is loaded:\n~~~\nlsmod | grep -i stap_block_suid_tunables\nstap_block_suid_tunables     249856  0\n~~~\n5) Once the glibc package is updated to the version containing the fix, the systemtap generated kernel module can be removed by running:\n~~~\nrmmod stap_block_suid_tunables\n~~~\nIf Secure Boot is enabled on a system, the SystemTap module must be signed. An external compiling server can be used to sign the generated kernel module with a key enrolled into the kernel's keyring or starting with SystemTap 4.7 you can sign a module without a compile server. See further information here - https://www.redhat.com/sysadmin/secure-boot-systemtap",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2023-10-05T00:00:00Z",
      "advisory": "RHSA-2023:5455",
      "package": "glibc-0:2.28-225.el8_8.6",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2023-10-05T00:00:00Z",
      "advisory": "RHSA-2023:5455",
      "package": "glibc-0:2.28-225.el8_8.6",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.6 Extended Update Support",
      "release_date": "2023-10-05T00:00:00Z",
      "advisory": "RHSA-2023:5476",
      "package": "glibc-0:2.28-189.6.el8_6",
      "cpe": "cpe:/a:redhat:rhel_eus:8.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-10-05T00:00:00Z",
      "advisory": "RHSA-2023:5453",
      "package": "glibc-0:2.34-60.el9_2.7",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-10-05T00:00:00Z",
      "advisory": "RHSA-2023:5453",
      "package": "glibc-0:2.34-60.el9_2.7",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.0 Extended Update Support",
      "release_date": "2023-10-05T00:00:00Z",
      "advisory": "RHSA-2023:5454",
      "package": "glibc-0:2.34-28.el9_0.4",
      "cpe": "cpe:/a:redhat:rhel_eus:9.0"
    },
    {
      "product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 8",
      "release_date": "2023-10-05T00:00:00Z",
      "advisory": "RHSA-2023:5476",
      "package": "glibc-0:2.28-189.6.el8_6",
      "cpe": "cpe:/o:redhat:rhev_hypervisor:4.4::el8"
    },
    {
      "product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 8",
      "release_date": "2024-01-03T00:00:00Z",
      "advisory": "RHSA-2024:0033",
      "package": "redhat-release-virtualization-host-0:4.5.3-10.el8ev",
      "cpe": "cpe:/o:redhat:rhev_hypervisor:4.4::el8"
    },
    {
      "product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 8",
      "release_date": "2024-01-03T00:00:00Z",
      "advisory": "RHSA-2024:0033",
      "package": "redhat-virtualization-host-0:4.5.3-202312060823_8.6",
      "cpe": "cpe:/o:redhat:rhev_hypervisor:4.4::el8"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "glibc",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "compat-glibc",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "glibc",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2023-10-03T17:00:00Z",
  "bugzilla": {
    "description": "glibc: buffer overflow in ld.so leading to privilege escalation",
    "id": "2238352",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2238352"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-122",
  "statement": "This vulnerability was introduced in glibc version 2.34. RHEL-8 ships glibc 2.28, which is not originally affected by this vulnerability. However, the commit that introduced this vulnerability was backported to RHEL-8.5, making this version and onward vulnerable. RHEL-8.4 and older are not affected by this vulnerability.",
  "acknowledgement": "Red Hat would like to thank Qualys Research Labs for reporting this issue.",
  "name": "CVE-2023-4911",
  "document_distribution": "",
  "details": [
    "A buffer overflow was discovered in the GNU C Library's dynamic loader ld.so while processing the GLIBC_TUNABLES environment variable. This issue could allow a local attacker to use maliciously crafted GLIBC_TUNABLES environment variables when launching binaries with SUID permission to execute code with elevated privileges.",
    "A buffer overflow was discovered in the GNU C Library's dynamic loader ld.so while processing the GLIBC_TUNABLES environment variable. This issue could allow a local attacker to use maliciously crafted GLIBC_TUNABLES environment variables when launching binaries with SUID permission to execute code with elevated privileges."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-4911\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-4911\nhttps://www.qualys.com/2023/10/03/cve-2023-4911/looney-tunables-local-privilege-escalation-glibc-ld-so.txt\nhttps://www.qualys.com/cve-2023-4911/"
  ]
}