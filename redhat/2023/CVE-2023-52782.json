{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Low",
  "public_date": "2024-05-21T00:00:00Z",
  "bugzilla": {
    "description": "kernel: net/mlx5e: Track xmit submission to PTP WQ after populating metadata map",
    "id": "2282705",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2282705"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "4.4",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-476",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2023-52782",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnet/mlx5e: Track xmit submission to PTP WQ after populating metadata map\nEnsure the skb is available in metadata mapping to skbs before tracking the\nmetadata index for detecting undelivered CQEs. If the metadata index is put\nin the tracking list before putting the skb in the map, the metadata index\nmight be used for detecting undelivered CQEs before the relevant skb is\navailable in the map, which can lead to a null-ptr-deref.\nLog:\ngeneral protection fault, probably for non-canonical address 0xdffffc0000000005: 0000 [#1] SMP KASAN\nKASAN: null-ptr-deref in range [0x0000000000000028-0x000000000000002f]\nCPU: 0 PID: 1243 Comm: kworker/0:2 Not tainted 6.6.0-rc4+ #108\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.13.0-0-gf21b5a4aeb02-prebuilt.qemu.org 04/01/2014\nWorkqueue: events mlx5e_rx_dim_work [mlx5_core]\nRIP: 0010:mlx5e_ptp_napi_poll+0x9a4/0x2290 [mlx5_core]\nCode: 8c 24 38 cc ff ff 4c 8d 3c c1 4c 89 f9 48 c1 e9 03 42 80 3c 31 00 0f 85 97 0f 00 00 4d 8b 3f 49 8d 7f 28 48 89 f9 48 c1 e9 03 \u003c42\u003e 80 3c 31 00 0f 85 8b 0f 00 00 49 8b 47 28 48 85 c0 0f 84 05 07\nRSP: 0018:ffff8884d3c09c88 EFLAGS: 00010206\nRAX: 0000000000000069 RBX: ffff8881160349d8 RCX: 0000000000000005\nRDX: ffffed10218f48cf RSI: 0000000000000004 RDI: 0000000000000028\nRBP: ffff888122707700 R08: 0000000000000001 R09: ffffed109a781383\nR10: 0000000000000003 R11: 0000000000000003 R12: ffff88810c7a7a40\nR13: ffff888122707700 R14: dffffc0000000000 R15: 0000000000000000\nFS:  0000000000000000(0000) GS:ffff8884d3c00000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007f4f878dd6e0 CR3: 000000014d108002 CR4: 0000000000370eb0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n\u003cIRQ\u003e\n? die_addr+0x3c/0xa0\n? exc_general_protection+0x144/0x210\n? asm_exc_general_protection+0x22/0x30\n? mlx5e_ptp_napi_poll+0x9a4/0x2290 [mlx5_core]\n? mlx5e_ptp_napi_poll+0x8f6/0x2290 [mlx5_core]\n__napi_poll.constprop.0+0xa4/0x580\nnet_rx_action+0x460/0xb80\n? _raw_spin_unlock_irqrestore+0x32/0x60\n? __napi_poll.constprop.0+0x580/0x580\n? tasklet_action_common.isra.0+0x2ef/0x760\n__do_softirq+0x26c/0x827\nirq_exit_rcu+0xc2/0x100\ncommon_interrupt+0x7f/0xa0\n\u003c/IRQ\u003e\n\u003cTASK\u003e\nasm_common_interrupt+0x22/0x40\nRIP: 0010:__kmem_cache_alloc_node+0xb/0x330\nCode: 41 5d 41 5e 41 5f c3 8b 44 24 14 8b 4c 24 10 09 c8 eb d5 e8 b7 43 ca 01 0f 1f 80 00 00 00 00 0f 1f 44 00 00 55 48 89 e5 41 57 \u003c41\u003e 56 41 89 d6 41 55 41 89 f5 41 54 49 89 fc 53 48 83 e4 f0 48 83\nRSP: 0018:ffff88812c4079c0 EFLAGS: 00000246\nRAX: 1ffffffff083c7fe RBX: ffff888100042dc0 RCX: 0000000000000218\nRDX: 00000000ffffffff RSI: 0000000000000dc0 RDI: ffff888100042dc0\nRBP: ffff88812c4079c8 R08: ffffffffa0289f96 R09: ffffed1025880ea9\nR10: ffff888138839f80 R11: 0000000000000002 R12: 0000000000000dc0\nR13: 0000000000000100 R14: 000000000000008c R15: ffff8881271fc450\n? cmd_exec+0x796/0x2200 [mlx5_core]\nkmalloc_trace+0x26/0xc0\ncmd_exec+0x796/0x2200 [mlx5_core]\nmlx5_cmd_do+0x22/0xc0 [mlx5_core]\nmlx5_cmd_exec+0x17/0x30 [mlx5_core]\nmlx5_core_modify_cq_moderation+0x139/0x1b0 [mlx5_core]\n? mlx5_add_cq_to_tasklet+0x280/0x280 [mlx5_core]\n? lockdep_set_lock_cmp_fn+0x190/0x190\n? process_one_work+0x659/0x1220\nmlx5e_rx_dim_work+0x9d/0x100 [mlx5_core]\nprocess_one_work+0x730/0x1220\n? lockdep_hardirqs_on_prepare+0x400/0x400\n? max_active_store+0xf0/0xf0\n? assign_work+0x168/0x240\nworker_thread+0x70f/0x12d0\n? __kthread_parkme+0xd1/0x1d0\n? process_one_work+0x1220/0x1220\nkthread+0x2d9/0x3b0\n? kthread_complete_and_exit+0x20/0x20\nret_from_fork+0x2d/0x70\n? kthread_complete_and_exit+0x20/0x20\nret_from_fork_as\n---truncated---"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-52782\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-52782\nhttps://lore.kernel.org/linux-cve-announce/2024052153-CVE-2023-52782-acc6@gregkh/T"
  ]
}