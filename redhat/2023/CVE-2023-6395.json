{
  "mitigation": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "mock",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-01-16T13:52:00Z",
  "bugzilla": {
    "description": "Mock: Privilege escalation for users that can access mock configuration",
    "id": "2252206",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2252206"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.7",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-20",
  "statement": "The identified vulnerability in the Mock software represents a moderate threat from a technical standpoint. The risk lies in the potential for an attacker to exploit privilege escalation, gaining the ability to execute arbitrary code with root user privileges. This vulnerability arises due to the absence of proper sandboxing during the expansion and execution of Jinja2 templates in specific configuration parameters. While the Mock documentation advises treating certain users as privileged, the risk is amplified by certain build systems inadvertently allowing less privileged users to define configuration tags. These tags can be passed as parameters to Mock during execution, creating a pathway for remote privilege escalation and the execution of arbitrary code on the build server. The moderate classification is attributed to the specific conditions required for exploitation and the potential impact on system integrity.\nThe fix for this issue is located at the `TemplatedDictionary' library, which mock heavily relies on to expand configuration values. This library was part of `mock` before but it was stripped to a separated code base in mock 2.9-1, while the vulnerability itself was introduced while `TemplatedDictionary` was part of mock code base in mock 1.4.\nRed Hat Enterprise Linux 7, 8 and 9 are not affected by this vulnerability as those versions doesn't ship the `mock` package.",
  "acknowledgement": "Red Hat would like to thank Sankin Nikita Alexeevich for reporting this issue.",
  "name": "CVE-2023-6395",
  "document_distribution": "",
  "details": [
    "The Mock software contains a vulnerability wherein an attacker could potentially exploit privilege escalation, enabling the execution of arbitrary code with root user privileges. This weakness stems from the absence of proper sandboxing during the expansion and execution of Jinja2 templates, which may be included in certain configuration parameters. While the Mock documentation advises treating users added to the mock group as privileged, certain build systems invoking mock on behalf of users might inadvertently permit less privileged users to define configuration tags. These tags could then be passed as parameters to mock during execution, potentially leading to the utilization of Jinja2 templates for remote privilege escalation and the execution of arbitrary code as the root user on the build server.",
    "The Mock software contains a vulnerability wherein an attacker could potentially exploit privilege escalation, enabling the execution of arbitrary code with root user privileges. This weakness stems from the absence of proper sandboxing during the expansion and execution of Jinja2 templates, which may be included in certain configuration parameters. While the Mock documentation advises treating users added to the mock group as privileged, certain build systems invoking mock on behalf of users might inadvertently permit less privileged users to define configuration tags. These tags could then be passed as parameters to mock during execution, potentially leading to the utilization of Jinja2 templates for remote privilege escalation and the execution of arbitrary code as the root user on the build server."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-6395\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-6395\nhttps://github.com/xsuchy/templated-dictionary/commit/0740bd0ca8d487301881541028977d120f8b8933\nhttps://github.com/xsuchy/templated-dictionary/commit/bcd90f0dafa365575c4b101e6f5d98c4ef4e4b69"
  ]
}