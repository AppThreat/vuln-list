{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-03-02T00:00:00Z",
  "bugzilla": {
    "description": "kernel: netfs: Only call folio_start_fscache() one time for each folio",
    "id": "2267762",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2267762"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2023-52582",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnetfs: Only call folio_start_fscache() one time for each folio\nIf a network filesystem using netfs implements a clamp_length()\nfunction, it can set subrequest lengths smaller than a page size.\nWhen we loop through the folios in netfs_rreq_unlock_folios() to\nset any folios to be written back, we need to make sure we only\ncall folio_start_fscache() once for each folio.\nOtherwise, this simple testcase:\nmount -o fsc,rsize=1024,wsize=1024 127.0.0.1:/export /mnt/nfs\ndd if=/dev/zero of=/mnt/nfs/file.bin bs=4096 count=1\n1+0 records in\n1+0 records out\n4096 bytes (4.1 kB, 4.0 KiB) copied, 0.0126359 s, 324 kB/s\necho 3 \u003e /proc/sys/vm/drop_caches\ncat /mnt/nfs/file.bin \u003e /dev/null\nwill trigger an oops similar to the following:\npage dumped because: VM_BUG_ON_FOLIO(folio_test_private_2(folio))\n------------[ cut here ]------------\nkernel BUG at include/linux/netfs.h:44!\n...\nCPU: 5 PID: 134 Comm: kworker/u16:5 Kdump: loaded Not tainted 6.4.0-rc5\n...\nRIP: 0010:netfs_rreq_unlock_folios+0x68e/0x730 [netfs]\n...\nCall Trace:\nnetfs_rreq_assess+0x497/0x660 [netfs]\nnetfs_subreq_terminated+0x32b/0x610 [netfs]\nnfs_netfs_read_completion+0x14e/0x1a0 [nfs]\nnfs_read_completion+0x2f9/0x330 [nfs]\nrpc_free_task+0x72/0xa0 [sunrpc]\nrpc_async_release+0x46/0x70 [sunrpc]\nprocess_one_work+0x3bd/0x710\nworker_thread+0x89/0x610\nkthread+0x181/0x1c0\nret_from_fork+0x29/0x50"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-52582\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-52582\nhttps://lore.kernel.org/linux-cve-announce/2024030258-CVE-2023-52582-07c8@gregkh/T/#u"
  ]
}