{
  "mitigation": "This flaw can be PARTIALLY mitigated via the following options in the main.cf:\nsmtpd_data_restrictions = reject_unauth_pipelining\nsmtpd_discard_ehlo_keywords = chunking, silent-discard\nPlease note this only blocks the misuse of SMTP command pipelining, but does not address message pipelining nor malformed line endings. The only fix for these issues are via package updates.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "postfix",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "postfix",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "postfix",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "postfix",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2023-12-18T00:00:00Z",
  "bugzilla": {
    "description": "postfix: SMTP smuggling vulnerability",
    "id": "2255563",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2255563"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.3",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-345-\u003eCWE-451",
  "statement": "The impact is considered Moderate likely due to certain conditions required for successful exploitation, such as specific server configurations.",
  "acknowledgement": "",
  "name": "CVE-2023-51764",
  "document_distribution": "",
  "details": [
    "Postfix through 3.8.5 allows SMTP smuggling unless configured with smtpd_data_restrictions=reject_unauth_pipelining and smtpd_discard_ehlo_keywords=chunking (or certain other options that exist in recent versions). Remote attackers can use a published exploitation technique to inject e-mail messages with a spoofed MAIL FROM address, allowing bypass of an SPF protection mechanism. This occurs because Postfix supports \u003cLF\u003e.\u003cCR\u003e\u003cLF\u003e but some other popular e-mail servers do not. To prevent attack variants (by always disallowing \u003cLF\u003e without \u003cCR\u003e), a different solution is required, such as the smtpd_forbid_bare_newline=yes option with a Postfix minimum version of 3.5.23, 3.6.13, 3.7.9, 3.8.4, or 3.9.",
    "A flaw was found in some SMTP server configurations in Postfix. This flaw allows a remote attacker to break out email message data to \"smuggle\" SMTP commands and send spoofed emails that pass SPF checks.\nOut of the box, Postfix targets to accommodate older clients with faulty SMTP implementations due to which restrictions are not enforced in the default configuration. Appropriate mitigation strategies are mentioned in the appropriate section below."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-51764\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-51764\nhttps://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/\nhttps://www.postfix.org/smtp-smuggling.html"
  ]
}