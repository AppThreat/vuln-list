{
  "mitigation": "No mitigations are available for this issue.",
  "affected_release": [
    {
      "product_name": "Migration Toolkit for Runtimes 1 on RHEL 8",
      "release_date": "2023-10-26T00:00:00Z",
      "advisory": "RHSA-2023:6138",
      "package": "plexus-archiver",
      "cpe": "cpe:/a:redhat:migration_toolkit_runtimes:1.0::el8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2023-11-13T00:00:00Z",
      "advisory": "RHSA-2023:6886",
      "package": "plexus-archiver-0:2.4.2-6.el7_9",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    }
  ],
  "package_state": [
    {
      "product_name": "A-MQ Clients 2",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:a_mq_clients:2"
    },
    {
      "product_name": "Cryostat 2",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:cryostat:2"
    },
    {
      "product_name": "Logging Subsystem for Red Hat OpenShift",
      "fix_state": "Affected",
      "package_name": "openshift-logging/elasticsearch6-rhel8",
      "cpe": "cpe:/a:redhat:logging:5"
    },
    {
      "product_name": "Migration Toolkit for Applications 6",
      "fix_state": "Affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:migration_toolkit_applications:6"
    },
    {
      "product_name": "OpenShift Serverless",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:serverless:1"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2"
    },
    {
      "product_name": "Red Hat build of Apache Camel for Spring Boot",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:camel_spring_boot:3"
    },
    {
      "product_name": "Red Hat build of OptaPlanner 8",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:optaplanner:::el6"
    },
    {
      "product_name": "Red Hat Data Grid 8",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:jboss_data_grid:8"
    },
    {
      "product_name": "Red Hat Decision Manager 7",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7"
    },
    {
      "product_name": "Red Hat Integration Camel K",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat Integration Camel Quarkus",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:camel_quarkus:2"
    },
    {
      "product_name": "Red Hat Integration Change Data Capture",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:debezium:2"
    },
    {
      "product_name": "Red Hat Integration Service Registry",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:service_registry:2"
    },
    {
      "product_name": "Red Hat JBoss A-MQ 7",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:amq_broker:7"
    },
    {
      "product_name": "Red Hat JBoss A-MQ Streams",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:amq_streams:1"
    },
    {
      "product_name": "Red Hat JBoss Data Grid 7",
      "fix_state": "Out of support scope",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:jboss_data_grid:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Out of support scope",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 7",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 8",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:8"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:jbosseapxp"
    },
    {
      "product_name": "Red Hat JBoss Fuse 6",
      "fix_state": "Out of support scope",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:jboss_fuse:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Will not fix",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat JBoss Fuse Service Works 6",
      "fix_state": "Out of support scope",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:jboss_fuse_service_works:6"
    },
    {
      "product_name": "Red Hat JBoss Web Server 5",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5"
    },
    {
      "product_name": "Red Hat Process Automation 7",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7"
    },
    {
      "product_name": "Red Hat Single Sign-On 7",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7"
    },
    {
      "product_name": "Red Hat support for Spring Boot",
      "fix_state": "Not affected",
      "package_name": "plexus-archiver",
      "cpe": "cpe:/a:redhat:openshift_application_runtimes:1.0"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2023-07-25T00:00:00Z",
  "bugzilla": {
    "description": "plexus-archiver: Arbitrary File Creation in AbstractUnArchiver",
    "id": "2242288",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2242288"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "(CWE-22|CWE-61)",
  "statement": "There are factors beyond the attacker's control. For example, the victim's server must have an incomplete SSH server configuration by not having the \"~/.ssh/authorized_keys\" existent and also having an SSH Server Port externally accessible. So, an attacker would need, even in other scenarios, to gather configuration settings and previous knowledge about the environment in order to have a successful attack. The impact is Important as code execution might happen, but it is not guaranteed.\nRed Hat Fuse 7 contains plexus-archiver as a transitive dependency and does not make it vulnerable during runtime, hence the low impact.",
  "acknowledgement": "",
  "name": "CVE-2023-37460",
  "document_distribution": "",
  "details": [
    "Plexis Archiver is a collection of Plexus components to create archives or extract archives to a directory with a unified `Archiver`/`UnArchiver` API. Prior to version 4.8.0, using AbstractUnArchiver for extracting an archive might lead to an arbitrary file creation and possibly remote code execution. When extracting an archive with an entry that already exists in the destination directory as a symbolic link whose target does not exist - the `resolveFile()` function will return the symlink's source instead of its target, which will pass the verification that ensures the file will not be extracted outside of the destination directory. Later `Files.newOutputStream()`, that follows symlinks by default,  will actually write the entry's content to the symlink's target. Whoever uses plexus archiver to extract an untrusted archive is vulnerable to an arbitrary file creation and possibly remote code execution. Version 4.8.0 contains a patch for this issue.",
    "A flaw was found in the Plexus Archiver. While using AbstractUnArchiver for extracting, an archive might lead to arbitrary file creation and possible remote code execution (RCE). Extracting an archive with an entry in the destination directory as a symbolic link whose target does not exist will bypass the directory destination verification."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-37460\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-37460\nhttps://github.com/codehaus-plexus/plexus-archiver/security/advisories/GHSA-wh3p-fphp-9h2m\nhttps://research.jfrog.com/vulnerabilities/plexus-archiver-arbitrary-file-overwrite-xray-526292/"
  ]
}