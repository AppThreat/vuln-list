{
  "mitigation": "To avoid this issue, we recommend you do not use `CURLPROXY_SOCKS5_HOSTNAME` proxies with curl. Also do not set a proxy environment variable to socks5h://",
  "affected_release": [
    {
      "product_name": "JBoss Core Services for RHEL 8",
      "release_date": "2023-12-07T00:00:00Z",
      "advisory": "RHSA-2023:7625",
      "package": "jbcs-httpd24-curl-0:8.4.0-2.el8jbcs",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el8"
    },
    {
      "product_name": "JBoss Core Services on RHEL 7",
      "release_date": "2023-12-07T00:00:00Z",
      "advisory": "RHSA-2023:7625",
      "package": "jbcs-httpd24-curl-0:8.4.0-2.el7jbcs",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-10-17T00:00:00Z",
      "advisory": "RHSA-2023:5763",
      "package": "curl-0:7.76.1-23.el9_2.4",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-11-07T00:00:00Z",
      "advisory": "RHSA-2023:6745",
      "package": "curl-0:7.76.1-26.el9_3.2",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-10-17T00:00:00Z",
      "advisory": "RHSA-2023:5763",
      "package": "curl-0:7.76.1-23.el9_2.4",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-11-07T00:00:00Z",
      "advisory": "RHSA-2023:6745",
      "package": "curl-0:7.76.1-26.el9_3.2",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.0 Extended Update Support",
      "release_date": "2023-10-13T00:00:00Z",
      "advisory": "RHSA-2023:5700",
      "package": "curl-0:7.76.1-14.el9_0.9",
      "cpe": "cpe:/a:redhat:rhel_eus:9.0"
    },
    {
      "product_name": "Red Hat JBoss Core Services 1",
      "release_date": "2023-12-07T00:00:00Z",
      "advisory": "RHSA-2023:7626",
      "package": "curl",
      "cpe": "cpe:/a:redhat:jboss_core_services:1"
    },
    {
      "product_name": "Red Hat Satellite 6.14 for RHEL 8",
      "release_date": "2024-02-13T00:00:00Z",
      "advisory": "RHSA-2024:0797",
      "package": "puppet-agent-0:7.27.0-1.el8sat",
      "cpe": "cpe:/a:redhat:satellite:6.14::el8"
    },
    {
      "product_name": "Red Hat Satellite 6.14 for RHEL 8",
      "release_date": "2024-02-13T00:00:00Z",
      "advisory": "RHSA-2024:0797",
      "package": "puppet-agent-0:7.27.0-1.el8sat",
      "cpe": "cpe:/a:redhat:satellite_capsule:6.14::el8"
    },
    {
      "product_name": "Satellite Client 6 for RHEL 6",
      "release_date": "2024-04-23T00:00:00Z",
      "advisory": "RHSA-2024:2011",
      "package": "puppet-agent-0:7.27.0-1.el6sat",
      "cpe": "cpe:/a:redhat:rhel_satellite_client:6::el6"
    },
    {
      "product_name": "Satellite Client 6 for RHEL 7",
      "release_date": "2024-04-23T00:00:00Z",
      "advisory": "RHSA-2024:2011",
      "package": "puppet-agent-0:7.27.0-1.el7sat",
      "cpe": "cpe:/a:redhat:rhel_satellite_client:6::el7"
    },
    {
      "product_name": "Satellite Client 6 for RHEL 8",
      "release_date": "2024-04-23T00:00:00Z",
      "advisory": "RHSA-2024:2011",
      "package": "puppet-agent-0:7.27.0-1.el8sat",
      "cpe": "cpe:/a:redhat:rhel_satellite_client:6::el8"
    },
    {
      "product_name": "Satellite Client 6 for RHEL 9",
      "release_date": "2024-04-23T00:00:00Z",
      "advisory": "RHSA-2024:2011",
      "package": "puppet-agent-0:7.27.0-1.el9sat",
      "cpe": "cpe:/a:redhat:rhel_satellite_client:6::el9"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "curl",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "curl",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "curl",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2023-10-11T00:00:00Z",
  "bugzilla": {
    "description": "curl: heap based buffer overflow in the SOCKS5 proxy handshake",
    "id": "2241933",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2241933"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-119",
  "statement": "This flaw does not affect the versions of curl as shipped with Red Hat Enterprise Linux 6, 7, and 8.\nAn overflow is only possible in applications that do not set `CURLOPT_BUFFERSIZE`, or set it smaller than approximately 65kB. Since the curl tool sets `CURLOPT_BUFFERSIZE` to 100kB by default, it is not vulnerable unless rate limiting was set by the user to a size smaller than 65kB.\nKnowledgebase article:\nhttps://access.redhat.com/solutions/7045099",
  "acknowledgement": "Red Hat would like to thank Jay Satiro for reporting this issue.",
  "name": "CVE-2023-38545",
  "document_distribution": "",
  "details": [
    "This flaw makes curl overflow a heap based buffer in the SOCKS5 proxy\nhandshake.\nWhen curl is asked to pass along the host name to the SOCKS5 proxy to allow\nthat to resolve the address instead of it getting done by curl itself, the\nmaximum length that host name can be is 255 bytes.\nIf the host name is detected to be longer, curl switches to local name\nresolving and instead passes on the resolved address only. Due to this bug,\nthe local variable that means \"let the host resolve the name\" could get the\nwrong value during a slow SOCKS5 handshake, and contrary to the intention,\ncopy the too long host name to the target buffer instead of copying just the\nresolved address there.\nThe target buffer being a heap based buffer, and the host name coming from the\nURL that curl has been told to operate with.",
    "A heap-based buffer overflow flaw was found in the SOCKS5 proxy handshake in the Curl package. If Curl is unable to resolve the address itself, it passes the hostname to the SOCKS5 proxy. However, the maximum length of the hostname that can be passed is 255 bytes. If the hostname is longer, then Curl switches to the local name resolving and passes the resolved address only to the proxy. The local variable that instructs Curl to \"let the host resolve the name\" could obtain the wrong value during a slow SOCKS5 handshake, resulting in the too-long hostname being copied to the target buffer instead of the resolved address, which was not the intended behavior."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-38545\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-38545\nhttps://curl.se/docs/CVE-2023-38545.html"
  ]
}