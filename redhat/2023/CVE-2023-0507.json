{
  "mitigation": "Applying the Content-Security-Policy shipped with Grafana would block inline scripts from executing and would mitigate this.",
  "affected_release": [
    {
      "product_name": "Red Hat Ceph Storage 5.3",
      "release_date": "2024-02-08T00:00:00Z",
      "advisory": "RHSA-2024:0746",
      "package": "rhceph/rhceph-5-dashboard-rhel8:5-83",
      "cpe": "cpe:/a:redhat:ceph_storage:5.3::el8"
    }
  ],
  "package_state": [
    {
      "product_name": "OpenShift Service Mesh 2.1",
      "fix_state": "Not affected",
      "package_name": "servicemesh-grafana",
      "cpe": "cpe:/a:redhat:service_mesh:2.1"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Affected",
      "package_name": "rhacm2/acm-grafana-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Ceph Storage 3",
      "fix_state": "Not affected",
      "package_name": "grafana",
      "cpe": "cpe:/a:redhat:ceph_storage:3"
    },
    {
      "product_name": "Red Hat Ceph Storage 4",
      "fix_state": "Not affected",
      "package_name": "rhceph/rhceph-4-dashboard-rhel8",
      "cpe": "cpe:/a:redhat:ceph_storage:4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "grafana",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "grafana",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Not affected",
      "package_name": "openshift4/ose-grafana",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat Storage 3",
      "fix_state": "Not affected",
      "package_name": "grafana",
      "cpe": "cpe:/a:redhat:storage:3"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2023-03-01T00:00:00Z",
  "bugzilla": {
    "description": "grafana: cross site scripting",
    "id": "2168038",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2168038"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.3",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-80",
  "statement": "For Grafana package shipped in Red Hat Enterprise Linux, it is not possible to take advantage of this vulnerability without specialized 'editor' access, which reduces the impact of this issue in RHEL. Thus, it is set to Moderate.",
  "acknowledgement": "Upstream acknowledges Grafana Security Team as the original reporter.",
  "name": "CVE-2023-0507",
  "document_distribution": "",
  "details": [
    "Grafana is an open-source platform for monitoring and observability. \nStarting with the 8.1 branch, Grafana had a stored XSS vulnerability affecting the core plugin GeoMap. \nThe stored XSS vulnerability was possible due to map attributions weren't properly sanitized and allowed arbitrary JavaScript to be executed in the context of the currently authorized user of the Grafana instance. \nAn attacker needs to have the Editor role in order to change a panel to include a map attribution containing JavaScript. \nThis means that vertical privilege escalation is possible, where a user with Editor role can change to a known password for a user having Admin role if the user with Admin role executes malicious JavaScript viewing a dashboard. \nUsers may upgrade to version 8.5.21, 9.2.13 and 9.3.8 to receive a fix.",
    "A flaw was found in the GeoMap Grafana plugin, where a user can store unsanitized HTML in the GeoMap plugin under the Attribution text field, and the client will process it. The vulnerability makes it possible to use XHR to make arbitrary API calls on behalf of the attacked user. This means that a malicious user with editor permissions could alter a GeoMap panel to include JavaScript that changes the password for the user viewing the panel (this could be an admin) to a known password, thus gaining access to the admin account and resulting as the editor becoming an admin."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-0507\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-0507\nhttps://grafana.com/security/security-advisories/CVE-2023-0507"
  ]
}