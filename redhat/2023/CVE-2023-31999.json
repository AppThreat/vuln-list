{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat OpenShift Dev Spaces",
      "fix_state": "Affected",
      "package_name": "devspaces/dashboard-rhel8",
      "cpe": "cpe:/a:redhat:openshift_devspaces:3::el8"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2023-07-04T00:00:00Z",
  "bugzilla": {
    "description": "fastify-oauth2: CSRF due to reused Oauth2 state",
    "id": "2219737",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2219737"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.4",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-352",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2023-31999",
  "document_distribution": "",
  "details": [
    "All versions of @fastify/oauth2 used a statically generated state parameter at startup time and were used across all requests for all users. The purpose of the Oauth2 state parameter is to prevent Cross-Site-Request-Forgery attacks. As such, it should be unique per user and should be connected to the user's session in some way that will allow the server to validate it.\nv7.2.0 changes the default behavior to store the state in a cookie with the http-only and same-site=lax attributes set. The state is now by default generated for every user. Note that this contains a breaking change in the checkStateFunction function, which now accepts the full Request object.",
    "A Cross-Site Request Forgery (CSRF) flaw was found in Oauth2. This issue exists due to the state parameter being statically generated at startup time and used across all requests for all users. An attacker could use the value of the state parameter to create forged requests on behalf of other users or other sessions of the same user."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-31999\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-31999\nhttps://github.com/fastify/fastify-oauth2/security/advisories/GHSA-g8x5-p9qc-cf95"
  ]
}