{
  "affected_release": [
    {
      "product_name": "Red Hat AMQ Streams 2.5.0",
      "release_date": "2023-09-14T00:00:00Z",
      "advisory": "RHSA-2023:5165",
      "package": "",
      "cpe": "cpe:/a:redhat:amq_streams:2"
    },
    {
      "product_name": "RHINT Camel-K 1.10.5",
      "release_date": "2024-01-10T00:00:00Z",
      "advisory": "RHSA-2024:0148",
      "package": "snappy-java",
      "cpe": "cpe:/a:redhat:camel_k:1.10.5"
    },
    {
      "product_name": "RHINT Camel-Springboot 3.18.3.2",
      "release_date": "2023-09-13T00:00:00Z",
      "advisory": "RHSA-2023:5147",
      "package": "snappy-java",
      "cpe": "cpe:/a:redhat:camel_spring_boot:3.18"
    },
    {
      "product_name": "RHINT Camel-Springboot 3.20.2",
      "release_date": "2023-09-13T00:00:00Z",
      "advisory": "RHSA-2023:5148",
      "package": "",
      "cpe": "cpe:/a:redhat:camel_spring_boot:3.20"
    },
    {
      "product_name": "RHINT Service Registry 2.5.4 GA",
      "release_date": "2023-12-05T00:00:00Z",
      "advisory": "RHSA-2023:7653",
      "package": "snappy-java",
      "cpe": "cpe:/a:redhat:service_registry:2.5"
    }
  ],
  "package_state": [
    {
      "product_name": "A-MQ Clients 2",
      "fix_state": "Not affected",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:a_mq_clients:2"
    },
    {
      "product_name": "Logging Subsystem for Red Hat OpenShift",
      "fix_state": "Not affected",
      "package_name": "openshift-logging/elasticsearch6-rhel8",
      "cpe": "cpe:/a:redhat:logging:5"
    },
    {
      "product_name": "OpenShift Serverless",
      "fix_state": "Will not fix",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:serverless:1"
    },
    {
      "product_name": "Red Hat build of OptaPlanner 8",
      "fix_state": "Affected",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:optaplanner:::el6"
    },
    {
      "product_name": "Red Hat build of Quarkus",
      "fix_state": "Affected",
      "package_name": "org.xerial.snappy/snappy-java",
      "cpe": "cpe:/a:redhat:quarkus:2"
    },
    {
      "product_name": "Red Hat Data Grid 8",
      "fix_state": "Not affected",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:jboss_data_grid:8"
    },
    {
      "product_name": "Red Hat Decision Manager 7",
      "fix_state": "Will not fix",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Will not fix",
      "package_name": "log4j:2/log4j",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Will not fix",
      "package_name": "log4j",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Integration Camel Quarkus",
      "fix_state": "Affected",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:camel_quarkus:2"
    },
    {
      "product_name": "Red Hat Integration Change Data Capture",
      "fix_state": "Affected",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:debezium:2"
    },
    {
      "product_name": "Red Hat JBoss A-MQ 7",
      "fix_state": "Affected",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:amq_broker:7"
    },
    {
      "product_name": "Red Hat JBoss A-MQ Streams",
      "fix_state": "Affected",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:amq_streams:1"
    },
    {
      "product_name": "Red Hat JBoss Data Grid 7",
      "fix_state": "Out of support scope",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:jboss_data_grid:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Out of support scope",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 7",
      "fix_state": "Not affected",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 8",
      "fix_state": "Not affected",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:8"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack",
      "fix_state": "Not affected",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:jbosseapxp"
    },
    {
      "product_name": "Red Hat JBoss Fuse 6",
      "fix_state": "Not affected",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:jboss_fuse:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Not affected",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat JBoss Fuse Service Works 6",
      "fix_state": "Out of support scope",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:jboss_fuse_service_works:6"
    },
    {
      "product_name": "Red Hat OpenShift Application Runtimes",
      "fix_state": "Will not fix",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:openshift_application_runtimes:1.0"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Out of support scope",
      "package_name": "openshift3/metrics-cassandra",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Out of support scope",
      "package_name": "openshift3/ose-metrics-cassandra",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    },
    {
      "product_name": "Red Hat Process Automation 7",
      "fix_state": "Will not fix",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7"
    },
    {
      "product_name": "Red Hat Software Collections",
      "fix_state": "Will not fix",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2023-06-16T00:00:00Z",
  "bugzilla": {
    "description": "snappy-java: Unchecked chunk length leads to DoS",
    "id": "2215445",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2215445"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.9",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-1285",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2023-34455",
  "document_distribution": "",
  "details": [
    "snappy-java is a fast compressor/decompressor for Java. Due to use of an unchecked chunk length, an unrecoverable fatal error can occur in versions prior to 1.1.10.1.\nThe code in the function hasNextChunk in the fileSnappyInputStream.java checks if a given stream has more chunks to read. It does that by attempting to read 4 bytes. If it wasn’t possible to read the 4 bytes, the function returns false. Otherwise, if 4 bytes were available, the code treats them as the length of the next chunk.\nIn the case that the `compressed` variable is null, a byte array is allocated with the size given by the input data. Since the code doesn’t test the legality of the `chunkSize` variable, it is possible to pass a negative number (such as 0xFFFFFFFF which is -1), which will cause the code to raise a `java.lang.NegativeArraySizeException` exception. A worse case would happen when passing a huge positive value (such as 0x7FFFFFFF), which would raise the fatal `java.lang.OutOfMemoryError` error.\nVersion 1.1.10.1 contains a patch for this issue.",
    "A flaw was found in Snappy-java's fileSnappyInputStream hasNextChunk function, which does not sufficiently evaluate input bytes before beginning operations. This issue could allow an attacker to send malicious input to trigger an out of memory error that crashes the program, resulting in a denial of service."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-34455\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-34455"
  ]
}