{
  "affected_release": [
    {
      "product_name": "Red Hat AMQ Streams 2.5.0",
      "release_date": "2023-09-14T00:00:00Z",
      "advisory": "RHSA-2023:5165",
      "package": "",
      "cpe": "cpe:/a:redhat:amq_streams:2"
    }
  ],
  "package_state": [
    {
      "product_name": "Logging Subsystem for Red Hat OpenShift",
      "fix_state": "Not affected",
      "package_name": "openshift-logging/elasticsearch6-rhel8",
      "cpe": "cpe:/a:redhat:logging:5"
    },
    {
      "product_name": "OpenShift Serverless",
      "fix_state": "Will not fix",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:serverless:1"
    },
    {
      "product_name": "Red Hat build of Quarkus",
      "fix_state": "Affected",
      "package_name": "org.xerial.snappy/snappy-java",
      "cpe": "cpe:/a:redhat:quarkus:2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "log4j:2/log4j",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "log4j",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat JBoss Fuse 6",
      "fix_state": "Will not fix",
      "package_name": "snappy-java-all",
      "cpe": "cpe:/a:redhat:jboss_fuse:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse 6",
      "fix_state": "Will not fix",
      "package_name": "snappy-java-all-repolib",
      "cpe": "cpe:/a:redhat:jboss_fuse:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse Service Works 6",
      "fix_state": "Out of support scope",
      "package_name": "snappy-java-all",
      "cpe": "cpe:/a:redhat:jboss_fuse_service_works:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse Service Works 6",
      "fix_state": "Out of support scope",
      "package_name": "snappy-java-all-repolib",
      "cpe": "cpe:/a:redhat:jboss_fuse_service_works:6"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Out of support scope",
      "package_name": "openshift3/metrics-cassandra",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Out of support scope",
      "package_name": "openshift3/ose-metrics-cassandra",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Not affected",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Not affected",
      "package_name": "snappy-java-debuginfo",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Software Collections",
      "fix_state": "Will not fix",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "streams for Apache Kafka",
      "fix_state": "Not affected",
      "package_name": "snappy-java",
      "cpe": "cpe:/a:redhat:amq_streams:1"
    },
    {
      "product_name": "streams for Apache Kafka",
      "fix_state": "Not affected",
      "package_name": "snappy-java-debuginfo",
      "cpe": "cpe:/a:redhat:amq_streams:1"
    },
    {
      "product_name": "streams for Apache Kafka",
      "fix_state": "Not affected",
      "package_name": "snappy-java-repolib",
      "cpe": "cpe:/a:redhat:amq_streams:1"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2023-06-15T00:00:00Z",
  "bugzilla": {
    "description": "snappy-java: Integer overflow in shuffle leads to DoS",
    "id": "2215393",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2215393"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.9",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-190",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2023-34453",
  "document_distribution": "",
  "details": [
    "snappy-java is a fast compressor/decompressor for Java. Due to unchecked multiplications, an integer overflow may occur in versions prior to 1.1.10.1, causing a fatal error.\nThe function `shuffle(int[] input)` in the file `BitShuffle.java` receives an array of integers and applies a bit shuffle on it. It does so by multiplying the length by 4 and passing it to the natively compiled shuffle function. Since the length is not tested, the multiplication by four can cause an integer overflow and become a smaller value than the true size, or even zero or negative. In the case of a negative value, a `java.lang.NegativeArraySizeException` exception will raise, which can crash the program. In a case of a value that is zero or too small, the code that afterwards references the shuffled array will assume a bigger size of the array, which might cause exceptions such as `java.lang.ArrayIndexOutOfBoundsException`.\nThe same issue exists also when using the `shuffle` functions that receive a double, float, long and short, each using a different multiplier that may cause the same issue.\nVersion 1.1.10.1 contains a patch for this vulnerability.",
    "A flaw was found in Snappy-java's shuffle function, which does not check input sizes before beginning operations. This issue could allow an attacker to send malicious input to trigger an overflow error that crashes the program, resulting in a denial of service."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-34453\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-34453"
  ]
}