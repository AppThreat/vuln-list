{
  "mitigation": "Disabling mod_macro and restarting httpd or making sure the macros used are smaller than the required length to trigger this vulnerability will mitigate this flaw. Furthermore, it's unlikely that a very long macro with the length needed to trigger this issue is being used.",
  "affected_release": [
    {
      "product_name": "JBoss Core Services for RHEL 8",
      "release_date": "2024-03-18T00:00:00Z",
      "advisory": "RHSA-2024:1316",
      "package": "jbcs-httpd24-httpd-0:2.4.57-9.el8jbcs",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el8"
    },
    {
      "product_name": "JBoss Core Services on RHEL 7",
      "release_date": "2024-03-18T00:00:00Z",
      "advisory": "RHSA-2024:1316",
      "package": "jbcs-httpd24-httpd-0:2.4.57-9.el7jbcs",
      "cpe": "cpe:/a:redhat:jboss_core_services:1::el7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-04-30T00:00:00Z",
      "advisory": "RHSA-2024:2278",
      "package": "httpd-0:2.4.57-8.el9",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat JBoss Core Services 1",
      "release_date": "2024-03-18T00:00:00Z",
      "advisory": "RHSA-2024:1317",
      "package": "httpd",
      "cpe": "cpe:/a:redhat:jboss_core_services:1"
    }
  ],
  "package_state": [
    {
      "product_name": "OpenShift Pipelines",
      "fix_state": "Affected",
      "package_name": "httpd",
      "cpe": "cpe:/a:redhat:openshift_pipelines:1"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "httpd",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "httpd",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "httpd:2.4/httpd",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Out of support scope",
      "package_name": "httpd22",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat OpenShift Data Science (RHODS)",
      "fix_state": "Will not fix",
      "package_name": "httpd",
      "cpe": "cpe:/a:redhat:openshift_data_science"
    },
    {
      "product_name": "Red Hat OpenShift GitOps",
      "fix_state": "Will not fix",
      "package_name": "httpd",
      "cpe": "cpe:/a:redhat:openshift_gitops:1"
    },
    {
      "product_name": "Red Hat OpenStack Platform 16.1",
      "fix_state": "Not affected",
      "package_name": "httpd",
      "cpe": "cpe:/a:redhat:openstack:16.1"
    },
    {
      "product_name": "Red Hat OpenStack Platform 16.2",
      "fix_state": "Not affected",
      "package_name": "httpd",
      "cpe": "cpe:/a:redhat:openstack:16.2"
    },
    {
      "product_name": "Red Hat OpenStack Platform 17.1",
      "fix_state": "Not affected",
      "package_name": "httpd",
      "cpe": "cpe:/a:redhat:openstack:17.1"
    },
    {
      "product_name": "Red Hat Software Collections",
      "fix_state": "Will not fix",
      "package_name": "httpd24-httpd",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2023-10-19T00:00:00Z",
  "bugzilla": {
    "description": "httpd: mod_macro: out-of-bounds read vulnerability",
    "id": "2245332",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2245332"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-125",
  "statement": "This flaw only affects configurations with mod_macro loaded and when a very long macro is configured and used, specifically a macro longer than 8191 characters. If these conditions are not present, the server is not affected and no further mitigation is needed. For more information about the mitigation, see the mitigation section below.\nThe httpd mod_macro module is enabled by default in Red Hat Enterprise Linux 8, 9, and in RHSCL. However, there are no macros used in the default httpd configuration.",
  "acknowledgement": "",
  "name": "CVE-2023-31122",
  "document_distribution": "",
  "details": [
    "Out-of-bounds Read vulnerability in mod_macro of Apache HTTP Server.This issue affects Apache HTTP Server: through 2.4.57.",
    "A flaw was found in the mod_macro module of httpd. When processing a very long macro, the null byte terminator will not be added, leading to an out-of-bounds read, resulting in a crash."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-31122\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-31122\nhttps://httpd.apache.org/security/vulnerabilities_24.html#CVE-2023-31122"
  ]
}