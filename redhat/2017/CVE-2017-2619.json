{
  "mitigation": "Add the parameter:\nunix extensions = no\nto the [global] section of your smb.conf and restart smbd. This prevents SMB1 clients from creating symlinks on the exported file system using SMB1.\nHowever, if the same region of the file system is also exported using NFS, NFS clients can create symlinks that potentially can also hit the race condition. For non-patched versions of Samba we recommend only exporting areas of the file system by either SMB or NFS, not both.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "release_date": "2017-09-21T00:00:00Z",
      "advisory": "RHSA-2017:2789",
      "package": "samba-0:3.6.23-45.el6_9",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2017-05-22T00:00:00Z",
      "advisory": "RHSA-2017:1265",
      "package": "samba-0:4.4.4-13.el7_3",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.2 for RHEL 7",
      "release_date": "2017-08-01T00:00:00Z",
      "advisory": "RHSA-2017:2338",
      "package": "samba-0:4.6.3-4.el7rhgs",
      "cpe": "cpe:/a:redhat:storage:3.2:samba:el7"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.3 for RHEL 6",
      "release_date": "2017-09-21T00:00:00Z",
      "advisory": "RHSA-2017:2778",
      "package": "libldb-0:1.1.29-1.el6rhs",
      "cpe": "cpe:/a:redhat:storage:3.3:samba:el6"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.3 for RHEL 6",
      "release_date": "2017-09-21T00:00:00Z",
      "advisory": "RHSA-2017:2778",
      "package": "libtalloc-0:2.1.9-1.el6rhs",
      "cpe": "cpe:/a:redhat:storage:3.3:samba:el6"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.3 for RHEL 6",
      "release_date": "2017-09-21T00:00:00Z",
      "advisory": "RHSA-2017:2778",
      "package": "libtdb-0:1.3.12-1.1.el6rhs",
      "cpe": "cpe:/a:redhat:storage:3.3:samba:el6"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.3 for RHEL 6",
      "release_date": "2017-09-21T00:00:00Z",
      "advisory": "RHSA-2017:2778",
      "package": "libtevent-0:0.9.31-1.el6rhs",
      "cpe": "cpe:/a:redhat:storage:3.3:samba:el6"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.3 for RHEL 6",
      "release_date": "2017-09-21T00:00:00Z",
      "advisory": "RHSA-2017:2778",
      "package": "samba-0:4.6.3-5.el6rhs",
      "cpe": "cpe:/a:redhat:storage:3.3:samba:el6"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Will not fix",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Will not fix",
      "package_name": "samba3x",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Affected",
      "package_name": "samba4",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2017-03-23T00:00:00Z",
  "bugzilla": {
    "description": "samba: symlink race permits opening files outside share directory",
    "id": "1429472",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1429472"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.9",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:L/A:L",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-362",
  "statement": "",
  "acknowledgement": "Red Hat would like to thank the Samba project for reporting this issue. Upstream acknowledges Jann Horn (Google) as the original reporter.",
  "name": "CVE-2017-2619",
  "document_distribution": "",
  "details": [
    "Samba before versions 4.6.1, 4.5.7 and 4.4.11 are vulnerable to a malicious client using a symlink race to allow access to areas of the server file system not exported under the share definition.",
    "A race condition was found in samba server. A malicious samba client could use this flaw to access files and directories in areas of the server file system not exported under the share definitions."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2017-2619\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-2619\nhttps://www.samba.org/samba/security/CVE-2017-2619.html"
  ]
}