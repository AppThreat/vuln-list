{
  "mitigation": "Attached to this bugzilla is a systemtap script that will prevent opening (and therefore reading) the /proc/\u003cprocess\u003e/timers file which is used to leak information.\nThe SystemTap script is relatively small and efficient, broken into 3 distinct sections as follows:\n--------\nprobe kernel.function(\"proc_timers_open@fs/proc/base.c\").return { \n// this is -EACCES\n$return = -13;\nmessage = sprintf(\"CVE-2017-18344 mitigation denied access to %s to %s(%d)\", file_name , execname(), pid());\n// print a warning message at KERN_INFO debug level\nprintk(6, message);\n}\nprobe begin {\nprintk(6, \"Mitigation for CVE-2017-18344 loaded.\\n\");\n}\nprobe end {\nprintk(6, \"Mitigation for CVE-2017-18344 unloaded.\\n\");\n}\n---------\nFirst, the script places a probe at the return of the kernel function “proc_timers_open” when called.   This modifies the return value to be EACCES which would return this value to userspace preventing this file from being opened.  When the /proc/\u003cpid\u003e/timer file is attempted to be opened, a message will be logged to the kernel log subsystem showing the process and pid of the application attempting to access the timer file.  \nThis file is not in widespread use at this time, although some applications may read from it to debug or understand their own timers that are set.  This mitigation will not be useful in this context.\nFinally, the “probe begin” and “probe end” code blocks tell systemtap to add the supplied text to the kernel log buffer via the printk function. This creates an audit trail by registering in the system logs exactly when the mitigation is loaded and unloaded.  This will need to be compiled with guru mode (-g parameter) to compile.\nThis will need to be loaded at each boot to remain effective.  Red Hat Product security recommends updating to a patched kernel when it is available.\nRed Hat always seeks to provide both mitigations to disable attacks as well as the actual patches to treat the flaw. To learn more about SystemTap, and how it can be used in your management of your Red Hat systems, please refer to Using SystemTap[1] or one of our videos about it within our Customer Portal[2].\n1 - https://access.redhat.com/articles/17839\n2 - https://access.redhat.com/search/#/?q=systemtap",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2018-10-30T00:00:00Z",
      "advisory": "RHSA-2018:3096",
      "package": "kernel-rt-0:3.10.0-957.rt56.910.el7",
      "cpe": "cpe:/a:redhat:rhel_extras_rt:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2018-10-30T00:00:00Z",
      "advisory": "RHSA-2018:2948",
      "package": "kernel-alt-0:4.14.0-115.el7a",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2018-10-30T00:00:00Z",
      "advisory": "RHSA-2018:3083",
      "package": "kernel-0:3.10.0-957.el7",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.2 Advanced Update Support",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3590",
      "package": "kernel-0:3.10.0-327.76.1.el7",
      "cpe": "cpe:/o:redhat:rhel_aus:7.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.2 Telco Extended Update Support",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3590",
      "package": "kernel-0:3.10.0-327.76.1.el7",
      "cpe": "cpe:/o:redhat:rhel_tus:7.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.2 Update Services for SAP Solutions",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3590",
      "package": "kernel-0:3.10.0-327.76.1.el7",
      "cpe": "cpe:/o:redhat:rhel_e4s:7.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.3 Extended Update Support",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3591",
      "package": "kernel-0:3.10.0-514.61.1.el7",
      "cpe": "cpe:/o:redhat:rhel_eus:7.3"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.4 Extended Update Support",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3540",
      "package": "kernel-0:3.10.0-693.43.1.el7",
      "cpe": "cpe:/o:redhat:rhel_eus:7.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.5 Extended Update Support",
      "release_date": "2018-11-06T00:00:00Z",
      "advisory": "RHSA-2018:3459",
      "package": "kernel-0:3.10.0-862.20.2.el7",
      "cpe": "cpe:/o:redhat:rhel_eus:7.5"
    },
    {
      "product_name": "Red Hat Enterprise MRG 2",
      "release_date": "2018-11-13T00:00:00Z",
      "advisory": "RHSA-2018:3586",
      "package": "kernel-rt-1:3.10.0-693.43.1.rt56.630.el6rt",
      "cpe": "cpe:/a:redhat:enterprise_mrg:2:server:el6"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2017-12-15T00:00:00Z",
  "bugzilla": {
    "description": "kernel: out-of-bounds access in the show_timer function in kernel/time/posix-timers.c",
    "id": "1610958",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1610958"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.1",
    "cvss3_scoring_vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-125",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2017-18344",
  "document_distribution": "",
  "details": [
    "The timer_create syscall implementation in kernel/time/posix-timers.c in the Linux kernel before 4.14.8 doesn't properly validate the sigevent-\u003esigev_notify field, which leads to out-of-bounds access in the show_timer function (called when /proc/$PID/timers is read). This allows userspace applications to read arbitrary kernel memory (on a kernel built with CONFIG_POSIX_TIMERS and CONFIG_CHECKPOINT_RESTORE).",
    "The timer_create syscall implementation in kernel/time/posix-timers.c in the Linux kernel doesn't properly validate the sigevent-\u003esigev_notify field, which leads to out-of-bounds access in the show_timer function."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2017-18344\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-18344"
  ]
}