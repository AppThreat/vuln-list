{
  "mitigation": "By setting vm.legacy_va_layout to 1 we can effectively disable the exploitation of this issue by switching to the legacy mmap layout. The mmap allocations start much lower in the process address space and follow the bottom-up allocation model. As such, the initial PIE executable mapping is far from the reserved stack area and cannot interfere with the stack.\n64-bit processes on Red Hat Enterprise Linux 5 are forced to use the legacy virtual address space layout regardless of the vm.legacy_va_layout value.\nNote: Applications that have demands for a large linear address space (such as certain databases) may be unable to handle the legacy memory layout proposed using this mitigation. We recommend to test your systems and applications before deploying this mitigation on production systems.\nEdit the /etc/sysctl.conf file as root, and add or amend:\nvm.legacy_va_layout = 1\nTo apply this setting, run the /sbin/sysctl -p command as the root user to reload the settings from /etc/sysctl.conf.\nVerify that vm.legacy_va_layout is now set to defined value:\n$ /sbin/sysctl vm.legacy_va_layout\nvm.legacy_va_layout = 1",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 5.9 Long Life",
      "release_date": "2017-09-26T00:00:00Z",
      "advisory": "RHSA-2017:2802",
      "package": "kernel-0:2.6.18-348.34.2.el5",
      "cpe": "cpe:/o:redhat:rhel_aus:5.9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 5 Extended Lifecycle Support",
      "release_date": "2017-09-26T00:00:00Z",
      "advisory": "RHSA-2017:2801",
      "package": "kernel-0:2.6.18-423.el5",
      "cpe": "cpe:/o:redhat:rhel_els:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "release_date": "2017-09-26T00:00:00Z",
      "advisory": "RHSA-2017:2795",
      "package": "kernel-0:2.6.32-696.10.3.el6",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.2 Advanced Update Support",
      "release_date": "2017-09-26T00:00:00Z",
      "advisory": "RHSA-2017:2800",
      "package": "kernel-0:2.6.32-220.76.1.el6",
      "cpe": "cpe:/o:redhat:rhel_mission_critical:6.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.4 Advanced Update Support",
      "release_date": "2017-09-26T00:00:00Z",
      "advisory": "RHSA-2017:2799",
      "package": "kernel-0:2.6.32-358.84.1.el6",
      "cpe": "cpe:/o:redhat:rhel_aus:6.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.5 Advanced Update Support",
      "release_date": "2017-09-26T00:00:00Z",
      "advisory": "RHSA-2017:2798",
      "package": "kernel-0:2.6.32-431.85.1.el6",
      "cpe": "cpe:/o:redhat:rhel_aus:6.5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.5 Telco Extended Update Support",
      "release_date": "2017-09-26T00:00:00Z",
      "advisory": "RHSA-2017:2798",
      "package": "kernel-0:2.6.32-431.85.1.el6",
      "cpe": "cpe:/o:redhat:rhel_tus:6.5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.6 Advanced Update Support",
      "release_date": "2017-09-26T00:00:00Z",
      "advisory": "RHSA-2017:2797",
      "package": "kernel-0:2.6.32-504.63.3.el6",
      "cpe": "cpe:/o:redhat:rhel_aus:6.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.6 Telco Extended Update Support",
      "release_date": "2017-09-26T00:00:00Z",
      "advisory": "RHSA-2017:2797",
      "package": "kernel-0:2.6.32-504.63.3.el6",
      "cpe": "cpe:/o:redhat:rhel_tus:6.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.7 Extended Update Support",
      "release_date": "2017-09-26T00:00:00Z",
      "advisory": "RHSA-2017:2796",
      "package": "kernel-0:2.6.32-573.48.1.el6",
      "cpe": "cpe:/o:redhat:rhel_eus:6.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2017-08-01T00:00:00Z",
      "advisory": "RHSA-2017:1842",
      "package": "kernel-0:3.10.0-693.el7",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.2 Extended Update Support",
      "release_date": "2017-09-26T00:00:00Z",
      "advisory": "RHSA-2017:2794",
      "package": "kernel-0:3.10.0-327.59.3.el7",
      "cpe": "cpe:/o:redhat:rhel_eus:7.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.3 Extended Update Support",
      "release_date": "2017-09-26T00:00:00Z",
      "advisory": "RHSA-2017:2793",
      "package": "kernel-0:3.10.0-514.32.3.el7",
      "cpe": "cpe:/o:redhat:rhel_eus:7.3"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-alt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise MRG 2",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/a:redhat:enterprise_mrg:2"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2017-09-26T00:00:00Z",
  "bugzilla": {
    "description": "kernel: load_elf_ binary() does not take account of the need to allocate sufficient space for the entire binary",
    "id": "1492212",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1492212"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.8",
    "cvss3_scoring_vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-119",
  "statement": "This issue affects the Linux kernel packages as shipped with Red Hat Enterprise Linux 5 and 6. This issue affects the Linux kernel packages as shipped with Red Hat Enterprise Linux 7 prior to kernel version 3.10.0-693, that is Red Hat Enterprise Linux 7.4 GA kernel version. Kernel versions after 3.10.0-693 contain the fix and are thus not vulnerable.\nThis issue affects the Linux kernel-rt packages prior to the kernel version 3.10.0-693.rt56.617 (Red Hat Enteprise Linux for Realtime) and 3.10.0-693.2.1.rt56.585.el6rt (Red Hat Enterprise MRG 2). The latest Linux kernel-rt packages as shipped with Red Hat Enterprise Linux for Realtime and Red Hat Enterprise MRG 2 are not vulnerable.\nFuture Linux kernel updates for the respective releases will address this issue.",
  "acknowledgement": "Red Hat would like to thank Qualys Research Labs for reporting this issue.",
  "name": "CVE-2017-1000253",
  "document_distribution": "",
  "details": [
    "Linux distributions that have not patched their long-term kernels with https://git.kernel.org/linus/a87938b2e246b81b4fb713edb371a9fa3c5c3c86 (committed on April 14, 2015). This kernel vulnerability was fixed in April 2015 by commit a87938b2e246b81b4fb713edb371a9fa3c5c3c86 (backported to Linux 3.10.77 in May 2015), but it was not recognized as a security threat. With CONFIG_ARCH_BINFMT_ELF_RANDOMIZE_PIE enabled, and a normal top-down address allocation strategy, load_elf_binary() will attempt to map a PIE binary into an address range immediately below mm-\u003emmap_base. Unfortunately, load_elf_ binary() does not take account of the need to allocate sufficient space for the entire binary which means that, while the first PT_LOAD segment is mapped below mm-\u003emmap_base, the subsequent PT_LOAD segment(s) end up being mapped above mm-\u003emmap_base into the are that is supposed to be the \"gap\" between the stack and the binary.",
    "A flaw was found in the way the Linux kernel loaded ELF executables. Provided that an application was built as Position Independent Executable (PIE), the loader could allow part of that application's data segment to map over the memory area reserved for its stack, potentially resulting in memory corruption. An unprivileged local user with access to SUID (or otherwise privileged) PIE binary could use this flaw to escalate their privileges on the system."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2017-1000253\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-1000253\nhttps://www.qualys.com/2017/09/26/cve-2017-1000253/cve-2017-1000253.txt"
  ]
}