{
  "mitigation": "Any of the following:\n1. SELinux is enabled by default and our default policy prevents loading of modules from outside of samba's module directories and therefore blocks the exploit\n2. Mount the filesystem which is used by samba for its writable share using \"noexec\" option.\n3. Add the parameter:\nnt pipe support = no\nto the [global] section of your smb.conf and restart smbd. This prevents clients from accessing any named pipe endpoints. Note this can disable some expected functionality for Windows clients.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 5 Extended Lifecycle Support",
      "release_date": "2017-05-24T00:00:00Z",
      "advisory": "RHSA-2017:1272",
      "package": "samba3x-0:3.6.23-14.el5_11",
      "cpe": "cpe:/o:redhat:rhel_els:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "release_date": "2017-05-24T00:00:00Z",
      "advisory": "RHSA-2017:1270",
      "package": "samba-0:3.6.23-43.el6_9",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "release_date": "2017-05-24T00:00:00Z",
      "advisory": "RHSA-2017:1271",
      "package": "samba4-0:4.2.10-10.el6_9",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.2 Advanced Update Support",
      "release_date": "2017-06-05T00:00:00Z",
      "advisory": "RHSA-2017:1390",
      "package": "samba-0:3.6.23-32.el6_2",
      "cpe": "cpe:/o:redhat:rhel_mission_critical:6.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.4 Advanced Update Support",
      "release_date": "2017-06-05T00:00:00Z",
      "advisory": "RHSA-2017:1390",
      "package": "samba-0:3.6.23-32.el6_4",
      "cpe": "cpe:/o:redhat:rhel_aus:6.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.5 Advanced Update Support",
      "release_date": "2017-06-05T00:00:00Z",
      "advisory": "RHSA-2017:1390",
      "package": "samba-0:3.6.23-32.el6_5",
      "cpe": "cpe:/o:redhat:rhel_aus:6.5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.5 Telco Extended Update Support",
      "release_date": "2017-06-05T00:00:00Z",
      "advisory": "RHSA-2017:1390",
      "package": "samba-0:3.6.23-32.el6_5",
      "cpe": "cpe:/o:redhat:rhel_tus:6.5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.6 Advanced Update Support",
      "release_date": "2017-06-05T00:00:00Z",
      "advisory": "RHSA-2017:1390",
      "package": "samba-0:3.6.23-32.el6_6",
      "cpe": "cpe:/o:redhat:rhel_aus:6.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.6 Telco Extended Update Support",
      "release_date": "2017-06-05T00:00:00Z",
      "advisory": "RHSA-2017:1390",
      "package": "samba-0:3.6.23-32.el6_6",
      "cpe": "cpe:/o:redhat:rhel_tus:6.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6.7 Extended Update Support",
      "release_date": "2017-06-05T00:00:00Z",
      "advisory": "RHSA-2017:1390",
      "package": "samba-0:3.6.23-32.el6_7",
      "cpe": "cpe:/o:redhat:rhel_eus:6.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2017-05-24T00:00:00Z",
      "advisory": "RHSA-2017:1270",
      "package": "samba-0:4.4.4-14.el7_3",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.2 Extended Update Support",
      "release_date": "2017-06-05T00:00:00Z",
      "advisory": "RHSA-2017:1390",
      "package": "samba-0:4.2.10-11.el7_2",
      "cpe": "cpe:/o:redhat:rhel_eus:7.1"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.2 for RHEL 6",
      "release_date": "2017-05-24T00:00:00Z",
      "advisory": "RHSA-2017:1273",
      "package": "samba-0:4.4.6-5.el6rhs",
      "cpe": "cpe:/a:redhat:storage:3.2:samba:el6"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.2 for RHEL 7",
      "release_date": "2017-05-24T00:00:00Z",
      "advisory": "RHSA-2017:1273",
      "package": "samba-0:4.4.6-5.el7rhgs",
      "cpe": "cpe:/a:redhat:storage:3.2:samba:el7"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2017-05-24T00:00:00Z",
  "bugzilla": {
    "description": "samba: Loading shared modules from any path in the system leading to RCE (SambaCry)",
    "id": "1450347",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1450347"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "",
  "statement": "This vulnerability exists in the samba server, client side packages are not affected.",
  "acknowledgement": "Red Hat would like to thank the Samba project for reporting this issue. Upstream acknowledges steelo as the original reporter.",
  "name": "CVE-2017-7494",
  "document_distribution": "",
  "details": [
    "Samba since version 3.5.0 and before 4.6.4, 4.5.10 and 4.4.14 is vulnerable to remote code execution vulnerability, allowing a malicious client to upload a shared library to a writable share, and then cause the server to load and execute it.",
    "A remote code execution flaw was found in Samba. A malicious authenticated samba client, having write access to the samba share, could use this flaw to execute arbitrary code as root."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2017-7494\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-7494\nhttps://www.samba.org/samba/security/CVE-2017-7494.html"
  ]
}