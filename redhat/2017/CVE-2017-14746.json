{
  "mitigation": "Prevent SMB1 access to the server by setting the parameter:\n\"server min protocol = SMB2\"\nto the [global] section of your smb.conf and restart smbd. This prevents and SMB1 access to the server. Note this could cause older clients to be unable to connect to the server.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "release_date": "2017-11-29T00:00:00Z",
      "advisory": "RHSA-2017:3278",
      "package": "samba4-0:4.2.10-12.el6_9",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2017-11-27T00:00:00Z",
      "advisory": "RHSA-2017:3260",
      "package": "samba-0:4.6.2-12.el7_4",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.3 for RHEL 6",
      "release_date": "2017-11-27T00:00:00Z",
      "advisory": "RHSA-2017:3261",
      "package": "samba-0:4.6.3-9.el6rhs",
      "cpe": "cpe:/a:redhat:storage:3.3:samba:el6"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.3 for RHEL 7",
      "release_date": "2017-11-27T00:00:00Z",
      "advisory": "RHSA-2017:3261",
      "package": "samba-0:4.6.3-9.el7rhgs",
      "cpe": "cpe:/a:redhat:storage:3.3:samba:el7"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2017-11-21T00:00:00Z",
  "bugzilla": {
    "description": "samba: Use-after-free in processing SMB1 requests",
    "id": "1511899",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1511899"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.3",
    "cvss3_scoring_vector": "CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
    "status": "verified"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "Red Hat would like to thank the Samba project for reporting this issue. Upstream acknowledges Yihan Lian (Qihoo 360 Gear Team) and Zhibin Hu (Qihoo 360 Gear Team) as the original reporters.",
  "name": "CVE-2017-14746",
  "document_distribution": "",
  "details": [
    "Use-after-free vulnerability in Samba 4.x before 4.7.3 allows remote attackers to execute arbitrary code via a crafted SMB1 request.",
    "A use-after-free flaw was found in the way samba servers handled certain SMB1 requests. An unauthenticated attacker could send specially-crafted SMB1 requests to cause the server to crash or execute arbitrary code."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2017-14746\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-14746\nhttps://www.samba.org/samba/security/CVE-2017-14746.html"
  ]
}