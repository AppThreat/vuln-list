{
  "id": "CVE-2024-32017",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-05-01T07:15:39.280",
  "lastModified": "2024-05-07T12:15:09.593",
  "vulnStatus": "Awaiting Analysis",
  "descriptions": [
    {
      "lang": "en",
      "value": "RIOT is a real-time multi-threading operating system that supports a range of devices that are typically 8-bit, 16-bit and 32-bit microcontrollers. The size check in the `gcoap_dns_server_proxy_get()` function contains a small typo that may lead to a buffer overflow in the subsequent `strcpy()`. In detail, the length of the `_uri` string is checked instead of the length of the `_proxy` string. The `_gcoap_forward_proxy_copy_options()` function does not implement an explicit size check before copying data to the `cep-\u003ereq_etag` buffer that is `COAP_ETAG_LENGTH_MAX` bytes long. If an attacker can craft input so that `optlen` becomes larger than `COAP_ETAG_LENGTH_MAX`, they can cause a buffer overflow. If the input above is attacker-controlled and crosses a security boundary, the impact of the buffer overflow vulnerabilities could range from denial of service to arbitrary code execution. This issue has yet to be patched. Users are advised to add manual bounds checking."
    },
    {
      "lang": "es",
      "value": "RIOT es un sistema operativo multiproceso en tiempo real que admite una variedad de dispositivos que suelen ser microcontroladores de 8, 16 y 32 bits. La verificación de tamaño en la función `gcoap_dns_server_proxy_get()` contiene un pequeño error tipográfico que puede provocar un desbordamiento del búfer en el `strcpy()` posterior. En detalle, se verifica la longitud de la cadena `_uri` en lugar de la longitud de la cadena `_proxy`. La función `_gcoap_forward_proxy_copy_options()` no implementa una verificación de tamaño explícita antes de copiar datos al buffer `cep-\u0026gt;req_etag` que tiene una longitud de bytes `COAP_ETAG_LENGTH_MAX`. Si un atacante puede crear una entrada para que \"optlen\" sea más grande que \"COAP_ETAG_LENGTH_MAX\", puede provocar un desbordamiento del búfer. Si la entrada anterior está controlada por un atacante y cruza un límite de seguridad, el impacto de las vulnerabilidades de desbordamiento del búfer podría variar desde denegación de servicio hasta ejecución de código arbitrario. Este problema aún no se ha solucionado. Se recomienda a los usuarios que agreguen la verificación manual de los límites."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-120"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/05/07/3",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/RIOT-OS/RIOT/blob/master/sys/net/application_layer/gcoap/dns.c#L319-L325",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/RIOT-OS/RIOT/blob/master/sys/net/application_layer/gcoap/forward_proxy.c#L352",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-v97j-w9m6-c4h3",
      "source": "security-advisories@github.com"
    }
  ]
}