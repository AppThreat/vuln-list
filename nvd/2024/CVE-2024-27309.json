{
  "id": "CVE-2024-27309",
  "sourceIdentifier": "security@apache.org",
  "published": "2024-04-12T07:15:08.560",
  "lastModified": "2024-04-12T12:43:46.210",
  "vulnStatus": "Awaiting Analysis",
  "descriptions": [
    {
      "lang": "en",
      "value": "While an Apache Kafka cluster is being migrated from ZooKeeper mode to KRaft mode, in some cases ACLs will not be correctly enforced.\n\nTwo preconditions are needed to trigger the bug:\n1. The administrator decides to remove an ACL\n2. The resource associated with the removed ACL continues to have two or more other ACLs associated with it after the removal.\n\nWhen those two preconditions are met, Kafka will treat the resource as if it had only one ACL associated with it after the removal, rather than the two or more that would be correct.\n\nThe incorrect condition is cleared by removing all brokers in ZK mode, or by adding a new ACL to the affected resource. Once the migration is completed, there is no metadata loss (the ACLs all remain).\n\nThe full impact depends on the ACLs in use. If only ALLOW ACLs were configured during the migration, the impact would be limited to availability impact. if DENY ACLs were configured, the impact could include confidentiality and integrity impact depending on the ACLs configured, as the DENY ACLs might be ignored due to this vulnerability during the migration period.\n\n"
    },
    {
      "lang": "es",
      "value": "Mientras se migra un clúster de Apache Kafka del modo ZooKeeper al modo KRaft, en algunos casos las ACL no se aplicarán correctamente. Se necesitan dos condiciones previas para desencadenar el error: 1. El administrador decide eliminar una ACL. 2. El recurso asociado con la ACL eliminada continúa teniendo dos o más ACL asociadas después de la eliminación. Cuando se cumplen esas dos condiciones previas, Kafka tratará el recurso como si tuviera solo una ACL asociada después de la eliminación, en lugar de las dos o más que serían correctas. La condición incorrecta se elimina eliminando todos los intermediarios en modo ZK o agregando una nueva ACL al recurso afectado. Una vez que se completa la migración, no hay pérdida de metadatos (todas las ACL permanecen). El impacto total depende de las ACL en uso. Si solo se configuraran ALLOW ACL durante la migración, el impacto se limitaría al impacto en la disponibilidad. Si se configuraron DENY ACL, el impacto podría incluir un impacto en la confidencialidad e integridad según las ACL configuradas, ya que DENY ACL podrían ignorarse debido a esta vulnerabilidad durante el período de migración."
    }
  ],
  "metrics": {},
  "weaknesses": [
    {
      "source": "security@apache.org",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-863"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://lists.apache.org/thread/6536rmzyg076lzzdw2xdktvnz163mjpy",
      "source": "security@apache.org"
    }
  ]
}